!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=e.length,n=Z.type(e);return"function"===n||Z.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function r(e,t,n){if(Z.isFunction(t))return Z.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return Z.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(at.test(t))return Z.filter(t,e,n);t=Z.filter(t,e)}return Z.grep(e,function(e){return U.call(t,e)>=0!==n})}function i(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(e){var t=ht[e]={};return Z.each(e.match(dt)||[],function(e,n){t[n]=!0}),t}function s(){J.removeEventListener("DOMContentLoaded",s,!1),e.removeEventListener("load",s,!1),Z.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Z.expando+Math.random()}function u(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(bt,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:xt.test(n)?Z.parseJSON(n):n}catch(i){}yt.set(e,t,n)}else n=void 0;return n}function l(){return!0}function c(){return!1}function f(){try{return J.activeElement}catch(e){}}function p(e,t){return Z.nodeName(e,"table")&&Z.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function d(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function h(e){var t=Pt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var n=0,r=e.length;r>n;n++)vt.set(e[n],"globalEval",!t||vt.get(t[n],"globalEval"))}function m(e,t){var n,r,i,o,s,a,u,l;if(1===t.nodeType){if(vt.hasData(e)&&(o=vt.access(e),s=vt.set(t,o),l=o.events)){delete s.handle,s.events={};for(i in l)for(n=0,r=l[i].length;r>n;n++)Z.event.add(t,i,l[i][n])}yt.hasData(e)&&(a=yt.access(e),u=Z.extend({},a),yt.set(t,u))}}function v(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Z.nodeName(e,t)?Z.merge([e],n):n}function y(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Nt.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function x(t,n){var r,i=Z(n.createElement(t)).appendTo(n.body),o=e.getDefaultComputedStyle&&(r=e.getDefaultComputedStyle(i[0]))?r.display:Z.css(i[0],"display");return i.detach(),o}function b(e){var t=J,n=$t[e];return n||(n=x(e,t),"none"!==n&&n||(Wt=(Wt||Z("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=Wt[0].contentDocument,t.write(),t.close(),n=x(e,t),Wt.detach()),$t[e]=n),n}function w(e,t,n){var r,i,o,s,a=e.style;return n=n||_t(e),n&&(s=n.getPropertyValue(t)||n[t]),n&&(""!==s||Z.contains(e.ownerDocument,e)||(s=Z.style(e,t)),It.test(s)&&Bt.test(t)&&(r=a.width,i=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=r,a.minWidth=i,a.maxWidth=o)),void 0!==s?s+"":s}function T(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function C(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),r=t,i=Gt.length;i--;)if(t=Gt[i]+n,t in e)return t;return r}function N(e,t,n){var r=Xt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function k(e,t,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;4>o;o+=2)"margin"===n&&(s+=Z.css(e,n+Tt[o],!0,i)),r?("content"===n&&(s-=Z.css(e,"padding"+Tt[o],!0,i)),"margin"!==n&&(s-=Z.css(e,"border"+Tt[o]+"Width",!0,i))):(s+=Z.css(e,"padding"+Tt[o],!0,i),"padding"!==n&&(s+=Z.css(e,"border"+Tt[o]+"Width",!0,i)));return s}function E(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=_t(e),s="border-box"===Z.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=w(e,t,o),(0>i||null==i)&&(i=e.style[t]),It.test(i))return i;r=s&&(Q.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+k(e,t,n||(s?"border":"content"),r,o)+"px"}function S(e,t){for(var n,r,i,o=[],s=0,a=e.length;a>s;s++)r=e[s],r.style&&(o[s]=vt.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&Ct(r)&&(o[s]=vt.access(r,"olddisplay",b(r.nodeName)))):(i=Ct(r),"none"===n&&i||vt.set(r,"olddisplay",i?n:Z.css(r,"display"))));for(s=0;a>s;s++)r=e[s],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}function j(e,t,n,r,i){return new j.prototype.init(e,t,n,r,i)}function D(){return setTimeout(function(){Qt=void 0}),Qt=Z.now()}function A(e,t){var n,r=0,i={height:e};for(t=t?1:0;4>r;r+=2-t)n=Tt[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function L(e,t,n){for(var r,i=(nn[t]||[]).concat(nn["*"]),o=0,s=i.length;s>o;o++)if(r=i[o].call(n,t,e))return r}function q(e,t,n){var r,i,o,s,a,u,l,c,f=this,p={},d=e.style,h=e.nodeType&&Ct(e),g=vt.get(e,"fxshow");n.queue||(a=Z._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,f.always(function(){f.always(function(){a.unqueued--,Z.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],l=Z.css(e,"display"),c="none"===l?vt.get(e,"olddisplay")||b(e.nodeName):l,"inline"===c&&"none"===Z.css(e,"float")&&(d.display="inline-block")),n.overflow&&(d.overflow="hidden",f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],Kt.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;h=!0}p[r]=g&&g[r]||Z.style(e,r)}else l=void 0;if(Z.isEmptyObject(p))"inline"===("none"===l?b(e.nodeName):l)&&(d.display=l);else{g?"hidden"in g&&(h=g.hidden):g=vt.access(e,"fxshow",{}),o&&(g.hidden=!h),h?Z(e).show():f.done(function(){Z(e).hide()}),f.done(function(){var t;vt.remove(e,"fxshow");for(t in p)Z.style(e,t,p[t])});for(r in p)s=L(h?g[r]:0,r,f),r in g||(g[r]=s.start,h&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}function H(e,t){var n,r,i,o,s;for(n in e)if(r=Z.camelCase(n),i=t[r],o=e[n],Z.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=Z.cssHooks[r],s&&"expand"in s){o=s.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function O(e,t,n){var r,i,o=0,s=tn.length,a=Z.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=Qt||D(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,s=0,u=l.tweens.length;u>s;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,n]),1>o&&u?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:Z.extend({},t),opts:Z.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Qt||D(),duration:n.duration,tweens:[],createTween:function(t,n){var r=Z.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),c=l.props;for(H(c,l.opts.specialEasing);s>o;o++)if(r=tn[o].call(l,e,c,l.opts))return r;return Z.map(c,L,l),Z.isFunction(l.opts.start)&&l.opts.start.call(e,l),Z.fx.timer(Z.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function F(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(dt)||[];if(Z.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function P(e,t,n,r){function i(a){var u;return o[a]=!0,Z.each(e[a]||[],function(e,a){var l=a(t,n,r);return"string"!=typeof l||s||o[l]?s?!(u=l):void 0:(t.dataTypes.unshift(l),i(l),!1)}),u}var o={},s=e===Tn;return i(t.dataTypes[0])||!o["*"]&&i("*")}function M(e,t){var n,r,i=Z.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&Z.extend(!0,e,r),e}function R(e,t,n){for(var r,i,o,s,a=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):void 0}function W(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s)for(i in l)if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[i]:l[i]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(f){return{state:"parsererror",error:s?f:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}function $(e,t,n,r){var i;if(Z.isArray(t))Z.each(t,function(t,i){n||En.test(e)?r(e,i):$(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==Z.type(t))r(e,t);else for(i in t)$(e+"["+i+"]",t[i],n,r)}function B(e){return Z.isWindow(e)?e:9===e.nodeType&&e.defaultView}var I=[],_=I.slice,z=I.concat,X=I.push,U=I.indexOf,V={},Y=V.toString,G=V.hasOwnProperty,Q={},J=e.document,K="2.1.1",Z=function(e,t){return new Z.fn.init(e,t)},et=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,tt=/^-ms-/,nt=/-([\da-z])/gi,rt=function(e,t){return t.toUpperCase()};Z.fn=Z.prototype={jquery:K,constructor:Z,selector:"",length:0,toArray:function(){return _.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:_.call(this)},pushStack:function(e){var t=Z.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Z.each(this,e,t)},map:function(e){return this.pushStack(Z.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(_.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:X,sort:I.sort,splice:I.splice},Z.extend=Z.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||Z.isFunction(s)||(s={}),a===u&&(s=this,a--);u>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],r=e[t],s!==r&&(l&&r&&(Z.isPlainObject(r)||(i=Z.isArray(r)))?(i?(i=!1,o=n&&Z.isArray(n)?n:[]):o=n&&Z.isPlainObject(n)?n:{},s[t]=Z.extend(l,o,r)):void 0!==r&&(s[t]=r));return s},Z.extend({expando:"jQuery"+(K+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Z.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Z.isArray(e)&&e-parseFloat(e)>=0},isPlainObject:function(e){return"object"!==Z.type(e)||e.nodeType||Z.isWindow(e)?!1:e.constructor&&!G.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?V[Y.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;e=Z.trim(e),e&&(1===e.indexOf("use strict")?(t=J.createElement("script"),t.text=e,J.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(tt,"ms-").replace(nt,rt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,r){var i,o=0,s=e.length,a=n(e);if(r){if(a)for(;s>o&&(i=t.apply(e[o],r),i!==!1);o++);else for(o in e)if(i=t.apply(e[o],r),i===!1)break}else if(a)for(;s>o&&(i=t.call(e[o],o,e[o]),i!==!1);o++);else for(o in e)if(i=t.call(e[o],o,e[o]),i===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(et,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(n(Object(e))?Z.merge(r,"string"==typeof e?[e]:e):X.call(r,e)),r},inArray:function(e,t,n){return null==t?-1:U.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;n>r;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,s=e.length,a=!n;s>o;o++)r=!t(e[o],o),r!==a&&i.push(e[o]);return i},map:function(e,t,r){var i,o=0,s=e.length,a=n(e),u=[];if(a)for(;s>o;o++)i=t(e[o],o,r),null!=i&&u.push(i);else for(o in e)i=t(e[o],o,r),null!=i&&u.push(i);return z.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),Z.isFunction(e)?(r=_.call(arguments,2),i=function(){return e.apply(t||this,r.concat(_.call(arguments)))},i.guid=e.guid=e.guid||Z.guid++,i):void 0},now:Date.now,support:Q}),Z.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){V["[object "+t+"]"]=t.toLowerCase()});var it=function(e){function t(e,t,n,r){var i,o,s,a,u,l,f,d,h,g;if((t?t.ownerDocument||t:$)!==q&&L(t),t=t||q,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(O&&!r){if(i=yt.exec(e))if(s=i[1]){if(9===a){if(o=t.getElementById(s),!o||!o.parentNode)return n;if(o.id===s)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&R(t,o)&&o.id===s)return n.push(o),n}else{if(i[2])return Z.apply(n,t.getElementsByTagName(e)),n;if((s=i[3])&&w.getElementsByClassName&&t.getElementsByClassName)return Z.apply(n,t.getElementsByClassName(s)),n}if(w.qsa&&(!F||!F.test(e))){if(d=f=W,h=t,g=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(l=k(e),(f=t.getAttribute("id"))?d=f.replace(bt,"\\$&"):t.setAttribute("id",d),d="[id='"+d+"'] ",u=l.length;u--;)l[u]=d+p(l[u]);h=xt.test(e)&&c(t.parentNode)||t,g=l.join(",")}if(g)try{return Z.apply(n,h.querySelectorAll(g)),n}catch(m){}finally{f||t.removeAttribute("id")}}}return S(e.replace(ut,"$1"),t,n,r)}function n(){function e(n,r){return t.push(n+" ")>T.cacheLength&&delete e[t.shift()],e[n+" "]=r}var t=[];return e}function r(e){return e[W]=!0,e}function i(e){var t=q.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),r=e.length;r--;)T.attrHandle[n[r]]=t}function s(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Y)-(~e.sourceIndex||Y);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function u(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function l(e){return r(function(t){return t=+t,r(function(n,r){for(var i,o=e([],n.length,t),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}function c(e){return e&&typeof e.getElementsByTagName!==V&&e}function f(){}function p(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function d(e,t,n){var r=t.dir,i=n&&"parentNode"===r,o=I++;return t.first?function(t,n,o){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,o)}:function(t,n,s){var a,u,l=[B,o];if(s){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,s))return!0}else for(;t=t[r];)if(1===t.nodeType||i){if(u=t[W]||(t[W]={}),(a=u[r])&&a[0]===B&&a[1]===o)return l[2]=a[2];if(u[r]=l,l[2]=e(t,n,s))return!0}}}function h(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function g(e,n,r){for(var i=0,o=n.length;o>i;i++)t(e,n[i],r);return r}function m(e,t,n,r,i){for(var o,s=[],a=0,u=e.length,l=null!=t;u>a;a++)(o=e[a])&&(!n||n(o,r,i))&&(s.push(o),l&&t.push(a));return s}function v(e,t,n,i,o,s){return i&&!i[W]&&(i=v(i)),o&&!o[W]&&(o=v(o,s)),r(function(r,s,a,u){var l,c,f,p=[],d=[],h=s.length,v=r||g(t||"*",a.nodeType?[a]:a,[]),y=!e||!r&&t?v:m(v,p,e,a,u),x=n?o||(r?e:h||i)?[]:s:y;if(n&&n(y,x,a,u),i)for(l=m(x,d),i(l,[],a,u),c=l.length;c--;)(f=l[c])&&(x[d[c]]=!(y[d[c]]=f));if(r){if(o||e){if(o){for(l=[],c=x.length;c--;)(f=x[c])&&l.push(y[c]=f);o(null,x=[],l,u)}for(c=x.length;c--;)(f=x[c])&&(l=o?tt.call(r,f):p[c])>-1&&(r[l]=!(s[l]=f))}}else x=m(x===s?x.splice(h,x.length):x),o?o(null,s,x,u):Z.apply(s,x)})}function y(e){for(var t,n,r,i=e.length,o=T.relative[e[0].type],s=o||T.relative[" "],a=o?1:0,u=d(function(e){return e===t},s,!0),l=d(function(e){return tt.call(t,e)>-1},s,!0),c=[function(e,n,r){return!o&&(r||n!==j)||((t=n).nodeType?u(e,n,r):l(e,n,r))}];i>a;a++)if(n=T.relative[e[a].type])c=[d(h(c),n)];else{if(n=T.filter[e[a].type].apply(null,e[a].matches),n[W]){for(r=++a;i>r&&!T.relative[e[r].type];r++);return v(a>1&&h(c),a>1&&p(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ut,"$1"),n,r>a&&y(e.slice(a,r)),i>r&&y(e=e.slice(r)),i>r&&p(e))}c.push(n)}return h(c)}function x(e,n){var i=n.length>0,o=e.length>0,s=function(r,s,a,u,l){var c,f,p,d=0,h="0",g=r&&[],v=[],y=j,x=r||o&&T.find.TAG("*",l),b=B+=null==y?1:Math.random()||.1,w=x.length;for(l&&(j=s!==q&&s);h!==w&&null!=(c=x[h]);h++){if(o&&c){for(f=0;p=e[f++];)if(p(c,s,a)){u.push(c);break}l&&(B=b)}i&&((c=!p&&c)&&d--,r&&g.push(c))}if(d+=h,i&&h!==d){for(f=0;p=n[f++];)p(g,v,s,a);if(r){if(d>0)for(;h--;)g[h]||v[h]||(v[h]=J.call(u));v=m(v)}Z.apply(u,v),l&&!r&&v.length>0&&d+n.length>1&&t.uniqueSort(u)}return l&&(B=b,j=y),g};return i?r(s):s}var b,w,T,C,N,k,E,S,j,D,A,L,q,H,O,F,P,M,R,W="sizzle"+-new Date,$=e.document,B=0,I=0,_=n(),z=n(),X=n(),U=function(e,t){return e===t&&(A=!0),0},V="undefined",Y=1<<31,G={}.hasOwnProperty,Q=[],J=Q.pop,K=Q.push,Z=Q.push,et=Q.slice,tt=Q.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},nt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",rt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot=it.replace("w","w#"),st="\\["+rt+"*("+it+")(?:"+rt+"*([*^$|!~]?=)"+rt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ot+"))|)"+rt+"*\\]",at=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+st+")*)|.*)\\)|)",ut=new RegExp("^"+rt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+rt+"+$","g"),lt=new RegExp("^"+rt+"*,"+rt+"*"),ct=new RegExp("^"+rt+"*([>+~]|"+rt+")"+rt+"*"),ft=new RegExp("="+rt+"*([^\\]'\"]*?)"+rt+"*\\]","g"),pt=new RegExp(at),dt=new RegExp("^"+ot+"$"),ht={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it.replace("w","w*")+")"),ATTR:new RegExp("^"+st),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+rt+"*(even|odd|(([+-]|)(\\d*)n|)"+rt+"*(?:([+-]|)"+rt+"*(\\d+)|))"+rt+"*\\)|)","i"),bool:new RegExp("^(?:"+nt+")$","i"),needsContext:new RegExp("^"+rt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+rt+"*((?:-\\d)?\\d*)"+rt+"*\\)|)(?=[^-]|$)","i")},gt=/^(?:input|select|textarea|button)$/i,mt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,xt=/[+~]/,bt=/'|\\/g,wt=new RegExp("\\\\([\\da-f]{1,6}"+rt+"?|("+rt+")|.)","ig"),Tt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{Z.apply(Q=et.call($.childNodes),$.childNodes),Q[$.childNodes.length].nodeType}catch(Ct){Z={apply:Q.length?function(e,t){K.apply(e,et.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}w=t.support={},N=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},L=t.setDocument=function(e){var t,n=e?e.ownerDocument||e:$,r=n.defaultView;return n!==q&&9===n.nodeType&&n.documentElement?(q=n,H=n.documentElement,O=!N(n),r&&r!==r.top&&(r.addEventListener?r.addEventListener("unload",function(){L()},!1):r.attachEvent&&r.attachEvent("onunload",function(){L()})),w.attributes=i(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByTagName=i(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),w.getElementsByClassName=vt.test(n.getElementsByClassName)&&i(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),w.getById=i(function(e){return H.appendChild(e).id=W,!n.getElementsByName||!n.getElementsByName(W).length}),w.getById?(T.find.ID=function(e,t){if(typeof t.getElementById!==V&&O){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},T.filter.ID=function(e){var t=e.replace(wt,Tt);return function(e){return e.getAttribute("id")===t}}):(delete T.find.ID,T.filter.ID=function(e){var t=e.replace(wt,Tt);return function(e){var n=typeof e.getAttributeNode!==V&&e.getAttributeNode("id");return n&&n.value===t}}),T.find.TAG=w.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==V?t.getElementsByTagName(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},T.find.CLASS=w.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==V&&O?t.getElementsByClassName(e):void 0},P=[],F=[],(w.qsa=vt.test(n.querySelectorAll))&&(i(function(e){e.innerHTML="<select msallowclip=''><option selected=''></option></select>",e.querySelectorAll("[msallowclip^='']").length&&F.push("[*^$]="+rt+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||F.push("\\["+rt+"*(?:value|"+nt+")"),e.querySelectorAll(":checked").length||F.push(":checked")}),i(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&F.push("name"+rt+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),F.push(",.*:")})),(w.matchesSelector=vt.test(M=H.matches||H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&i(function(e){w.disconnectedMatch=M.call(e,"div"),M.call(e,"[s!='']:x"),P.push("!=",at)}),F=F.length&&new RegExp(F.join("|")),P=P.length&&new RegExp(P.join("|")),t=vt.test(H.compareDocumentPosition),R=t||vt.test(H.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},U=t?function(e,t){if(e===t)return A=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r?r:(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&r||!w.sortDetached&&t.compareDocumentPosition(e)===r?e===n||e.ownerDocument===$&&R($,e)?-1:t===n||t.ownerDocument===$&&R($,t)?1:D?tt.call(D,e)-tt.call(D,t):0:4&r?-1:1)}:function(e,t){if(e===t)return A=!0,0;var r,i=0,o=e.parentNode,a=t.parentNode,u=[e],l=[t];if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:D?tt.call(D,e)-tt.call(D,t):0;if(o===a)return s(e,t);for(r=e;r=r.parentNode;)u.unshift(r);for(r=t;r=r.parentNode;)l.unshift(r);for(;u[i]===l[i];)i++;return i?s(u[i],l[i]):u[i]===$?-1:l[i]===$?1:0},n):q},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==q&&L(e),n=n.replace(ft,"='$1']"),!(!w.matchesSelector||!O||P&&P.test(n)||F&&F.test(n)))try{var r=M.call(e,n);if(r||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return t(n,q,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==q&&L(e),R(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==q&&L(e);var n=T.attrHandle[t.toLowerCase()],r=n&&G.call(T.attrHandle,t.toLowerCase())?n(e,t,!O):void 0;return void 0!==r?r:w.attributes||!O?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],r=0,i=0;if(A=!w.detectDuplicates,D=!w.sortStable&&e.slice(0),e.sort(U),A){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return D=null,e},C=t.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=C(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=C(t);return n},T=t.selectors={cacheLength:50,createPseudo:r,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(wt,Tt),e[3]=(e[3]||e[4]||e[5]||"").replace(wt,Tt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return ht.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&pt.test(n)&&(t=k(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(wt,Tt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=_[e+" "];return t||(t=new RegExp("(^|"+rt+")"+e+"("+rt+"|$)"))&&_(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==V&&e.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(i){var o=t.attr(i,e);return null==o?"!="===n:n?(o+="","="===n?o===r:"!="===n?o!==r:"^="===n?r&&0===o.indexOf(r):"*="===n?r&&o.indexOf(r)>-1:"$="===n?r&&o.slice(-r.length)===r:"~="===n?(" "+o+" ").indexOf(r)>-1:"|="===n?o===r||o.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,p,d,h,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,v=a&&t.nodeName.toLowerCase(),y=!u&&!a;if(m){if(o){for(;g;){for(f=t;f=f[g];)if(a?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[s?m.firstChild:m.lastChild],s&&y){for(c=m[W]||(m[W]={}),l=c[e]||[],d=l[0]===B&&l[1],p=l[0]===B&&l[2],f=d&&m.childNodes[d];f=++d&&f&&f[g]||(p=d=0)||h.pop();)if(1===f.nodeType&&++p&&f===t){c[e]=[B,d,p];break}}else if(y&&(l=(t[W]||(t[W]={}))[e])&&l[0]===B)p=l[1];else for(;(f=++d&&f&&f[g]||(p=d=0)||h.pop())&&((a?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++p||(y&&((f[W]||(f[W]={}))[e]=[B,p]),f!==t)););return p-=i,p===r||p%r===0&&p/r>=0}}},PSEUDO:function(e,n){var i,o=T.pseudos[e]||T.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[W]?o(n):o.length>1?(i=[e,e,"",n],T.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,i=o(e,n),s=i.length;s--;)r=tt.call(e,i[s]),e[r]=!(t[r]=i[s])}):function(e){return o(e,0,i)}):o}},pseudos:{not:r(function(e){var t=[],n=[],i=E(e.replace(ut,"$1"));return i[W]?r(function(e,t,n,r){for(var o,s=i(e,null,r,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),!n.pop()}}),has:r(function(e){return function(n){return t(e,n).length>0}}),contains:r(function(e){return function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:r(function(e){return dt.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(wt,Tt).toLowerCase(),function(t){var n;do if(n=O?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===H},focus:function(e){return e===q.activeElement&&(!q.hasFocus||q.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!T.pseudos.empty(e)},header:function(e){return mt.test(e.nodeName)},input:function(e){return gt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[0>n?n+t:n]}),even:l(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:l(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}},T.pseudos.nth=T.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})T.pseudos[b]=a(b);for(b in{submit:!0,reset:!0})T.pseudos[b]=u(b);return f.prototype=T.filters=T.pseudos,T.setFilters=new f,k=t.tokenize=function(e,n){var r,i,o,s,a,u,l,c=z[e+" "];if(c)return n?0:c.slice(0);for(a=e,u=[],l=T.preFilter;a;){(!r||(i=lt.exec(a)))&&(i&&(a=a.slice(i[0].length)||a),u.push(o=[])),r=!1,(i=ct.exec(a))&&(r=i.shift(),o.push({value:r,type:i[0].replace(ut," ")}),a=a.slice(r.length));for(s in T.filter)!(i=ht[s].exec(a))||l[s]&&!(i=l[s](i))||(r=i.shift(),o.push({value:r,type:s,matches:i}),a=a.slice(r.length));if(!r)break}return n?a.length:a?t.error(e):z(e,u).slice(0)},E=t.compile=function(e,t){var n,r=[],i=[],o=X[e+" "];if(!o){for(t||(t=k(e)),n=t.length;n--;)o=y(t[n]),o[W]?r.push(o):i.push(o);o=X(e,x(i,r)),o.selector=e}return o},S=t.select=function(e,t,n,r){var i,o,s,a,u,l="function"==typeof e&&e,f=!r&&k(e=l.selector||e);if(n=n||[],1===f.length){if(o=f[0]=f[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&w.getById&&9===t.nodeType&&O&&T.relative[o[1].type]){if(t=(T.find.ID(s.matches[0].replace(wt,Tt),t)||[])[0],!t)return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=ht.needsContext.test(e)?0:o.length;i--&&(s=o[i],!T.relative[a=s.type]);)if((u=T.find[a])&&(r=u(s.matches[0].replace(wt,Tt),xt.test(o[0].type)&&c(t.parentNode)||t))){if(o.splice(i,1),e=r.length&&p(o),!e)return Z.apply(n,r),n;break}}return(l||E(e,f))(r,t,!O,n,xt.test(e)&&c(t.parentNode)||t),n},w.sortStable=W.split("").sort(U).join("")===W,w.detectDuplicates=!!A,L(),w.sortDetached=i(function(e){return 1&e.compareDocumentPosition(q.createElement("div"))}),i(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),w.attributes&&i(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),i(function(e){return null==e.getAttribute("disabled")})||o(nt,function(e,t,n){var r;return n?void 0:e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(e);Z.find=it,Z.expr=it.selectors,Z.expr[":"]=Z.expr.pseudos,Z.unique=it.uniqueSort,Z.text=it.getText,Z.isXMLDoc=it.isXML,Z.contains=it.contains;var ot=Z.expr.match.needsContext,st=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,at=/^.[^:#\[\.,]*$/;Z.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?Z.find.matchesSelector(r,e)?[r]:[]:Z.find.matches(e,Z.grep(t,function(e){return 1===e.nodeType}))},Z.fn.extend({find:function(e){var t,n=this.length,r=[],i=this;if("string"!=typeof e)return this.pushStack(Z(e).filter(function(){for(t=0;n>t;t++)if(Z.contains(i[t],this))return!0
}));for(t=0;n>t;t++)Z.find(e,i[t],r);return r=this.pushStack(n>1?Z.unique(r):r),r.selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(r(this,e||[],!1))},not:function(e){return this.pushStack(r(this,e||[],!0))},is:function(e){return!!r(this,"string"==typeof e&&ot.test(e)?Z(e):e||[],!1).length}});var ut,lt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ct=Z.fn.init=function(e,t){var n,r;if(!e)return this;if("string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:lt.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||ut).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof Z?t[0]:t,Z.merge(this,Z.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:J,!0)),st.test(n[1])&&Z.isPlainObject(t))for(n in t)Z.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return r=J.getElementById(n[2]),r&&r.parentNode&&(this.length=1,this[0]=r),this.context=J,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Z.isFunction(e)?"undefined"!=typeof ut.ready?ut.ready(e):e(Z):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Z.makeArray(e,this))};ct.prototype=Z.fn,ut=Z(J);var ft=/^(?:parents|prev(?:Until|All))/,pt={children:!0,contents:!0,next:!0,prev:!0};Z.extend({dir:function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&Z(e).is(n))break;r.push(e)}return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),Z.fn.extend({has:function(e){var t=Z(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(Z.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,r=0,i=this.length,o=[],s=ot.test(e)||"string"!=typeof e?Z(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&Z.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?Z.unique(o):o)},index:function(e){return e?"string"==typeof e?U.call(Z(e),this[0]):U.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Z.unique(Z.merge(this.get(),Z(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Z.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Z.dir(e,"parentNode")},parentsUntil:function(e,t,n){return Z.dir(e,"parentNode",n)},next:function(e){return i(e,"nextSibling")},prev:function(e){return i(e,"previousSibling")},nextAll:function(e){return Z.dir(e,"nextSibling")},prevAll:function(e){return Z.dir(e,"previousSibling")},nextUntil:function(e,t,n){return Z.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return Z.dir(e,"previousSibling",n)},siblings:function(e){return Z.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Z.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Z.merge([],e.childNodes)}},function(e,t){Z.fn[e]=function(n,r){var i=Z.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=Z.filter(r,i)),this.length>1&&(pt[e]||Z.unique(i),ft.test(e)&&i.reverse()),this.pushStack(i)}});var dt=/\S+/g,ht={};Z.Callbacks=function(e){e="string"==typeof e?ht[e]||o(e):Z.extend({},e);var t,n,r,i,s,a,u=[],l=!e.once&&[],c=function(o){for(t=e.memory&&o,n=!0,a=i||0,i=0,s=u.length,r=!0;u&&s>a;a++)if(u[a].apply(o[0],o[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(l?l.length&&c(l.shift()):t?u=[]:f.disable())},f={add:function(){if(u){var n=u.length;!function o(t){Z.each(t,function(t,n){var r=Z.type(n);"function"===r?e.unique&&f.has(n)||u.push(n):n&&n.length&&"string"!==r&&o(n)})}(arguments),r?s=u.length:t&&(i=n,c(t))}return this},remove:function(){return u&&Z.each(arguments,function(e,t){for(var n;(n=Z.inArray(t,u,n))>-1;)u.splice(n,1),r&&(s>=n&&s--,a>=n&&a--)}),this},has:function(e){return e?Z.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],s=0,this},disable:function(){return u=l=t=void 0,this},disabled:function(){return!u},lock:function(){return l=void 0,t||f.disable(),this},locked:function(){return!l},fireWith:function(e,t){return!u||n&&!l||(t=t||[],t=[e,t.slice?t.slice():t],r?l.push(t):c(t)),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!n}};return f},Z.extend({Deferred:function(e){var t=[["resolve","done",Z.Callbacks("once memory"),"resolved"],["reject","fail",Z.Callbacks("once memory"),"rejected"],["notify","progress",Z.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Z.Deferred(function(n){Z.each(t,function(t,o){var s=Z.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&Z.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o[0]+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Z.extend(e,r):r}},i={};return r.pipe=r.then,Z.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,o=_.call(arguments),s=o.length,a=1!==s||e&&Z.isFunction(e.promise)?s:0,u=1===a?e:Z.Deferred(),l=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?_.call(arguments):i,r===t?u.notifyWith(n,r):--a||u.resolveWith(n,r)}};if(s>1)for(t=new Array(s),n=new Array(s),r=new Array(s);s>i;i++)o[i]&&Z.isFunction(o[i].promise)?o[i].promise().done(l(i,r,o)).fail(u.reject).progress(l(i,n,t)):--a;return a||u.resolveWith(r,o),u.promise()}});var gt;Z.fn.ready=function(e){return Z.ready.promise().done(e),this},Z.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Z.readyWait++:Z.ready(!0)},ready:function(e){(e===!0?--Z.readyWait:Z.isReady)||(Z.isReady=!0,e!==!0&&--Z.readyWait>0||(gt.resolveWith(J,[Z]),Z.fn.triggerHandler&&(Z(J).triggerHandler("ready"),Z(J).off("ready"))))}}),Z.ready.promise=function(t){return gt||(gt=Z.Deferred(),"complete"===J.readyState?setTimeout(Z.ready):(J.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1))),gt.promise(t)},Z.ready.promise();var mt=Z.access=function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===Z.type(n)){i=!0;for(a in n)Z.access(e,t,a,n[a],!0,o,s)}else if(void 0!==r&&(i=!0,Z.isFunction(r)||(s=!0),l&&(s?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(Z(e),n)})),t))for(;u>a;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o};Z.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},a.uid=1,a.accepts=Z.acceptData,a.prototype={key:function(e){if(!a.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=a.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,Z.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),o=this.cache[i];if("string"==typeof t)o[t]=n;else if(Z.isEmptyObject(o))Z.extend(this.cache[i],t);else for(r in t)o[r]=t[r];return o},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var r;return void 0===t||t&&"string"==typeof t&&void 0===n?(r=this.get(e,t),void 0!==r?r:this.get(e,Z.camelCase(t))):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r,i,o=this.key(e),s=this.cache[o];if(void 0===t)this.cache[o]={};else{Z.isArray(t)?r=t.concat(t.map(Z.camelCase)):(i=Z.camelCase(t),t in s?r=[t,i]:(r=i,r=r in s?[r]:r.match(dt)||[])),n=r.length;for(;n--;)delete s[r[n]]}},hasData:function(e){return!Z.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var vt=new a,yt=new a,xt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,bt=/([A-Z])/g;Z.extend({hasData:function(e){return yt.hasData(e)||vt.hasData(e)},data:function(e,t,n){return yt.access(e,t,n)},removeData:function(e,t){yt.remove(e,t)},_data:function(e,t,n){return vt.access(e,t,n)},_removeData:function(e,t){vt.remove(e,t)}}),Z.fn.extend({data:function(e,t){var n,r,i,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(i=yt.get(o),1===o.nodeType&&!vt.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(r=s[n].name,0===r.indexOf("data-")&&(r=Z.camelCase(r.slice(5)),u(o,r,i[r])));vt.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){yt.set(this,e)}):mt(this,function(t){var n,r=Z.camelCase(e);if(o&&void 0===t){if(n=yt.get(o,e),void 0!==n)return n;if(n=yt.get(o,r),void 0!==n)return n;if(n=u(o,r,void 0),void 0!==n)return n}else this.each(function(){var n=yt.get(this,r);yt.set(this,r,t),-1!==e.indexOf("-")&&void 0!==n&&yt.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){yt.remove(this,e)})}}),Z.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=vt.get(e,t),n&&(!r||Z.isArray(n)?r=vt.access(e,t,Z.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=Z.queue(e,t),r=n.length,i=n.shift(),o=Z._queueHooks(e,t),s=function(){Z.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return vt.get(e,n)||vt.access(e,n,{empty:Z.Callbacks("once memory").add(function(){vt.remove(e,[t+"queue",n])})})}}),Z.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?Z.queue(this[0],e):void 0===t?this:this.each(function(){var n=Z.queue(this,e,t);Z._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&Z.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Z.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=Z.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)n=vt.get(o[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var wt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Tt=["Top","Right","Bottom","Left"],Ct=function(e,t){return e=t||e,"none"===Z.css(e,"display")||!Z.contains(e.ownerDocument,e)},Nt=/^(?:checkbox|radio)$/i;!function(){var e=J.createDocumentFragment(),t=e.appendChild(J.createElement("div")),n=J.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),Q.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Q.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var kt="undefined";Q.focusinBubbles="onfocusin"in e;var Et=/^key/,St=/^(?:mouse|pointer|contextmenu)|click/,jt=/^(?:focusinfocus|focusoutblur)$/,Dt=/^([^.]*)(?:\.(.+)|)$/;Z.event={global:{},add:function(e,t,n,r,i){var o,s,a,u,l,c,f,p,d,h,g,m=vt.get(e);if(m)for(n.handler&&(o=n,n=o.handler,i=o.selector),n.guid||(n.guid=Z.guid++),(u=m.events)||(u=m.events={}),(s=m.handle)||(s=m.handle=function(t){return typeof Z!==kt&&Z.event.triggered!==t.type?Z.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(dt)||[""],l=t.length;l--;)a=Dt.exec(t[l])||[],d=g=a[1],h=(a[2]||"").split(".").sort(),d&&(f=Z.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=Z.event.special[d]||{},c=Z.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&Z.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||(p=u[d]=[],p.delegateCount=0,f.setup&&f.setup.call(e,r,h,s)!==!1||e.addEventListener&&e.addEventListener(d,s,!1)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),Z.event.global[d]=!0)},remove:function(e,t,n,r,i){var o,s,a,u,l,c,f,p,d,h,g,m=vt.hasData(e)&&vt.get(e);if(m&&(u=m.events)){for(t=(t||"").match(dt)||[""],l=t.length;l--;)if(a=Dt.exec(t[l])||[],d=g=a[1],h=(a[2]||"").split(".").sort(),d){for(f=Z.event.special[d]||{},d=(r?f.delegateType:f.bindType)||d,p=u[d]||[],a=a[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));s&&!p.length&&(f.teardown&&f.teardown.call(e,h,m.handle)!==!1||Z.removeEvent(e,d,m.handle),delete u[d])}else for(d in u)Z.event.remove(e,d+t[l],n,r,!0);Z.isEmptyObject(u)&&(delete m.handle,vt.remove(e,"events"))}},trigger:function(t,n,r,i){var o,s,a,u,l,c,f,p=[r||J],d=G.call(t,"type")?t.type:t,h=G.call(t,"namespace")?t.namespace.split("."):[];if(s=a=r=r||J,3!==r.nodeType&&8!==r.nodeType&&!jt.test(d+Z.event.triggered)&&(d.indexOf(".")>=0&&(h=d.split("."),d=h.shift(),h.sort()),l=d.indexOf(":")<0&&"on"+d,t=t[Z.expando]?t:new Z.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=h.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:Z.makeArray(n,[t]),f=Z.event.special[d]||{},i||!f.trigger||f.trigger.apply(r,n)!==!1)){if(!i&&!f.noBubble&&!Z.isWindow(r)){for(u=f.delegateType||d,jt.test(u+d)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(r.ownerDocument||J)&&p.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=p[o++])&&!t.isPropagationStopped();)t.type=o>1?u:f.bindType||d,c=(vt.get(s,"events")||{})[t.type]&&vt.get(s,"handle"),c&&c.apply(s,n),c=l&&s[l],c&&c.apply&&Z.acceptData(s)&&(t.result=c.apply(s,n),t.result===!1&&t.preventDefault());return t.type=d,i||t.isDefaultPrevented()||f._default&&f._default.apply(p.pop(),n)!==!1||!Z.acceptData(r)||l&&Z.isFunction(r[d])&&!Z.isWindow(r)&&(a=r[l],a&&(r[l]=null),Z.event.triggered=d,r[d](),Z.event.triggered=void 0,a&&(r[l]=a)),t.result}},dispatch:function(e){e=Z.event.fix(e);var t,n,r,i,o,s=[],a=_.call(arguments),u=(vt.get(this,"events")||{})[e.type]||[],l=Z.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){for(s=Z.event.handlers.call(this,e,u),t=0;(i=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,r=((Z.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a),void 0!==r&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!==this;u=u.parentNode||this)if(u.disabled!==!0||"click"!==e.type){for(r=[],n=0;a>n;n++)o=t[n],i=o.selector+" ",void 0===r[i]&&(r[i]=o.needsContext?Z(i,this).index(u)>=0:Z.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,o=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||J,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[Z.expando])return e;var t,n,r,i=e.type,o=e,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=St.test(i)?this.mouseHooks:Et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new Z.Event(o),t=r.length;t--;)n=r[t],e[n]=o[n];return e.target||(e.target=J),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==f()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===f()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Z.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Z.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=Z.extend(new Z.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?Z.event.trigger(i,null,t):Z.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},Z.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},Z.Event=function(e,t){return this instanceof Z.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?l:c):this.type=e,t&&Z.extend(this,t),this.timeStamp=e&&e.timeStamp||Z.now(),void(this[Z.expando]=!0)):new Z.Event(e,t)},Z.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=l,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Z.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!Z.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),Q.focusinBubbles||Z.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){Z.event.simulate(t,e.target,Z.event.fix(e),!0)};Z.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=vt.access(r,t);i||r.addEventListener(e,n,!0),vt.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=vt.access(r,t)-1;i?vt.access(r,t,i):(r.removeEventListener(e,n,!0),vt.remove(r,t))}}}),Z.fn.extend({on:function(e,t,n,r,i){var o,s;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(s in e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=void 0):null==r&&("string"==typeof t?(r=n,n=void 0):(r=n,n=t,t=void 0)),r===!1)r=c;else if(!r)return this;return 1===i&&(o=r,r=function(e){return Z().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=Z.guid++)),this.each(function(){Z.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,Z(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=c),this.each(function(){Z.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){Z.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?Z.event.trigger(e,t,n,!0):void 0}});var At=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Lt=/<([\w:]+)/,qt=/<|&#?\w+;/,Ht=/<(?:script|style|link)/i,Ot=/checked\s*(?:[^=]|=\s*.checked.)/i,Ft=/^$|\/(?:java|ecma)script/i,Pt=/^true\/(.*)/,Mt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Rt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Rt.optgroup=Rt.option,Rt.tbody=Rt.tfoot=Rt.colgroup=Rt.caption=Rt.thead,Rt.th=Rt.td,Z.extend({clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=Z.contains(e.ownerDocument,e);if(!(Q.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Z.isXMLDoc(e)))for(s=v(a),o=v(e),r=0,i=o.length;i>r;r++)y(o[r],s[r]);if(t)if(n)for(o=o||v(e),s=s||v(a),r=0,i=o.length;i>r;r++)m(o[r],s[r]);else m(e,a);return s=v(a,"script"),s.length>0&&g(s,!u&&v(e,"script")),a},buildFragment:function(e,t,n,r){for(var i,o,s,a,u,l,c=t.createDocumentFragment(),f=[],p=0,d=e.length;d>p;p++)if(i=e[p],i||0===i)if("object"===Z.type(i))Z.merge(f,i.nodeType?[i]:i);else if(qt.test(i)){for(o=o||c.appendChild(t.createElement("div")),s=(Lt.exec(i)||["",""])[1].toLowerCase(),a=Rt[s]||Rt._default,o.innerHTML=a[1]+i.replace(At,"<$1></$2>")+a[2],l=a[0];l--;)o=o.lastChild;Z.merge(f,o.childNodes),o=c.firstChild,o.textContent=""}else f.push(t.createTextNode(i));for(c.textContent="",p=0;i=f[p++];)if((!r||-1===Z.inArray(i,r))&&(u=Z.contains(i.ownerDocument,i),o=v(c.appendChild(i),"script"),u&&g(o),n))for(l=0;i=o[l++];)Ft.test(i.type||"")&&n.push(i);return c},cleanData:function(e){for(var t,n,r,i,o=Z.event.special,s=0;void 0!==(n=e[s]);s++){if(Z.acceptData(n)&&(i=n[vt.expando],i&&(t=vt.cache[i]))){if(t.events)for(r in t.events)o[r]?Z.event.remove(n,r):Z.removeEvent(n,r,t.handle);vt.cache[i]&&delete vt.cache[i]}delete yt.cache[n[yt.expando]]}}}),Z.fn.extend({text:function(e){return mt(this,function(e){return void 0===e?Z.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=p(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=p(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?Z.filter(e,this):this,i=0;null!=(n=r[i]);i++)t||1!==n.nodeType||Z.cleanData(v(n)),n.parentNode&&(t&&Z.contains(n.ownerDocument,n)&&g(v(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Z.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Z.clone(this,e,t)})},html:function(e){return mt(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ht.test(e)&&!Rt[(Lt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(At,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(Z.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Z.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=z.apply([],e);var n,r,i,o,s,a,u=0,l=this.length,c=this,f=l-1,p=e[0],g=Z.isFunction(p);if(g||l>1&&"string"==typeof p&&!Q.checkClone&&Ot.test(p))return this.each(function(n){var r=c.eq(n);g&&(e[0]=p.call(this,n,r.html())),r.domManip(e,t)});if(l&&(n=Z.buildFragment(e,this[0].ownerDocument,!1,this),r=n.firstChild,1===n.childNodes.length&&(n=r),r)){for(i=Z.map(v(n,"script"),d),o=i.length;l>u;u++)s=n,u!==f&&(s=Z.clone(s,!0,!0),o&&Z.merge(i,v(s,"script"))),t.call(this[u],s,u);if(o)for(a=i[i.length-1].ownerDocument,Z.map(i,h),u=0;o>u;u++)s=i[u],Ft.test(s.type||"")&&!vt.access(s,"globalEval")&&Z.contains(a,s)&&(s.src?Z._evalUrl&&Z._evalUrl(s.src):Z.globalEval(s.textContent.replace(Mt,"")))}return this}}),Z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Z.fn[e]=function(e){for(var n,r=[],i=Z(e),o=i.length-1,s=0;o>=s;s++)n=s===o?this:this.clone(!0),Z(i[s])[t](n),X.apply(r,n.get());return this.pushStack(r)}});var Wt,$t={},Bt=/^margin/,It=new RegExp("^("+wt+")(?!px)[a-z%]+$","i"),_t=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)};!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",i.appendChild(o);var t=e.getComputedStyle(s,null);n="1%"!==t.top,r="4px"===t.width,i.removeChild(o)}var n,r,i=J.documentElement,o=J.createElement("div"),s=J.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",Q.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(s),e.getComputedStyle&&Z.extend(Q,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return null==r&&t(),r},reliableMarginRight:function(){var t,n=s.appendChild(J.createElement("div"));return n.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",s.style.width="1px",i.appendChild(o),t=!parseFloat(e.getComputedStyle(n,null).marginRight),i.removeChild(o),t}}))}(),Z.swap=function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=s[o];return i};var zt=/^(none|table(?!-c[ea]).+)/,Xt=new RegExp("^("+wt+")(.*)$","i"),Ut=new RegExp("^([+-])=("+wt+")","i"),Vt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:"0",fontWeight:"400"},Gt=["Webkit","O","Moz","ms"];Z.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=w(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=Z.camelCase(t),u=e.style;return t=Z.cssProps[a]||(Z.cssProps[a]=C(u,a)),s=Z.cssHooks[t]||Z.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:u[t]:(o=typeof n,"string"===o&&(i=Ut.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(Z.css(e,t)),o="number"),null!=n&&n===n&&("number"!==o||Z.cssNumber[a]||(n+="px"),Q.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r))||(u[t]=n)),void 0)}},css:function(e,t,n,r){var i,o,s,a=Z.camelCase(t);return t=Z.cssProps[a]||(Z.cssProps[a]=C(e.style,a)),s=Z.cssHooks[t]||Z.cssHooks[a],s&&"get"in s&&(i=s.get(e,!0,n)),void 0===i&&(i=w(e,t,r)),"normal"===i&&t in Yt&&(i=Yt[t]),""===n||n?(o=parseFloat(i),n===!0||Z.isNumeric(o)?o||0:i):i}}),Z.each(["height","width"],function(e,t){Z.cssHooks[t]={get:function(e,n,r){return n?zt.test(Z.css(e,"display"))&&0===e.offsetWidth?Z.swap(e,Vt,function(){return E(e,t,r)}):E(e,t,r):void 0},set:function(e,n,r){var i=r&&_t(e);return N(e,n,r?k(e,t,r,"border-box"===Z.css(e,"boxSizing",!1,i),i):0)}}}),Z.cssHooks.marginRight=T(Q.reliableMarginRight,function(e,t){return t?Z.swap(e,{display:"inline-block"},w,[e,"marginRight"]):void 0}),Z.each({margin:"",padding:"",border:"Width"},function(e,t){Z.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+Tt[r]+t]=o[r]||o[r-2]||o[0];return i}},Bt.test(e)||(Z.cssHooks[e+t].set=N)}),Z.fn.extend({css:function(e,t){return mt(this,function(e,t,n){var r,i,o={},s=0;if(Z.isArray(t)){for(r=_t(e),i=t.length;i>s;s++)o[t[s]]=Z.css(e,t[s],!1,r);return o}return void 0!==n?Z.style(e,t,n):Z.css(e,t)},e,t,arguments.length>1)},show:function(){return S(this,!0)},hide:function(){return S(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ct(this)?Z(this).show():Z(this).hide()})}}),Z.Tween=j,j.prototype={constructor:j,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(Z.cssNumber[n]?"":"px")},cur:function(){var e=j.propHooks[this.prop];return e&&e.get?e.get(this):j.propHooks._default.get(this)},run:function(e){var t,n=j.propHooks[this.prop];return this.pos=t=this.options.duration?Z.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):j.propHooks._default.set(this),this}},j.prototype.init.prototype=j.prototype,j.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Z.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Z.fx.step[e.prop]?Z.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Z.cssProps[e.prop]]||Z.cssHooks[e.prop])?Z.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},j.propHooks.scrollTop=j.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Z.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Z.fx=j.prototype.init,Z.fx.step={};var Qt,Jt,Kt=/^(?:toggle|show|hide)$/,Zt=new RegExp("^(?:([+-])=|)("+wt+")([a-z%]*)$","i"),en=/queueHooks$/,tn=[q],nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Zt.exec(t),o=i&&i[3]||(Z.cssNumber[e]?"":"px"),s=(Z.cssNumber[e]||"px"!==o&&+r)&&Zt.exec(Z.css(n.elem,e)),a=1,u=20;if(s&&s[3]!==o){o=o||s[3],i=i||[],s=+r||1;do a=a||".5",s/=a,Z.style(n.elem,e,s+o);while(a!==(a=n.cur()/r)&&1!==a&&--u)}return i&&(s=n.start=+s||+r||0,n.unit=o,n.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),n}]};Z.Animation=Z.extend(O,{tweener:function(e,t){Z.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],nn[n]=nn[n]||[],nn[n].unshift(t)},prefilter:function(e,t){t?tn.unshift(e):tn.push(e)}}),Z.speed=function(e,t,n){var r=e&&"object"==typeof e?Z.extend({},e):{complete:n||!n&&t||Z.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Z.isFunction(t)&&t};return r.duration=Z.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in Z.fx.speeds?Z.fx.speeds[r.duration]:Z.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){Z.isFunction(r.old)&&r.old.call(this),r.queue&&Z.dequeue(this,r.queue)},r},Z.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Ct).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=Z.isEmptyObject(e),o=Z.speed(t,n,r),s=function(){var t=O(this,Z.extend({},e),o);(i||vt.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=Z.timers,s=vt.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&en.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));(t||!n)&&Z.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=vt.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=Z.timers,s=r?r.length:0;for(n.finish=!0,Z.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),Z.each(["toggle","show","hide"],function(e,t){var n=Z.fn[t];
Z.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(A(t,!0),e,r,i)}}),Z.each({slideDown:A("show"),slideUp:A("hide"),slideToggle:A("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Z.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),Z.timers=[],Z.fx.tick=function(){var e,t=0,n=Z.timers;for(Qt=Z.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||Z.fx.stop(),Qt=void 0},Z.fx.timer=function(e){Z.timers.push(e),e()?Z.fx.start():Z.timers.pop()},Z.fx.interval=13,Z.fx.start=function(){Jt||(Jt=setInterval(Z.fx.tick,Z.fx.interval))},Z.fx.stop=function(){clearInterval(Jt),Jt=null},Z.fx.speeds={slow:600,fast:200,_default:400},Z.fn.delay=function(e,t){return e=Z.fx?Z.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e=J.createElement("input"),t=J.createElement("select"),n=t.appendChild(J.createElement("option"));e.type="checkbox",Q.checkOn=""!==e.value,Q.optSelected=n.selected,t.disabled=!0,Q.optDisabled=!n.disabled,e=J.createElement("input"),e.value="t",e.type="radio",Q.radioValue="t"===e.value}();var rn,on,sn=Z.expr.attrHandle;Z.fn.extend({attr:function(e,t){return mt(this,Z.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Z.removeAttr(this,e)})}}),Z.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===kt?Z.prop(e,t,n):(1===o&&Z.isXMLDoc(e)||(t=t.toLowerCase(),r=Z.attrHooks[t]||(Z.expr.match.bool.test(t)?on:rn)),void 0===n?r&&"get"in r&&null!==(i=r.get(e,t))?i:(i=Z.find.attr(e,t),null==i?void 0:i):null!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):void Z.removeAttr(e,t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(dt);if(o&&1===e.nodeType)for(;n=o[i++];)r=Z.propFix[n]||n,Z.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!Q.radioValue&&"radio"===t&&Z.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),on={set:function(e,t,n){return t===!1?Z.removeAttr(e,n):e.setAttribute(n,n),n}},Z.each(Z.expr.match.bool.source.match(/\w+/g),function(e,t){var n=sn[t]||Z.find.attr;sn[t]=function(e,t,r){var i,o;return r||(o=sn[t],sn[t]=i,i=null!=n(e,t,r)?t.toLowerCase():null,sn[t]=o),i}});var an=/^(?:input|select|textarea|button)$/i;Z.fn.extend({prop:function(e,t){return mt(this,Z.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Z.propFix[e]||e]})}}),Z.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o=1!==s||!Z.isXMLDoc(e),o&&(t=Z.propFix[t]||t,i=Z.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||an.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Q.optSelected||(Z.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Z.propFix[this.toLowerCase()]=this});var un=/[\t\r\n\f]/g;Z.fn.extend({addClass:function(e){var t,n,r,i,o,s,a="string"==typeof e&&e,u=0,l=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(dt)||[];l>u;u++)if(n=this[u],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(un," "):" ")){for(o=0;i=t[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");s=Z.trim(r),n.className!==s&&(n.className=s)}return this},removeClass:function(e){var t,n,r,i,o,s,a=0===arguments.length||"string"==typeof e&&e,u=0,l=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(dt)||[];l>u;u++)if(n=this[u],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(un," "):"")){for(o=0;i=t[o++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");s=e?Z.trim(r):"",n.className!==s&&(n.className=s)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(Z.isFunction(e)?function(n){Z(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var t,r=0,i=Z(this),o=e.match(dt)||[];t=o[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else(n===kt||"boolean"===n)&&(this.className&&vt.set(this,"__className__",this.className),this.className=this.className||e===!1?"":vt.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(un," ").indexOf(t)>=0)return!0;return!1}});var ln=/\r/g;Z.fn.extend({val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=Z.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,Z(this).val()):e,null==i?i="":"number"==typeof i?i+="":Z.isArray(i)&&(i=Z.map(i,function(e){return null==e?"":e+""})),t=Z.valHooks[this.type]||Z.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return t=Z.valHooks[i.type]||Z.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:(n=i.value,"string"==typeof n?n.replace(ln,""):null==n?"":n)}}}),Z.extend({valHooks:{option:{get:function(e){var t=Z.find.attr(e,"value");return null!=t?t:Z.trim(Z.text(e))}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,s=o?null:[],a=o?i+1:r.length,u=0>i?a:o?i:0;a>u;u++)if(n=r[u],!(!n.selected&&u!==i||(Q.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&Z.nodeName(n.parentNode,"optgroup"))){if(t=Z(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=Z.makeArray(t),s=i.length;s--;)r=i[s],(r.selected=Z.inArray(r.value,o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),Z.each(["radio","checkbox"],function(){Z.valHooks[this]={set:function(e,t){return Z.isArray(t)?e.checked=Z.inArray(Z(e).val(),t)>=0:void 0}},Q.checkOn||(Z.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Z.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Z.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),Z.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var cn=Z.now(),fn=/\?/;Z.parseJSON=function(e){return JSON.parse(e+"")},Z.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Z.error("Invalid XML: "+e),t};var pn,dn,hn=/#.*$/,gn=/([?&])_=[^&]*/,mn=/^(.*?):[ \t]*([^\r\n]*)$/gm,vn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,yn=/^(?:GET|HEAD)$/,xn=/^\/\//,bn=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,wn={},Tn={},Cn="*/".concat("*");try{dn=location.href}catch(Nn){dn=J.createElement("a"),dn.href="",dn=dn.href}pn=bn.exec(dn.toLowerCase())||[],Z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:dn,type:"GET",isLocal:vn.test(pn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Cn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Z.parseJSON,"text xml":Z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?M(M(e,Z.ajaxSettings),t):M(Z.ajaxSettings,e)},ajaxPrefilter:F(wn),ajaxTransport:F(Tn),ajax:function(e,t){function n(e,t,n,s){var u,c,v,y,b,T=t;2!==x&&(x=2,a&&clearTimeout(a),r=void 0,o=s||"",w.readyState=e>0?4:0,u=e>=200&&300>e||304===e,n&&(y=R(f,w,n)),y=W(f,y,w,u),u?(f.ifModified&&(b=w.getResponseHeader("Last-Modified"),b&&(Z.lastModified[i]=b),b=w.getResponseHeader("etag"),b&&(Z.etag[i]=b)),204===e||"HEAD"===f.type?T="nocontent":304===e?T="notmodified":(T=y.state,c=y.data,v=y.error,u=!v)):(v=T,(e||!T)&&(T="error",0>e&&(e=0))),w.status=e,w.statusText=(t||T)+"",u?h.resolveWith(p,[c,T,w]):h.rejectWith(p,[w,T,v]),w.statusCode(m),m=void 0,l&&d.trigger(u?"ajaxSuccess":"ajaxError",[w,f,u?c:v]),g.fireWith(p,[w,T]),l&&(d.trigger("ajaxComplete",[w,f]),--Z.active||Z.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var r,i,o,s,a,u,l,c,f=Z.ajaxSetup({},t),p=f.context||f,d=f.context&&(p.nodeType||p.jquery)?Z(p):Z.event,h=Z.Deferred(),g=Z.Callbacks("once memory"),m=f.statusCode||{},v={},y={},x=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!s)for(s={};t=mn.exec(o);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=y[n]=y[n]||e,v[e]=t),this},overrideMimeType:function(e){return x||(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>x)for(t in e)m[t]=[m[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return r&&r.abort(t),n(0,t),this}};if(h.promise(w).complete=g.add,w.success=w.done,w.error=w.fail,f.url=((e||f.url||dn)+"").replace(hn,"").replace(xn,pn[1]+"//"),f.type=t.method||t.type||f.method||f.type,f.dataTypes=Z.trim(f.dataType||"*").toLowerCase().match(dt)||[""],null==f.crossDomain&&(u=bn.exec(f.url.toLowerCase()),f.crossDomain=!(!u||u[1]===pn[1]&&u[2]===pn[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(pn[3]||("http:"===pn[1]?"80":"443")))),f.data&&f.processData&&"string"!=typeof f.data&&(f.data=Z.param(f.data,f.traditional)),P(wn,f,t,w),2===x)return w;l=f.global,l&&0===Z.active++&&Z.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!yn.test(f.type),i=f.url,f.hasContent||(f.data&&(i=f.url+=(fn.test(i)?"&":"?")+f.data,delete f.data),f.cache===!1&&(f.url=gn.test(i)?i.replace(gn,"$1_="+cn++):i+(fn.test(i)?"&":"?")+"_="+cn++)),f.ifModified&&(Z.lastModified[i]&&w.setRequestHeader("If-Modified-Since",Z.lastModified[i]),Z.etag[i]&&w.setRequestHeader("If-None-Match",Z.etag[i])),(f.data&&f.hasContent&&f.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",f.contentType),w.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Cn+"; q=0.01":""):f.accepts["*"]);for(c in f.headers)w.setRequestHeader(c,f.headers[c]);if(f.beforeSend&&(f.beforeSend.call(p,w,f)===!1||2===x))return w.abort();b="abort";for(c in{success:1,error:1,complete:1})w[c](f[c]);if(r=P(Tn,f,t,w)){w.readyState=1,l&&d.trigger("ajaxSend",[w,f]),f.async&&f.timeout>0&&(a=setTimeout(function(){w.abort("timeout")},f.timeout));try{x=1,r.send(v,n)}catch(T){if(!(2>x))throw T;n(-1,T)}}else n(-1,"No Transport");return w},getJSON:function(e,t,n){return Z.get(e,t,n,"json")},getScript:function(e,t){return Z.get(e,void 0,t,"script")}}),Z.each(["get","post"],function(e,t){Z[t]=function(e,n,r,i){return Z.isFunction(n)&&(i=i||r,r=n,n=void 0),Z.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),Z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Z.fn[t]=function(e){return this.on(t,e)}}),Z._evalUrl=function(e){return Z.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Z.fn.extend({wrapAll:function(e){var t;return Z.isFunction(e)?this.each(function(t){Z(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Z(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(Z.isFunction(e)?function(t){Z(this).wrapInner(e.call(this,t))}:function(){var t=Z(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Z.isFunction(e);return this.each(function(n){Z(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Z.nodeName(this,"body")||Z(this).replaceWith(this.childNodes)}).end()}}),Z.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Z.expr.filters.visible=function(e){return!Z.expr.filters.hidden(e)};var kn=/%20/g,En=/\[\]$/,Sn=/\r?\n/g,jn=/^(?:submit|button|image|reset|file)$/i,Dn=/^(?:input|select|textarea|keygen)/i;Z.param=function(e,t){var n,r=[],i=function(e,t){t=Z.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Z.ajaxSettings&&Z.ajaxSettings.traditional),Z.isArray(e)||e.jquery&&!Z.isPlainObject(e))Z.each(e,function(){i(this.name,this.value)});else for(n in e)$(n,e[n],t,i);return r.join("&").replace(kn,"+")},Z.fn.extend({serialize:function(){return Z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Z.prop(this,"elements");return e?Z.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Z(this).is(":disabled")&&Dn.test(this.nodeName)&&!jn.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var n=Z(this).val();return null==n?null:Z.isArray(n)?Z.map(n,function(e){return{name:t.name,value:e.replace(Sn,"\r\n")}}):{name:t.name,value:n.replace(Sn,"\r\n")}}).get()}}),Z.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var An=0,Ln={},qn={0:200,1223:204},Hn=Z.ajaxSettings.xhr();e.ActiveXObject&&Z(e).on("unload",function(){for(var e in Ln)Ln[e]()}),Q.cors=!!Hn&&"withCredentials"in Hn,Q.ajax=Hn=!!Hn,Z.ajaxTransport(function(e){var t;return Q.cors||Hn&&!e.crossDomain?{send:function(n,r){var i,o=e.xhr(),s=++An;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete Ln[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?r(o.status,o.statusText):r(qn[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=Ln[s]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(a){if(t)throw a}},abort:function(){t&&t()}}:void 0}),Z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Z.globalEval(e),e}}}),Z.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Z.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=Z("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),J.head.appendChild(t[0])},abort:function(){n&&n()}}}});var On=[],Fn=/(=)\?(?=&|$)|\?\?/;Z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=On.pop()||Z.expando+"_"+cn++;return this[e]=!0,e}}),Z.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=t.jsonp!==!1&&(Fn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fn.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=Z.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Fn,"$1"+i):t.jsonp!==!1&&(t.url+=(fn.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||Z.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,On.push(i)),s&&Z.isFunction(o)&&o(s[0]),s=o=void 0}),"script"):void 0}),Z.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||J;var r=st.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=Z.buildFragment([e],t,i),i&&i.length&&Z(i).remove(),Z.merge([],r.childNodes))};var Pn=Z.fn.load;Z.fn.load=function(e,t,n){if("string"!=typeof e&&Pn)return Pn.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return a>=0&&(r=Z.trim(e.slice(a)),e=e.slice(0,a)),Z.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),s.length>0&&Z.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?Z("<div>").append(Z.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},Z.expr.filters.animated=function(e){return Z.grep(Z.timers,function(t){return e===t.elem}).length};var Mn=e.document.documentElement;Z.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,l,c=Z.css(e,"position"),f=Z(e),p={};"static"===c&&(e.style.position="relative"),a=f.offset(),o=Z.css(e,"top"),u=Z.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=f.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),Z.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(p.top=t.top-a.top+s),null!=t.left&&(p.left=t.left-a.left+i),"using"in t?t.using.call(e,p):f.css(p)}},Z.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Z.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},o=r&&r.ownerDocument;if(o)return t=o.documentElement,Z.contains(t,r)?(typeof r.getBoundingClientRect!==kt&&(i=r.getBoundingClientRect()),n=B(o),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===Z.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Z.nodeName(e[0],"html")||(r=e.offset()),r.top+=Z.css(e[0],"borderTopWidth",!0),r.left+=Z.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-Z.css(n,"marginTop",!0),left:t.left-r.left-Z.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Mn;e&&!Z.nodeName(e,"html")&&"static"===Z.css(e,"position");)e=e.offsetParent;return e||Mn})}}),Z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;Z.fn[t]=function(i){return mt(this,function(t,i,o){var s=B(t);return void 0===o?s?s[n]:t[i]:void(s?s.scrollTo(r?e.pageXOffset:o,r?o:e.pageYOffset):t[i]=o)},t,i,arguments.length,null)}}),Z.each(["top","left"],function(e,t){Z.cssHooks[t]=T(Q.pixelPosition,function(e,n){return n?(n=w(e,t),It.test(n)?Z(e).position()[t]+"px":n):void 0})}),Z.each({Height:"height",Width:"width"},function(e,t){Z.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){Z.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||i===!0?"margin":"border");return mt(this,function(t,n,r){var i;return Z.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===r?Z.css(t,n,s):Z.style(t,n,r,s)},t,o?r:void 0,o,null)}})}),Z.fn.size=function(){return this.length},Z.fn.andSelf=Z.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Z});var Rn=e.jQuery,Wn=e.$;return Z.noConflict=function(t){return e.$===Z&&(e.$=Wn),t&&e.jQuery===Z&&(e.jQuery=Rn),Z},typeof t===kt&&(e.jQuery=e.$=Z),Z});
var Handsontable={plugins:{},helper:{}};!function(e,t,o){"use strict";function n(){this.refCounter=0,this.init()}function i(){function e(){var e=this;e._registerTimeout(setTimeout(function(){e.updateSettings({observeChanges:!0})},0))}function t(e){return function(t,o){return t[1]===o[1]?0:null===t[1]?1:null===o[1]?-1:t[1]<o[1]?e?-1:1:t[1]>o[1]?e?1:-1:0}}function n(e){return function(t,o){if(t[1]===o[1])return 0;if(null===t[1])return 1;if(null===o[1])return-1;var n=new Date(t[1]),i=new Date(o[1]);return i>n?e?-1:1:n>i?e?1:-1:0}}function i(e){return"undefined"!=typeof e.sortColumn}var r=this;this.init=function(t){var o,n,i=this,s=i.getSettings().columnSorting;if(i.sortingEnabled=!!s,i.sortingEnabled){i.sortIndex=[];var c=a.call(i);"undefined"!=typeof c?(o=c.sortColumn,n=c.sortOrder):(o=s.column,n=s.sortOrder),r.sortByColumn.call(i,o,n),i.sort=function(){var e=Array.prototype.slice.call(arguments);return r.sortByColumn.apply(i,e)},"undefined"==typeof i.getSettings().observeChanges&&e.call(i),"afterInit"==t&&(l.call(i),i.addHook("afterCreateRow",r.afterCreateRow),i.addHook("afterRemoveRow",r.afterRemoveRow),i.addHook("afterLoadData",r.init))}else delete i.sort,i.removeHook("afterCreateRow",r.afterCreateRow),i.removeHook("afterRemoveRow",r.afterRemoveRow),i.removeHook("afterLoadData",r.init)},this.setSortingColumn=function(e,t){var o=this;return"undefined"==typeof e?(delete o.sortColumn,void delete o.sortOrder):(o.sortOrder=o.sortColumn===e&&"undefined"==typeof t?!o.sortOrder:"undefined"!=typeof t?t:!0,void(o.sortColumn=e))},this.sortByColumn=function(e,t){var n=this;r.setSortingColumn.call(n,e,t),"undefined"!=typeof n.sortColumn&&(o.hooks.run(n,"beforeColumnSort",n.sortColumn,n.sortOrder),r.sort.call(n),n.render(),s.call(n),o.hooks.run(n,"afterColumnSort",n.sortColumn,n.sortOrder))};var s=function(){var e=this,t={};"undefined"!=typeof e.sortColumn&&(t.sortColumn=e.sortColumn),"undefined"!=typeof e.sortOrder&&(t.sortOrder=e.sortOrder),(t.hasOwnProperty("sortColumn")||t.hasOwnProperty("sortOrder"))&&o.hooks.run(e,"persistentStateSave","columnSorting",t)},a=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","columnSorting",t),t.value},l=function(){function e(){var e=n.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function t(t){var n=o.Dom.closest(t,"TH");return o.Dom.index(n)-e()}var n=this;n.rootElement.on("click.handsontable",".columnSorting",function(e){if(o.Dom.hasClass(e.target,"columnSorting")){var i=t(e.target);r.sortByColumn.call(n,i)}})};this.sort=function(){var e=this;if("undefined"!=typeof e.sortOrder){e.sortingEnabled=!1,e.sortIndex.length=0;for(var o=this.colOffset(),i=0,r=this.countRows()-e.getSettings().minSpareRows;r>i;i++)this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+o)]);var s,a=e.getCellMeta(0,e.sortColumn);switch(a.type){case"date":s=n;break;default:s=t}this.sortIndex.sort(s(e.sortOrder));for(var i=this.sortIndex.length;i<e.countRows();i++)this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+o)]);e.sortingEnabled=!0}},this.translateRow=function(e){var t=this;return t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]?t.sortIndex[e][0]:e},this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length)for(var o=0;o<t.sortIndex.length;o++)if(t.sortIndex[o][0]==e)return o},this.getColHeader=function(e,t){this.getSettings().columnSorting&&o.Dom.addClass(t.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(e,t){var o=this;if(i(o)){for(var n=0;n<o.sortIndex.length;n++)o.sortIndex[n][0]>=e&&(o.sortIndex[n][0]+=t);for(var n=0;t>n;n++)o.sortIndex.splice(e+n,0,[e+n,o.getData()[e+n][o.sortColumn+o.colOffset()]]);s.call(o)}},this.afterRemoveRow=function(e,t){var o=this;if(i(o)){var n=r.translateRow.call(o,e);o.sortIndex.splice(e,t);for(var a=0;a<o.sortIndex.length;a++)o.sortIndex[a][0]>n&&(o.sortIndex[a][0]-=t);s.call(o)}},this.afterChangeSort=function(e){var t=this,o=!1,n={};if(e){for(var i=0;i<e.length;i++)if(e[i][1]==t.sortColumn){o=!0,n.row=r.translateRow.call(t,e[i][0]),n.col=e[i][1];break}o&&t._registerTimeout(setTimeout(function(){r.sort.call(t),t.render(),t.selectCell(r.untranslateRow.call(t,n.row),n.col)},0))}}}function r(t){var n=function(e,t,o,n){n.setCellMeta(e,t,"comment",o),n.render()},i=function(e,t,o){n(e.from.row,e.from.col,t,o)},r=function(){var e=c();e.style.display="none",e.value=""},s=function(n){function s(o){if(e(document).off("mouseover.htCommment"),"htCommentTextArea"!=o.target.className&&-1==o.target.innerHTML.indexOf("Comment")){var s=document.getElementsByClassName("htCommentTextArea")[0].value;s.trim().length>1&&i(n,s,t),a(),r()}}e(document).on("mousedown.htCommment",o.helper.proxy(s))},a=function(){e(document).off("mousedown.htCommment"),e(document).on("mouseover.htCommment",o.helper.proxy(h))},l=function(e,n){var i=t.view.wt.wtTable.getCell(e.from),r=o.Dom.offset(i),a=t.getColWidth(e.from.col);n.style.position="absolute",n.style.left=r.left+a+"px",n.style.top=r.top+"px",n.style.zIndex=2,s(e,n)},c=function(e){var t=document.getElementsByClassName("htComments")[0];if(!t){t=document.createElement("DIV");var n=document.createElement("TEXTAREA");o.Dom.addClass(n,"htCommentTextArea"),t.appendChild(n),o.Dom.addClass(t,"htComments"),document.getElementsByTagName("body")[0].appendChild(t)}return e=e||"",document.getElementsByClassName("htCommentTextArea")[0].value=e,t},h=function(e){if(-1!=e.target.className.indexOf("htCommentCell")){a();var n=t.view.wt.wtTable.getCoords(e.target),i={from:new f(n.row,n.col)};o.Comments.showComment(i)}else"htCommentTextArea"!=e.target.className&&r()};return{init:function(){e(document).on("mouseover.htCommment",o.helper.proxy(h))},showComment:function(e){var o=t.getCellMeta(e.from.row,e.from.col),n="";o.comment&&(n=o.comment);var i=c(n);i.style.display="block",l(e,i)},removeComment:function(e,o){t.removeCellMeta(e,o,"comment"),t.render()},checkSelectionCommentsConsistency:function(){var e=!1,o=t.getSelectedRange().from;return t.getCellMeta(o.row,o.col).comment&&(e=!0),e}}}function s(e){var o,n=function(){t.localStorage[e+"__persistentStateKeys"]=JSON.stringify(o)},i=function(){var n=t.localStorage[e+"__persistentStateKeys"],i="string"==typeof n?JSON.parse(n):void 0;o=i?i:[]},r=function(){o=[],n()};i(),this.saveValue=function(i,r){t.localStorage[e+"_"+i]=JSON.stringify(r),-1==o.indexOf(i)&&(o.push(i),n())},this.loadValue=function(o,n){o="undefined"!=typeof o?o:n;var i=t.localStorage[e+"_"+o];return"undefined"==typeof i?void 0:JSON.parse(i)},this.reset=function(o){t.localStorage.removeItem(e+"_"+o)},this.resetAll=function(){for(var n=0;n<o.length;n++)t.localStorage.removeItem(e+"_"+o[n]);r()}}function a(){this.boundaries=null,this.callback=null}function l(){var e=[];return e.getInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row<=e&&this[o].row+this[o].rowspan-1>=e&&this[o].col<=t&&this[o].col+this[o].colspan-1>=t)return this[o]},e.setInfo=function(e){for(var t=0,o=this.length;o>t;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row===e&&this[o].col===t){this.splice(o,1);break}},e}function c(e){if(this.mergedCellInfoCollection=new l,o.helper.isArray(e))for(var t=0,n=e.length;n>t;t++)this.mergedCellInfoCollection.setInfo(e[t])}function h(){}function u(e){this.instance=e}function d(t,o){var n;if(o){this.instance=t,this.settings=o,this.main=document.createElement("div"),n=this.main.style,n.position="absolute",n.top=0,n.left=0;for(var i=["top","left","bottom","right","corner"],r=0;5>r;r++){var s=i[r],a=document.createElement("DIV");a.className="wtBorder "+(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(a.className+=" hidden"),n=a.style,n.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:o.border.color,n.height=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":o.border.width+"px",n.width=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":o.border.width+"px",this.main.appendChild(a)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="5px",this.cornerStyle.height="5px",this.cornerStyle.border="2px solid #FFF",this.disappear(),t.wtTable.bordersHolder||(t.wtTable.bordersHolder=document.createElement("div"),t.wtTable.bordersHolder.className="htBorders",t.wtTable.hider.appendChild(t.wtTable.bordersHolder)),t.wtTable.bordersHolder.insertBefore(this.main,t.wtTable.bordersHolder.firstChild);var l=!1,c=e(document.body);c.on("mousedown.walkontable."+t.guid,function(){l=!0}),c.on("mouseup.walkontable."+t.guid,function(){l=!1}),e(this.main.childNodes).on("mouseenter",function(o){if(l&&t.getSetting("hideBorderOnMouseDownOver")){o.preventDefault(),o.stopImmediatePropagation();var n=this.getBoundingClientRect(),i=e(this);i.hide();var r=function(e){return e.clientY<Math.floor(n.top)?!0:e.clientY>Math.ceil(n.top+n.height)?!0:e.clientX<Math.floor(n.left)?!0:e.clientX>Math.ceil(n.left+n.width)?!0:void 0};c.on("mousemove.border."+t.guid,function(e){r(e)&&(c.off("mousemove.border."+t.guid),i.show())})}})}}function f(e,t){"undefined"!=typeof e&&"undefined"!=typeof t?(this.row=e,this.col=t):(this.row=null,this.col=null)}function p(e,t,o){this.highlight=e,this.from=t,this.to=o}function m(){this.cache=[]}function g(e,t){this.total=e,this.countTH=t}function w(e,t,o,n){var i,r=0;for(u.apply(this,arguments),this.containerSizeFn=t,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.visibleCellCount=0,this.remainingSize=0,this.strategy=n;;){if(i=o(r),void 0===i)break;this.cellSizesSum<this.getContainerSize(this.cellSizesSum+i)&&this.visibleCellCount++,this.cellSizes.push(i),this.cellSizesSum+=i,this.cellCount++,r++}var s=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-s}function y(e){var t=[];if(this.guid="wt_"+b(),e.cloneSource)this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new O(this,e.table),this.wtScroll=new T(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new C(this),this.selections=this.generateSelectionClones(this.cloneSource.selections);else{this.wtSettings=new H(this,e),this.wtTable=new O(this,e.table),this.wtScroll=new T(this),this.wtViewport=new M(this),this.wtEvent=new C(this);var n=this.getSetting("selections");this.selections=n?this.generateSelections(n):[],this.wtScrollbars=new A(this)}if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var i=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;r>i;i++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,n){o.Dom.fastInnerText(n,t[e])}])}this.drawn=!1,this.drawInterrupted=!1}function v(t){this.instance=t,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",this.lastTimeout=null;var n=this,i=0,r=0,s=n.clone.wtTable.holder.parentNode;e(document.body).on("mousemove."+this.instance.guid,function(e){n.instance.wtTable.holder.parentNode&&(e.clientX-i>-5&&e.clientX-i<5&&e.clientY-r>-5&&e.clientY-r<5||(i=e.clientX,r=e.clientY,o.Dom.addClass(s,"wtDebugHidden"),o.Dom.removeClass(s,"wtDebugVisible"),clearTimeout(this.lastTimeout),this.lastTimeout=setTimeout(function(){o.Dom.removeClass(s,"wtDebugHidden"),o.Dom.addClass(s,"wtDebugVisible")},1e3)))})}function C(n){var i=this;this.instance=n;var r=[null,null];this.dblClickTimeout=[null,null];var s,a=function(e){var t=i.parentCell(e.target);o.Dom.hasClass(e.target,"corner")?i.instance.getSetting("onCellCornerMouseDown",e,e.target):t.TD&&i.instance.hasSetting("onCellMouseDown")&&i.instance.getSetting("onCellMouseDown",e,t.coords,t.TD,i.instance),2!==e.button&&t.TD&&(r[0]=t.TD,clearTimeout(i.dblClickTimeout[0]),i.dblClickTimeout[0]=setTimeout(function(){r[0]=null},1e3))},l=function(e){if(i.instance.hasSetting("onCellMouseOver")){var t=i.instance.wtTable.TABLE,n=o.Dom.closest(e.target,["TD","TH"],t);n&&n!==s&&o.Dom.isChildOf(n,t)&&(s=n,i.instance.getSetting("onCellMouseOver",e,i.instance.wtTable.getCoords(n),n,i.instance))}},c=function(e){if(2!==e.button){var t=i.parentCell(e.target);t.TD===r[0]&&t.TD===r[1]?(o.Dom.hasClass(e.target,"corner")?i.instance.getSetting("onCellCornerDblClick",e,t.coords,t.TD,i.instance):i.instance.getSetting("onCellDblClick",e,t.coords,t.TD,i.instance),r[0]=null,r[1]=null):t.TD===r[0]&&(r[1]=t.TD,clearTimeout(i.dblClickTimeout[1]),i.dblClickTimeout[1]=setTimeout(function(){r[1]=null},500))}};e(this.instance.wtTable.holder).on("mousedown",a),e(this.instance.wtTable.TABLE).on("mouseover",l),e(this.instance.wtTable.holder).on("mouseup",c),e(t).on("resize."+this.instance.guid,function(){i.instance.draw()})}function b(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function S(e,t,o){this.offset=e,this.total=t,this.countTH=o}function R(e,t,o){u.apply(this,arguments),this.containerSizeFn=t,this.sizeAtIndex=o,this.cellSizesSum=0,this.cellSizes=[],this.cellCount=0,this.visiblCellCount=0,this.remainingSize=-1/0,this.maxOuts=10,this.curOuts=this.maxOuts}function T(e){this.instance=e}function E(e){this.instance=e,this.type="corner",this.init(),this.clone=this.makeClone("corner")}function D(e){this.instance=e,this.type="horizontal",this.cellSize=50,this.offset=0,this.init(),this.clone=this.makeClone("left")}function k(e){this.instance=e,this.type="vertical",this.cellSize=this.instance.wtSettings.settings.defaultRowHeight,this.offset,this.total,this.init(),this.clone=this.makeClone("top")}function A(e){this.instance=e,e.update("scrollbarWidth",o.Dom.getScrollbarWidth()),e.update("scrollbarHeight",o.Dom.getScrollbarWidth()),this.vertical=new k(e),this.horizontal=new D(e),this.corner=new E(e),e.getSetting("debug")&&(this.debug=new v(e)),this.registerListeners()}function x(e,t){this.instance=e,this.settings=t,this.cellRange=null,t.border&&(this.border=new d(e,t))}function H(e,t){var n=this;this.instance=e,this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(e,t,i){var r=n.getSetting("data",e,t);o.Dom.fastInnerText(i,void 0===r||null===r?"":r)},columnWidth:50,rowHeight:function(){return 23},defaultRowHeight:23,selections:null,hideBorderOnMouseDownOver:!1,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1},this.settings={};for(var i in this.defaults)if(this.defaults.hasOwnProperty(i))if(void 0!==t[i])this.settings[i]=t[i];else{if(void 0===this.defaults[i])throw new Error('A required setting "'+i+'" was not provided');this.settings[i]=this.defaults[i]}}function O(e,t){this.instance=e,this.TABLE=t,o.Dom.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||1!==n.nodeType||!o.Dom.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.className="wtSpreader",n&&n.insertBefore(i,this.TABLE),i.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,n=this.spreader.parentNode,!n||1!==n.nodeType||!o.Dom.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtHider",n&&n.insertBefore(r,this.spreader),r.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",n=this.hider.parentNode,!n||1!==n.nodeType||!o.Dom.hasClass(n,"wtHolder")){var s=document.createElement("DIV");s.style.position="relative",s.className="wtHolder",e.cloneSource||(s.className+=" ht_master"),n&&n.insertBefore(s,this.hider),s.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var a=document.createElement("TR");this.THEAD.appendChild(a)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.oldCellCache=new m,this.currentCellCache=new m,this.rowFilter=null,this.columnFilter=null,this.columnWidthCache=[]}function P(e){this.wtTable=e,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.utils=P.utils}function M(o){this.instance=o,this.resetSettings();var n=this;e(t).on("resize.walkontable."+this.instance.guid,function(){n.clientHeight=n.getWorkspaceHeight()})}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,o=Number(arguments[1])||0;for(o=0>o?Math.ceil(o):Math.floor(o),0>o&&(o+=t);t>o;o++)if(o in this&&this[o]===e)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e,t){function o(e){return/NodeList/i.test(e.item)}function n(e){for(var t=[],o=0,n=e.length;n>o;o++)t[o]=e[o];return t}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof e)throw new TypeError;t=t||this,o(t)&&(t=n(t));var i,r,s=t.length,a=[];for(i=0;s>i;i+=1)t.hasOwnProperty(i)&&(r=t[i],e.call(t,r,i,t)&&a.push(r));return a}),"undefined"==typeof WeakMap&&!function(){var e=Object.defineProperty;try{var o=!0;e(function(){},"foo",{})}catch(n){o=!1}var i=+new Date%1e9,r=function(){this.name="__st"+(1e9*Math.random()>>>0)+(i++ +"__"),o||(this._wmCache=[])};r.prototype=o?{set:function(t,o){var n=t[this.name];n&&n[0]===t?n[1]=o:e(t,this.name,{value:[t,o],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},"delete":function(e){this.set(e,void 0)}}:{set:function(e,t){if("undefined"!=typeof e&&"undefined"!=typeof t){for(var o=0,n=this._wmCache.length;n>o;o++)if(this._wmCache[o].key==e)return void(this._wmCache[o].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value},"delete":function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},t.WeakMap=r}(),o.activeGuid=null,o.Core=function(n,i){function r(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function s(t,n,i){function s(){var r;t.length&&(r=o.hooks.execute(C,"beforeChange",t,n),"function"==typeof r?e.when(result).then(function(){i()}):r===!1&&t.splice(0,t.length)),"function"!=typeof r&&i()}var a=new r;a.onQueueEmpty=s;for(var l=t.length-1;l>=0;l--)if(null===t[l])t.splice(l,1);else{var c=t[l][0],h=g.propToCol(t[l][1]),u=C.runHooksAndReturn("modifyCol",h),d=C.getCellMeta(c,u);if("numeric"===d.type&&"string"==typeof t[l][3]&&t[l][3].length>0&&/^-?[\d\s]*(\.|\,)?\d*$/.test(t[l][3])){var f=t[l][3].length;numeral.language("undefined"==typeof d.language?"en":t[l][3].indexOf(".")===f-3&&-1===t[l][3].indexOf(",")?"en":d.language),t[l][3]=numeral().unformat(t[l][3]||"0")}C.getCellValidator(d)&&(a.addValidatorToQueue(),C.validateCell(t[l][3],d,function(e,o){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");n===!1&&o.allowInvalid===!1&&(t.splice(e,1),o.valid=!0,--e),a.removeValidatorFormQueue()}}(l,d),n))}a.checkIfQueueIsEmpty()}function a(e,t){var n=e.length-1;if(!(0>n)){for(;n>=0;n--)if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(m.settings.minSpareRows)for(;e[n][0]>C.countRows()-1;)g.createRow();if("array"===C.dataType&&m.settings.minSpareCols)for(;g.propToCol(e[n][1])>C.countCols()-1;)g.createCol();g.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1);C.forceFullRender=!0,w.adjustRowsAndCols(),o.hooks.run(C,"beforeChangeRender",e,t),y.refreshBorders(null,!0),o.hooks.run(C,"afterChange",e,t||"edit")}}function l(t,o,n){return"object"==typeof t?t:e.isPlainObject(n)?n:[[t,o,n]]}function c(e){if(e.hasOwnProperty("type")){var t,n={};if("object"==typeof e.type)t=e.type;else if("string"==typeof e.type&&(t=o.cellTypes[e.type],void 0===t))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(n[i]=t[i]);return n}}function h(e){return o.hooks.execute(C,"modifyRow",e)}function u(e){return o.hooks.execute(C,"modifyCol",e)}function d(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var m,g,w,y,v,C=this,b=function(){},S=e(document.documentElement),R=e(document.body);o.helper.extend(b.prototype,I.prototype),o.helper.extend(b.prototype,i),o.helper.extend(b.prototype,c(i)),this.rootElement=n,this.container=document.createElement("DIV"),this.container.className="htContainer",n.prepend(this.container),this.container=e(this.container),this.guid="ht_"+o.helper.randomString(),this.rootElement[0].id||(this.rootElement[0].id=this.guid),m={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new b,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},w={alter:function(e,t,n,i,r){var s;switch(n=n||1,e){case"insert_row":s=g.createRow(t,n),s&&(y.isSelected()&&m.selRange.from.row>=t?(m.selRange.from.row=m.selRange.from.row+s,y.transformEnd(s,0)):y.refreshBorders());break;case"insert_col":if(s=g.createCol(t,n)){if(o.helper.isArray(C.getSettings().colHeaders)){var a=[t,0];a.length+=s,Array.prototype.splice.apply(C.getSettings().colHeaders,a)}y.isSelected()&&m.selRange.from.col>=t?(m.selRange.from.col=m.selRange.from.col+s,y.transformEnd(0,s)):y.refreshBorders()}break;case"remove_row":g.removeRow(t,n),m.cellSettings.splice(t,n),w.adjustRowsAndCols(),y.refreshBorders();break;case"remove_col":g.removeCol(t,n);for(var l=0,c=g.getAll().length;c>l;l++)l in m.cellSettings&&m.cellSettings[l].splice(t,n);o.helper.isArray(C.getSettings().colHeaders)&&("undefined"==typeof t&&(t=-1),C.getSettings().colHeaders.splice(t,n)),m.columnSettings.splice(t,n),w.adjustRowsAndCols(),y.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}r||w.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t,o,n;if(t=C.countRows(),t<m.settings.minRows)for(e=0;e<m.settings.minRows-t;e++)g.createRow(C.countRows(),1,!0);if(o=C.countEmptyRows(!0),o<m.settings.minSpareRows)for(;o<m.settings.minSpareRows&&C.countRows()<m.settings.maxRows;o++)g.createRow(C.countRows(),1,!0);if(n=C.countEmptyCols(!0),!m.settings.columns&&C.countCols()<m.settings.minCols)for(;C.countCols()<m.settings.minCols;n++)g.createCol(C.countCols(),1,!0);if(!m.settings.columns&&"array"===C.dataType&&n<m.settings.minSpareCols)for(;n<m.settings.minSpareCols&&C.countCols()<m.settings.maxCols;n++)g.createCol(C.countCols(),1,!0);var i=C.countRows(),r=C.countCols();if((0===i||0===r)&&y.deselect(),y.isSelected()){var s,a=m.selRange.from.row,l=m.selRange.from.col,c=m.selRange.to.row,h=m.selRange.to.col;a>i-1?(a=i-1,s=!0,c>a&&(c=a)):c>i-1&&(c=i-1,s=!0,a>c&&(a=c)),l>r-1?(l=r-1,s=!0,h>l&&(h=l)):h>r-1&&(h=r-1,s=!0,l>h&&(l=h)),s&&C.selectCell(a,l,c,h)}},populateFromArray:function(e,t,n,i,r){var s,a,l,c,h=[],u={};if(a=t.length,0===a)return!1;var d,f,p,g;switch(r){case"shift_down":for(d=n?n.col-e.col+1:0,f=n?n.row-e.row+1:0,t=o.helper.translateRowsToColumns(t),l=0,c=t.length,p=Math.max(c,d);p>l;l++)if(c>l){for(s=0,a=t[l].length;f-a>s;s++)t[l].push(t[l][s%a]);t[l].unshift(e.col+l,e.row,0),C.spliceCol.apply(C,t[l])}else t[l%c][0]=e.col+l,C.spliceCol.apply(C,t[l%c]);break;case"shift_right":for(d=n?n.col-e.col+1:0,f=n?n.row-e.row+1:0,s=0,a=t.length,g=Math.max(a,f);g>s;s++)if(a>s){for(l=0,c=t[s].length;d-c>l;l++)t[s].push(t[s][l%c]);t[s].unshift(e.row+s,e.col,0),C.spliceRow.apply(C,t[s])}else t[s%a][0]=e.row+s,C.spliceRow.apply(C,t[s%a]);break;case"overwrite":default:for(u.row=e.row,u.col=e.col,s=0;a>s&&!(n&&u.row>n.row||!m.settings.minSpareRows&&u.row>C.countRows()-1||u.row>=m.settings.maxRows);s++){for(u.col=e.col,c=t[s]?t[s].length:0,l=0;c>l&&!(n&&u.col>n.col||!m.settings.minSpareCols&&u.col>C.countCols()-1||u.col>=m.settings.maxCols);l++)C.getCellMeta(u.row,u.col).readOnly||h.push([u.row,u.col,t[s][l]]),u.col++,n&&l===c-1&&(l=-1);u.row++,n&&s===a-1&&(s=-1)}C.setDataAtCell(h,null,null,i||"populateFromArray")}}},this.selection=y={inProgress:!1,begin:function(){C.selection.inProgress=!0},finish:function(){var e=C.getSelected();o.hooks.run(C,"afterSelectionEnd",e[0],e[1],e[2],e[3]),o.hooks.run(C,"afterSelectionEndByProp",e[0],C.colToProp(e[1]),e[2],C.colToProp(e[3])),C.selection.inProgress=!1},isInProgress:function(){return C.selection.inProgress},setRangeStart:function(e){o.hooks.run(C,"beforeSetRangeStart",e),m.selRange=new p(e,e,e),y.setRangeEnd(e)},setRangeEnd:function(e,t){o.hooks.run(C,"beforeSetRangeEnd",e),C.selection.begin(),m.selRange.to=e,m.settings.multiSelect||(m.selRange.from=e),C.view.wt.selections.current.clear(),C.view.wt.selections.current.add(m.selRange.highlight),C.view.wt.selections.area.clear(),y.isMultiple()&&(C.view.wt.selections.area.add(m.selRange.from),C.view.wt.selections.area.add(m.selRange.to)),(m.settings.currentRowClassName||m.settings.currentColClassName)&&(C.view.wt.selections.highlight.clear(),C.view.wt.selections.highlight.add(m.selRange.from),C.view.wt.selections.highlight.add(m.selRange.to)),o.hooks.run(C,"afterSelection",m.selRange.from.row,m.selRange.from.col,m.selRange.to.row,m.selRange.to.col),o.hooks.run(C,"afterSelectionByProp",m.selRange.from.row,g.colToProp(m.selRange.from.col),m.selRange.to.row,g.colToProp(m.selRange.to.col)),t!==!1&&C.view.mainViewIsActive()&&C.view.scrollViewport(e),y.refreshBorders()},refreshBorders:function(e,t){t||v.destroyEditor(e),C.view.render(),y.isSelected()&&!t&&v.prepareEditor()},isMultiple:function(){return!(m.selRange.to.col===m.selRange.from.col&&m.selRange.to.row===m.selRange.from.row)},transformStart:function(e,t,o){var n=new f(e,t);C.runHooks("modifyTransformStart",n),m.selRange.highlight.row+e>C.countRows()-1?o&&m.settings.minSpareRows>0?C.alter("insert_row",C.countRows()):m.settings.autoWrapCol&&(n.row=1-C.countRows(),n.col=m.selRange.highlight.col+n.col==C.countCols()-1?1-C.countCols():1):m.settings.autoWrapCol&&m.selRange.highlight.row+n.row<0&&m.selRange.highlight.col+n.col>=0&&(n.row=C.countRows()-1,n.col=m.selRange.highlight.col+n.col==0?C.countCols()-1:-1),m.selRange.highlight.col+n.col>C.countCols()-1?o&&m.settings.minSpareCols>0?C.alter("insert_col",C.countCols()):m.settings.autoWrapRow&&(n.row=m.selRange.highlight.row+n.row==C.countRows()-1?1-C.countRows():1,n.col=1-C.countCols()):m.settings.autoWrapRow&&m.selRange.highlight.col+n.col<0&&m.selRange.highlight.row+n.row>=0&&(n.row=m.selRange.highlight.row+n.row==0?C.countRows()-1:-1,n.col=C.countCols()-1);var i=C.countRows(),r=C.countCols(),s=new f(m.selRange.highlight.row+n.row,m.selRange.highlight.col+n.col);s.row<0?s.row=0:s.row>0&&s.row>=i&&(s.row=i-1),s.col<0?s.col=0:s.col>0&&s.col>=r&&(s.col=r-1),y.setRangeStart(s)},transformEnd:function(e,t){var o=new f(e,t);C.runHooks("modifyTransformEnd",o);var n=C.countRows(),i=C.countCols(),r=new f(m.selRange.to.row+o.row,m.selRange.to.col+o.col);r.row<0?r.row=0:r.row>0&&r.row>=n&&(r.row=n-1),r.col<0?r.col=0:r.col>0&&r.col>=i&&(r.col=i-1),y.setRangeEnd(r)},isSelected:function(){return null!==m.selRange},inInSelection:function(e){return y.isSelected()?m.selRange.includes(e):!1},deselect:function(){y.isSelected()&&(C.selection.inProgress=!1,m.selRange=null,C.view.wt.selections.current.clear(),C.view.wt.selections.area.clear(),(m.settings.currentRowClassName||m.settings.currentColClassName)&&C.view.wt.selections.highlight.clear(),v.destroyEditor(),y.refreshBorders(),o.hooks.run(C,"afterDeselect"))},selectAll:function(){m.settings.multiSelect&&(y.setRangeStart(new f(0,0)),y.setRangeEnd(new f(C.countRows()-1,C.countCols()-1),!1))},empty:function(){if(y.isSelected()){var e,t,o=m.selRange.getTopLeftCorner(),n=m.selRange.getBottomRightCorner(),i=[];for(e=o.row;e<=n.row;e++)for(t=o.col;t<=n.col;t++)C.getCellMeta(e,t).readOnly||i.push([e,t,""]);C.setDataAtCell(i)}}},this.init=function(){o.hooks.run(C,"beforeInit"),this.updateSettings(m.settings,!0),this.view=new o.TableView(this),v=new o.EditorManager(C,m,y,g),this.forceFullRender=!0,this.view.render(),"object"==typeof m.firstRun&&(o.hooks.run(C,"afterChange",m.firstRun[0],m.firstRun[1]),m.firstRun=!1),o.hooks.run(C,"afterInit")},this.validateCell=function(e,t,n,i){var r=C.getCellValidator(t);"[object RegExp]"===Object.prototype.toString.call(r)&&(r=function(e){return function(t,o){o(e.test(t))}}(r)),"function"==typeof r?(e=o.hooks.execute(C,"beforeValidate",e,t.row,t.prop,i),C._registerTimeout(setTimeout(function(){return r.call(t,e,function(r){t.valid=r,r=o.hooks.execute(C,"afterValidate",r,e,t.row,t.prop,i),n(r)}),e},0))):(t.valid=!0,n(!0))},this.setDataAtCell=function(e,t,o,n){var i,r,c,h=l(e,t,o),u=[];for(i=0,r=h.length;r>i;i++){if("object"!=typeof h[i])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof h[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=g.colToProp(h[i][1]),u.push([h[i][0],c,g.get(h[i][0],c),h[i][2]])}n||"object"!=typeof e||(n=t),s(u,n,function(){a(u,n)})},this.setDataAtRowProp=function(e,t,o,n){var i,r,c=l(e,t,o),h=[];for(i=0,r=c.length;r>i;i++)h.push([c[i][0],c[i][1],g.get(c[i][0],c[i][1]),c[i][2]]);n||"object"!=typeof e||(n=t),s(h,n,function(){a(h,n)})},this.listen=function(){o.activeGuid=C.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){o.activeGuid=null},this.isListening=function(){return o.activeGuid===C.guid},this.destroyEditor=function(e){y.refreshBorders(e)},this.populateFromArray=function(e,t,o,n,i,r,s){if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return w.populateFromArray(new f(e,t),o,"number"==typeof n?new f(n,i):null,r,s)},this.spliceCol=function(){return g.spliceCol.apply(g,arguments)},this.spliceRow=function(){return g.spliceRow.apply(g,arguments)},this.getSelected=function(){return y.isSelected()?[m.selRange.from.row,m.selRange.from.col,m.selRange.to.row,m.selRange.to.col]:void 0},this.getSelectedRange=function(){return y.isSelected()?m.selRange:void 0},this.render=function(){C.view&&(C.forceFullRender=!0,y.refreshBorders(null,!0))
},this.loadData=function(e){function t(){m.cellSettings.length=0}if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");e=[];for(var n,i=0,r=m.settings.startRows;r>i;i++){n=[];for(var s=0,a=m.settings.startCols;a>s;s++)n.push(null);e.push(n)}}m.isPopulated=!1,b.prototype.data=e,C.dataType=m.settings.dataSchema instanceof Array||e[0]instanceof Array?"array":"function"==typeof m.settings.dataSchema?"function":"object",g=new o.DataMap(C,m,b),t(),w.adjustRowsAndCols(),o.hooks.run(C,"afterLoadData"),m.firstRun?m.firstRun=[null,"loadData"]:(o.hooks.run(C,"afterChange",null,"loadData"),C.render()),m.isPopulated=!0},this.getData=function(e,t,o,n){return"undefined"==typeof e?g.getAll():g.getRange(new f(e,t),new f(o,n),g.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,o,n){return g.getCopyableText(new f(e,t),new f(o,n))},this.updateSettings=function(e,t){var n,i;if("undefined"!=typeof e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(n in e)"data"!==n&&(void 0!==o.hooks.hooks[n]||void 0!==o.hooks.legacy[n]?("function"==typeof e[n]||o.helper.isArray(e[n]))&&C.addHook(n,e[n]):!t&&e.hasOwnProperty(n)&&(b.prototype[n]=e[n]));if(void 0===e.data&&void 0===m.settings.data?C.loadData(null):void 0!==e.data?C.loadData(e.data):void 0!==e.columns&&g.createMap(),i=C.countCols(),m.cellSettings.length=0,i>0){var r,s;for(n=0;i>n;n++)m.columnSettings[n]=o.helper.columnFactory(b,m.columnsSettingConflicts),r=m.columnSettings[n].prototype,b.prototype.columns&&(s=b.prototype.columns[n],o.helper.extend(r,s),o.helper.extend(r,c(s)))}if("undefined"!=typeof e.cell)for(n in e.cell){var a=e.cell[n];C.setCellMetaObject(a.row,a.col,a)}if(o.hooks.run(C,"afterCellMetaReset"),"undefined"!=typeof e.className&&(b.prototype.className&&C.rootElement.removeClass(b.prototype.className),e.className&&C.rootElement.addClass(e.className)),"undefined"!=typeof e.height){var l=e.height;"function"==typeof l&&(l=l()),C.rootElement[0].style.height=l+"px"}if("undefined"!=typeof e.width){var h=e.width;"function"==typeof h&&(h=h()),C.rootElement[0].style.width=h+"px"}l&&(C.rootElement[0].style.overflow="auto"),t||o.hooks.run(C,"afterUpdateSettings"),w.adjustRowsAndCols(),C.view&&!m.firstRun&&(C.forceFullRender=!0,y.refreshBorders(null,!0))},this.getValue=function(){var e=C.getSelected();if(b.prototype.getValue){if("function"==typeof b.prototype.getValue)return b.prototype.getValue.call(C);if(e)return C.getData()[e[0]][b.prototype.getValue]}else if(e)return C.getDataAtCell(e[0],e[1])},this.getSettings=function(){return m.settings},this.clear=function(){y.selectAll(),y.empty()},this.alter=function(e,t,o,n,i){w.alter(e,t,o,n,i)},this.getCell=function(e,t){return C.view.getCellAtCoords(new f(e,t))},this.colToProp=function(e){return g.colToProp(e)},this.propToCol=function(e){return g.propToCol(e)},this.getDataAtCell=function(e,t){return g.get(e,g.colToProp(t))},this.getDataAtRowProp=function(e,t){return g.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,g.getRange(new f(0,e),new f(m.settings.data.length-1,e),g.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t=[];return t.concat.apply(t,g.getRange(new f(0,g.propToCol(e)),new f(m.settings.data.length-1,g.propToCol(e)),g.DESTINATION_RENDERER))},this.getSourceDataAtCol=function(e){for(var t=[],o=m.settings.data,n=0;n<o.length;n++)t.push(o[n][e]);return t},this.getSourceDataAtRow=function(e){return m.settings.data[e]},this.getDataAtRow=function(e){var t=g.getRange(new f(e,0),new f(e,this.countCols()-1),g.DESTINATION_RENDERER);return t[0]},this.removeCellMeta=function(e,t,o){var n=C.getCellMeta(e,t);void 0!=n[o]&&delete m.cellSettings[e][t][o]},this.setCellMetaObject=function(e,t,o){if("object"==typeof o)for(var n in o){var i=n,r=o[n];this.setCellMeta(e,t,i,r)}},this.setCellMeta=function(e,t,n,i){m.cellSettings[e]||(m.cellSettings[e]=[]),m.cellSettings[e][t]||(m.cellSettings[e][t]=new m.columnSettings[t]),m.cellSettings[e][t][n]=i,o.hooks.run(C,"afterSetCellMeta",e,t,n,i)},this.getCellMeta=function(e,t){var n,i=g.colToProp(t);if(e=h(e),t=u(t),m.columnSettings[t]||(m.columnSettings[t]=o.helper.columnFactory(b,m.columnsSettingConflicts)),m.cellSettings[e]||(m.cellSettings[e]=[]),m.cellSettings[e][t]||(m.cellSettings[e][t]=new m.columnSettings[t]),n=m.cellSettings[e][t],n.row=e,n.col=t,n.prop=i,n.instance=C,o.hooks.run(C,"beforeGetCellMeta",e,t,n),o.helper.extend(n,c(n)),n.cells){var r=n.cells.call(n,e,t,i);r&&(o.helper.extend(n,r),o.helper.extend(n,c(r)))}return o.hooks.run(C,"afterGetCellMeta",e,t,n),n};var T=o.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,t){var n=T.call(this,e,t);return o.renderers.getRenderer(n)},this.getCellEditor=o.helper.cellMethodLookupFactory("editor"),this.getCellValidator=o.helper.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new r;t.onQueueEmpty=e;for(var o=C.countRows()-1;o>=0;){for(var n=C.countCols()-1;n>=0;)t.addValidatorToQueue(),C.validateCell(C.getDataAtCell(o,n),C.getCellMeta(o,n),function(){t.removeValidatorFormQueue()},"validateCells"),n--;o--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0===e){for(var t=[],o=0,n=C.countRows();n>o;o++)t.push(C.getRowHeader(o));return t}return"[object Array]"===Object.prototype.toString.call(m.settings.rowHeaders)&&void 0!==m.settings.rowHeaders[e]?m.settings.rowHeaders[e]:"function"==typeof m.settings.rowHeaders?m.settings.rowHeaders(e):m.settings.rowHeaders&&"string"!=typeof m.settings.rowHeaders&&"number"!=typeof m.settings.rowHeaders?e+1:m.settings.rowHeaders},this.hasRowHeaders=function(){return!!m.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==m.settings.colHeaders&&null!==m.settings.colHeaders)return!!m.settings.colHeaders;for(var e=0,t=C.countCols();t>e;e++)if(C.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var t=[],n=0,i=C.countCols();i>n;n++)t.push(C.getColHeader(n));return t}var r=e;return e=o.hooks.execute(C,"modifyCol",e),m.settings.columns&&m.settings.columns[e]&&m.settings.columns[e].title?m.settings.columns[e].title:"[object Array]"===Object.prototype.toString.call(m.settings.colHeaders)&&void 0!==m.settings.colHeaders[e]?m.settings.colHeaders[e]:"function"==typeof m.settings.colHeaders?m.settings.colHeaders(e):m.settings.colHeaders&&"string"!=typeof m.settings.colHeaders&&"number"!=typeof m.settings.colHeaders?o.helper.spreadsheetColumnLabel(r):m.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=C.getCellMeta(0,e),o=t.width;if((void 0===o||o===m.settings.width)&&(o=t.colWidths),void 0!==o&&null!==o){switch(typeof o){case"object":o=o[e];break;case"function":o=o(e)}"string"==typeof o&&(o=parseInt(o,10))}return o},this.getColWidth=function(e){var t=C._getColWidthFromSettings(e);return t||(t=50),t=o.hooks.execute(C,"modifyColWidth",t,e)},this._getRowHeightFromSettings=function(e){var t=m.settings.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=C._getRowHeightFromSettings(e),n=C.checkIfRowIsOversized(e);return t=o.hooks.execute(C,"modifyRowHeight",t,e),n&&(t=t?Math.max(t,n):n),t},this.checkIfRowIsOversized=function(e){return C.view.wt.wtTable.oversizedRows?C.view.wt.wtTable.oversizedRows[e]:void 0},this.countRows=function(){return m.settings.data.length},this.countCols=function(){return"object"===C.dataType||"function"===C.dataType?m.settings.columns&&m.settings.columns.length?m.settings.columns.length:g.colToPropCache.length:"array"===C.dataType?m.settings.columns&&m.settings.columns.length?m.settings.columns.length:m.settings.data&&m.settings.data[0]&&m.settings.data[0].length?m.settings.data[0].length:0:void 0},this.rowOffset=function(){return C.view.wt.getSetting("offsetRow")},this.colOffset=function(){return 0},this.countVisibleRows=function(){return C.view.wt.drawn?C.view.wt.wtTable.rowStrategy.countVisible():-1},this.countVisibleCols=function(){return C.view.wt.drawn?C.view.wt.wtTable.columnStrategy.countVisible():-1},this.countEmptyRows=function(e){for(var t,n=C.countRows()-1,i=0;n>=0;){if(t=o.hooks.execute(this,"modifyRow",n),C.isEmptyRow(t))i++;else if(e)break;n--}return i},this.countEmptyCols=function(e){if(C.countRows()<1)return 0;for(var t=C.countCols()-1,o=0;t>=0;){if(C.isEmptyCol(t))o++;else if(e)break;t--}return o},this.isEmptyRow=function(e){return m.settings.isEmptyRow.call(C,e)},this.isEmptyCol=function(e){return m.settings.isEmptyCol.call(C,e)},this.selectCell=function(e,t,o,n,i){if("number"!=typeof e||0>e||e>=C.countRows())return!1;if("number"!=typeof t||0>t||t>=C.countCols())return!1;if("undefined"!=typeof o){if("number"!=typeof o||0>o||o>=C.countRows())return!1;if("number"!=typeof n||0>n||n>=C.countCols())return!1}var r=new f(e,t);return m.selRange=new p(r,r,r),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),C.listen(),"undefined"==typeof o?y.setRangeEnd(m.selRange.from,i):y.setRangeEnd(new f(o,n),i),C.selection.finish(),!0},this.selectCellByProp=function(){return arguments[1]=g.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=g.propToCol(arguments[3])),C.selectCell.apply(C,arguments)},this.deselectCell=function(){y.deselect()},this.destroy=function(){C._clearTimeouts(),C.view&&C.view.wt.destroy(),C.rootElement.empty(),C.rootElement.removeData("handsontable"),C.rootElement.off(".handsontable"),e(t).off("."+C.guid),S.off("."+C.guid),R.off("."+C.guid),o.hooks.run(C,"afterDestroy"),o.hooks.destroy(C);for(var n in C)C.hasOwnProperty(n)&&("function"==typeof C[n]?"runHooks"!==n&&"runHooksAndReturn"!==n&&(C[n]=d):"guid"!==n&&(C[n]=null));m=null,g=null,w=null,y=null,v=null,C=null,b=null,S=null,R=null},this.getActiveEditor=function(){return v.getActiveEditor()},this.getInstance=function(){return C},this.addHook=function(e,t){o.hooks.add(e,t,C)},this.addHookOnce=function(e,t){o.hooks.once(e,t,C)},this.removeHook=function(e,t){o.hooks.remove(e,t,C)},this.runHooks=function(e,t,n,i,r,s,a){o.hooks.run(C,e,t,n,i,r,s,a)},this.runHooksAndReturn=function(e,t,n,i,r,s,a){return o.hooks.execute(C,e,t,n,i,r,s,a)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;t>e;e++)clearTimeout(this.timeouts[e])},this.version="0.11.1"};var I=function(){};if(I.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){for(var t,o=0,n=this.countCols();n>o;o++)if(t=this.getDataAtCell(e,o),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},isEmptyCol:function(e){for(var t,o=0,n=this.countRows();n>o;o++)if(t=this.getDataAtCell(o,e),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,type:"text",copyable:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0},o.DefaultSettings=I,e.fn.handsontable=function(e){var t,n,i,r,s,a=this.first(),l=a.data("handsontable");if("string"!=typeof e)return s=e||{},l?l.updateSettings(s):(l=new o.Core(a,s),a.data("handsontable",l),l.init()),a;if(i=[],arguments.length>1)for(t=1,n=arguments.length;n>t;t++)i.push(arguments[t]);if(l){if("undefined"==typeof l[e])throw new Error("Handsontable do not provide action: "+e);r=l[e].apply(l,i)}return r},function(e){function t(){function e(e){return null!==e&&!o(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function o(e){return e!==e}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(o){return e(o)?n.arrayMap[o]:t(o)?n.weakMap.get(o):void 0},set:function(o,i){if(e(o))n.arrayMap[o]=i;else{if(!t(o))throw new Error("Invalid key type");n.weakMap.set(o,i)}},"delete":function(o){e(o)?delete n.arrayMap[o]:t(o)&&n.weakMap["delete"](o)}}}e.MultiMap||(e.MultiMap=t)}(t),!t.Handsontable)var o={};o.Dom={},o.Dom.closest=function(e,t,o){for(;null!=e&&e!==o;){if(1===e.nodeType&&t.indexOf(e.nodeName)>-1)return e;e=e.parentNode}return null},o.Dom.isChildOf=function(e,t){for(var o=e.parentNode;null!=o;){if(o==t)return!0;o=o.parentNode}return!1},o.Dom.index=function(e){for(var t=0;e=e.previousSibling;)++t;return t},document.documentElement.classList?(o.Dom.hasClass=function(e,t){return e.classList.contains(t)},o.Dom.addClass=function(e,t){e.classList.add(t)},o.Dom.removeClass=function(e,t){e.classList.remove(t)}):(o.Dom.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},o.Dom.addClass=function(e,t){""==e.className?e.className=t:this.hasClass(e,t)||(e.className+=" "+t)},o.Dom.removeClass=function(e,t){if(this.hasClass(e,t)){var o=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(o," ").trim()}}),o.Dom.removeTextNodes=function(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var o=e.childNodes,n=o.length-1;n>=0;n--)this.removeTextNodes(o[n],e)},o.Dom.empty=function(e){for(var t;t=e.lastChild;)e.removeChild(t)},o.Dom.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,o.Dom.fastInnerHTML=function(e,t){this.HTML_CHARACTERS.test(t)?e.innerHTML=t:this.fastInnerText(e,t)},o.Dom.fastInnerText=document.createTextNode("test").textContent?function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=t:(this.empty(e),e.appendChild(document.createTextNode(t)))}:function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.data=t:(this.empty(e),e.appendChild(document.createTextNode(t)))},o.Dom.isVisible=function(e){for(var t=e;t!==document.documentElement;){if(null===t)return!1;if(11===t.nodeType){if(t.host){if(t.host.impl)return o.Dom.isVisible(t.host.impl);if(t.host)return o.Dom.isVisible(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===t.style.display)return!1;t=t.parentNode}return!0},o.Dom.offset=function(e){if(this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName){var o=e.getBoundingClientRect();return{top:o.top+(t.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:o.left+(t.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}for(var n=e.offsetLeft,i=e.offsetTop,r=e;(e=e.offsetParent)&&e!==document.body;)n+=e.offsetLeft,i+=e.offsetTop,r=e;return r&&"fixed"===r.style.position&&(n+=t.pageXOffset||document.documentElement.scrollLeft,i+=t.pageYOffset||document.documentElement.scrollTop),{left:n,top:i}},o.Dom.getWindowScrollTop=function(){var e=t.scrollY;return void 0==e&&(e=document.documentElement.scrollTop),e},o.Dom.getWindowScrollLeft=function(){var e=t.scrollX;return void 0==e&&(e=document.documentElement.scrollLeft),e},o.Dom.getScrollTop=function(e){return e===t?o.Dom.getWindowScrollTop(e):e.scrollTop},o.Dom.getScrollLeft=function(e){return e===t?o.Dom.getWindowScrollLeft(e):e.scrollLeft},o.Dom.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)},o.Dom.outerWidth=function(e){return e.offsetWidth},o.Dom.outerHeight=function(e){return this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight},o.Dom.innerHeight=function(e){return e.clientHeight},o.Dom.innerWidth=function(e){return e.innerWidth},function(){function e(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var o=document.createElement("CAPTION");o.innerHTML="c<br>c<br>c<br>c",o.style.padding=0,o.style.margin=0,e.insertBefore(o,t),document.body.appendChild(e),n=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function t(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var o=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return o==n&&(n=t.clientWidth),(document.body||document.documentElement).removeChild(t),o-n}var n;o.Dom.hasCaptionProblem=function(){return void 0===n&&e(),n},o.Dom.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange(),n=o.duplicate();return o.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",o),n.text.length}return 0},o.Dom.getSelectionEndPosition=function(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange();return o.text.indexOf(t.text)+t.text.length}},o.Dom.setCaretPosition=function(e,t,o){if(void 0===o&&(o=t),e.setSelectionRange)e.focus(),e.setSelectionRange(t,o);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",o),n.moveStart("character",t),n.select()}};var i;o.Dom.getScrollbarWidth=function(){return void 0===i&&(i=t()),i}}(),o.TableView=function(n){var i=this,r=e(document.documentElement);this.instance=n,this.settings=n.getSettings(),n.rootElement.data("originalStyle",n.rootElement[0].getAttribute("style")),n.rootElement.addClass("handsontable");var s=document.createElement("TABLE");s.className="htCore",this.THEAD=document.createElement("THEAD"),s.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),s.appendChild(this.TBODY),n.$table=e(s),n.container.prepend(n.$table),n.rootElement.on("mousedown.handsontable",function(e){i.isTextSelectionAllowed(e.target)||(l(),e.preventDefault(),t.focus())}),r.on("keyup."+n.guid,function(e){n.selection.isInProgress()&&!e.shiftKey&&n.selection.finish()});var a;this.isMouseDown=function(){return a},r.on("mouseup."+n.guid,function(e){n.selection.isInProgress()&&1===e.which&&n.selection.finish(),a=!1,o.helper.isOutsideInput(document.activeElement)&&n.unlisten()}),r.on("mousedown."+n.guid,function(e){var t=e.target;if(!t.shadowRoot){if(t!==i.wt.wtTable.spreader)for(;t!==document.documentElement;){if(null===t)return;if(t===n.rootElement[0])return;t=t.parentNode}i.settings.outsideClickDeselects?n.deselectCell():n.destroyEditor()}}),n.$table.on("selectstart",function(e){i.settings.fragmentSelection||e.preventDefault()});var l=function(){t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():document.selection&&document.selection.empty()},c={debug:function(){return i.settings.debug},table:s,stretchH:this.settings.stretchH,data:n.getDataAtCell,totalRows:n.countRows,totalColumns:n.countCols,offsetRow:0,fixedColumnsLeft:function(){return i.settings.fixedColumnsLeft},fixedRowsTop:function(){return i.settings.fixedRowsTop},renderAllRows:i.settings.renderAllRows,rowHeaders:function(){return n.hasRowHeaders()?[function(e,t){i.appendRowHeader(e,t)}]:[]},columnHeaders:function(){return n.hasColHeaders()?[function(e,t){i.appendColHeader(e,t)}]:[]},columnWidth:n.getColWidth,rowHeight:n.getRowHeight,cellRenderer:function(e,t,n){var r=i.instance.colToProp(t),s=i.instance.getCellMeta(e,t),a=i.instance.getCellRenderer(s),l=i.instance.getDataAtRowProp(e,r);a(i.instance,n,e,t,r,l,s),o.hooks.run(i.instance,"afterRenderer",n,e,t,r,l,s)},selections:[{className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&!n.selection.isMultiple()}}},{className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&n.selection.isMultiple()}}},{className:"highlight",highlightRowClassName:i.settings.currentRowClassName,highlightColumnClassName:i.settings.currentColClassName},{className:"fill",border:{width:1,color:"red"}}],hideBorderOnMouseDownOver:function(){return i.settings.fragmentSelection},onCellMouseDown:function(e,t,r,s){n.listen(),i.activeWt=s,a=!0,2===e.button&&n.selection.inInSelection(t)||(e.shiftKey?t.row>=0&&t.col>=0&&n.selection.setRangeEnd(t):t.row<0||t.col<0?(t.row<0&&n.selectCell(0,t.col,n.countRows()-1,t.col),t.col<0&&n.selectCell(t.row,0,t.row,n.countCols()-1)):n.selection.setRangeStart(t)),o.hooks.run(n,"afterOnCellMouseDown",e,t,r),i.activeWt=i.wt},onCellMouseOver:function(e,t,r,s){i.activeWt=s,t.row>=0&&t.col>=0&&a&&n.selection.setRangeEnd(t),o.hooks.run(n,"afterOnCellMouseOver",e,t,r),i.activeWt=i.wt},onCellCornerMouseDown:function(e){e.preventDefault(),o.hooks.run(n,"afterOnCellCornerMouseDown",e)},beforeDraw:function(e){i.beforeRender(e)},onDraw:function(e){i.onDraw(e)},onScrollVertically:function(){n.runHooks("afterScrollVertically")},onScrollHorizontally:function(){n.runHooks("afterScrollHorizontally")}};o.hooks.run(n,"beforeInitWalkontable",c),this.wt=new y(c),this.activeWt=this.wt,e(i.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(e){e.target===i.wt.wtTable.spreader&&3===e.which&&e.stopPropagation()}),r.on("click."+n.guid,function(){i.settings.observeDOMVisibility&&i.wt.drawInterrupted&&(i.instance.forceFullRender=!0,i.render())})},o.TableView.prototype.isTextSelectionAllowed=function(e){return o.helper.isInput(e)?!0:this.settings.fragmentSelection&&o.Dom.isChildOf(e,this.TBODY)?!0:!1},o.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},o.TableView.prototype.beforeRender=function(e){e&&o.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},o.TableView.prototype.onDraw=function(e){e&&o.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},o.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.rootElement.triggerHandler("render.handsontable")},o.TableView.prototype.getCellAtCoords=function(e){var t=this.wt.wtTable.getCell(e);return 0>t?null:t},o.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},o.TableView.prototype.appendRowHeader=function(e,t){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="rowHeader",e>-1?o.Dom.fastInnerHTML(i,this.instance.getRowHeader(e)):o.Dom.fastInnerText(i,""),n.appendChild(i),o.Dom.empty(t),t.appendChild(n),o.hooks.run(this.instance,"afterGetRowHeader",e,t)},o.TableView.prototype.appendColHeader=function(e,t){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="colHeader",o.Dom.fastInnerHTML(i,this.instance.getColHeader(e)),n.appendChild(i),o.Dom.empty(t),t.appendChild(n),o.hooks.run(this.instance,"afterGetColHeader",e,t)},o.TableView.prototype.maximumVisibleElementWidth=function(e){this.wt.wtScrollbars.horizontal.readWindowSize();var t=this.wt.wtViewport.getWorkspaceWidth(),o=t-e;return o>0?o:0},o.TableView.prototype.maximumVisibleElementHeight=function(e){this.wt.wtScrollbars.vertical.readWindowSize();var t=this.wt.wtViewport.getWorkspaceHeight(),o=t-e;return o>0?o:0},o.TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},function(e){function t(e){var t,o;o={},t=e,this.getInstance=function(e){return e.guid in o||(o[e.guid]=new t(e)),o[e.guid]}}var o={},n=new WeakMap;e.editors={registerEditor:function(e,i){var r=new t(i);"string"==typeof e&&(o[e]=r),n.set(i,r)},getEditor:function(e,t){var i;if("function"==typeof e)n.get(e)||this.registerEditor(null,e),i=n.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');i=o[e]}if(!i)throw Error('No editor registered under name "'+e+'"');return i.getInstance(t)}}}(o),function(t){t.EditorManager=function(o,n,i){var r,s=this,a=e(document),l=t.helper.keyCode,c=!1,h=function(){function e(e){if(o.isListening()&&(n.settings.beforeOnKeyDown&&n.settings.beforeOnKeyDown.call(o,e),t.hooks.run(o,"beforeKeyDown",e),!c&&!e.isImmediatePropagationStopped()&&(n.lastKeyCode=e.keyCode,i.isSelected()))){var a=(e.ctrlKey||e.metaKey)&&!e.altKey;if(!(r.isWaiting()||t.helper.isMetaKey(e.keyCode)||a||s.isEditorOpened())){var h=e.keyCode,w=String.fromCharCode(h),y=h>=65&&90>=h?!0:!1,v=h>=97&&122>=h?!0:!1;return(y&&!e.shiftKey||v&&e.shiftKey)&&(w=w.toLowerCase()),s.openEditor(w),e.preventDefault(),void e.stopPropagation()}var C=e.shiftKey?i.setRangeEnd:i.setRangeStart;switch(e.keyCode){case l.A:if(a){i.selectAll(),e.preventDefault(),e.stopPropagation();break}case l.ARROW_UP:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),d(e.shiftKey),e.preventDefault(),e.stopPropagation();break;case l.ARROW_DOWN:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),p(e.shiftKey),e.preventDefault(),e.stopPropagation();break;case l.ARROW_RIGHT:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),m(e.shiftKey),e.preventDefault(),e.stopPropagation();break;case l.ARROW_LEFT:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),g(e.shiftKey),e.preventDefault(),e.stopPropagation();break;case l.TAB:var b="function"==typeof n.settings.tabMoves?n.settings.tabMoves(e):n.settings.tabMoves;e.shiftKey?i.transformStart(-b.row,-b.col):i.transformStart(b.row,b.col,!0),e.preventDefault(),e.stopPropagation();break;case l.BACKSPACE:case l.DELETE:i.empty(e),s.prepareEditor(),e.preventDefault();break;case l.F2:s.openEditor(),e.preventDefault();break;case l.ENTER:s.isEditorOpened()?(r.state!==t.EditorState.WAITING&&s.closeEditorAndSaveChanges(a),u(e.shiftKey)):o.getSettings().enterBeginsEditing?s.openEditor():u(e.shiftKey),e.preventDefault(),e.stopImmediatePropagation();break;case l.ESCAPE:s.isEditorOpened()&&s.closeEditorAndRestoreOriginalValue(a),e.preventDefault();break;case l.HOME:C(e.ctrlKey||e.metaKey?new f(0,n.selRange.from.col):new f(n.selRange.from.row,0)),e.preventDefault(),e.stopPropagation();break;case l.END:C(e.ctrlKey||e.metaKey?new f(o.countRows()-1,n.selRange.from.col):new f(n.selRange.from.row,o.countCols()-1)),e.preventDefault(),e.stopPropagation();break;case l.PAGE_UP:i.transformStart(-o.countVisibleRows(),0),o.view.wt.scrollVertical(-o.countVisibleRows()),o.view.render(),e.preventDefault(),e.stopPropagation();break;case l.PAGE_DOWN:i.transformStart(o.countVisibleRows(),0),o.view.wt.scrollVertical(o.countVisibleRows()),o.view.render(),e.preventDefault(),e.stopPropagation()}}}function h(e,t,o){"TD"==o.nodeName&&s.openEditor()}function u(e){var t="function"==typeof n.settings.enterMoves?n.settings.enterMoves(event):n.settings.enterMoves;e?i.transformStart(-t.row,-t.col):i.transformStart(t.row,t.col,!0)}function d(e){e?i.transformEnd(-1,0):i.transformStart(-1,0)}function p(e){e?i.transformEnd(1,0):i.transformStart(1,0)}function m(e){e?i.transformEnd(0,1):i.transformStart(0,1)}function g(e){e?i.transformEnd(0,-1):i.transformStart(0,-1)}o.addHook("afterDocumentKeyDown",function(t){e(t)}),a.on("keydown."+o.guid,function(e){o.runHooks("afterDocumentKeyDown",e)}),o.view.wt.update("onCellDblClick",h),o.addHook("afterDestroy",function(){c=!0})};this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return r},this.prepareEditor=function(){if(r&&r.isWaiting())return void this.closeEditor(!1,!1,function(e){e&&s.prepareEditor()});var e=n.selRange.highlight.row,i=n.selRange.highlight.col,a=o.colToProp(i),l=o.getCell(e,i),c=o.getDataAtCell(e,i),h=o.getCellMeta(e,i),u=o.getCellEditor(h);r=t.editors.getEditor(u,o),r.prepare(e,i,a,l,c,h)},this.isEditorOpened=function(){return r.isOpened()},this.openEditor=function(e){r.cellProperties.readOnly||r.beginEditing(e)},this.closeEditor=function(e,t,o){r?r.finishEditing(e,t,o):o&&o(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},h()}}(o),function(e){var t={};e.renderers={registerRenderer:function(e,o){t[e]=o},getRenderer:function(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(e in t))throw Error('No editor registered under name "'+e+'"');return t[e]}}}(o),o.helper.isPrintableChar=function(e){return 32==e||e>=48&&57>=e||e>=96&&111>=e||e>=186&&192>=e||e>=219&&222>=e||e>=226||e>=65&&90>=e},o.helper.isMetaKey=function(e){var t=o.helper.keyCode,n=[t.ARROW_DOWN,t.ARROW_UP,t.ARROW_LEFT,t.ARROW_RIGHT,t.HOME,t.END,t.DELETE,t.BACKSPACE,t.F1,t.F2,t.F3,t.F4,t.F5,t.F6,t.F7,t.F8,t.F9,t.F10,t.F11,t.F12,t.TAB,t.PAGE_DOWN,t.PAGE_UP,t.ENTER,t.ESCAPE,t.SHIFT,t.CAPS_LOCK,t.ALT];return-1!=n.indexOf(e)},o.helper.isCtrlKey=function(e){var t=o.helper.keyCode;return-1!=[t.CONTROL_LEFT,224,t.COMMAND_LEFT,t.COMMAND_RIGHT].indexOf(e)},o.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}},o.helper.spreadsheetColumnLabel=function(e){for(var t,o=e+1,n="";o>0;)t=(o-1)%26,n=String.fromCharCode(65+t)+n,o=parseInt((o-t)/26,10);return n},o.helper.isNumeric=function(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?e.length?1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):!1:"object"==t?!(!e||"number"!=typeof e.valueOf()||e instanceof Date):!1},o.helper.isDescendant=function(e,t){for(var o=t.parentNode;null!=o;){if(o==e)return!0;o=o.parentNode}return!1},o.helper.randomString=function(){return b()},o.helper.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e},o.helper.extend=function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},o.helper.getPrototypeOf=function(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var o,n=e.constructor;"function"==typeof e.constructor&&(o=n,delete e.constructor&&(n=e.constructor,e.constructor=o)),t=n?n.prototype:null}return t},o.helper.columnFactory=function(e,t){function n(){}o.helper.inherit(n,e);for(var i=0,r=t.length;r>i;i++)n.prototype[t[i]]=void 0;return n},o.helper.translateRowsToColumns=function(e){var t,o,n,i,r=[],s=0;for(t=0,o=e.length;o>t;t++)for(n=0,i=e[t].length;i>n;n++)n==s&&(r.push([]),s++),r[n].push(e[t][n]);return r},o.helper.to2dArray=function(e){for(var t=0,o=e.length;o>t;)e[t]=[e[t]],t++},o.helper.extendArray=function(e,t){for(var o=0,n=t.length;n>o;)e.push(t[o]),o++},o.helper.isInput=function(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1},o.helper.isOutsideInput=function(e){return o.helper.isInput(e)&&-1==e.className.indexOf("handsontableInput")},o.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},o.helper.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)
},o.helper.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"==Object.prototype.toString.call(e)},o.helper.pivot=function(e){var t=[];if(!e||0==e.length||!e[0]||0==e[0].length)return t;for(var o=e.length,n=e[0].length,i=0;o>i;i++)for(var r=0;n>r;r++)t[r]||(t[r]=[]),t[r][i]=e[i][r];return t},o.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}},o.helper.cellMethodLookupFactory=function(e,t){function n(e){var t=o.cellTypes[e];if("undefined"==typeof t)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return t}return t="undefined"==typeof t?!0:t,function(i,r){return function s(i){if(i){if(i.hasOwnProperty(e)&&void 0!==i[e])return i[e];if(i.hasOwnProperty("type")&&i.type){var r;if("string"!=typeof i.type)throw new Error("Cell type must be a string ");if(r=n(i.type),r.hasOwnProperty(e))return r[e];if(t)return}return s(o.helper.getPrototypeOf(i))}}("number"==typeof i?this.getCellMeta(i,r):i)}},o.helper.toString=function(e){return""+e},function(t){t.DataMap=function(e,t,o){this.instance=e,this.priv=t,this.GridSettings=o,this.dataSource=this.instance.getSettings().data,this.duckSchema=this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{},this.createMap()},t.DataMap.prototype.DESTINATION_RENDERER=1,t.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,t.DataMap.prototype.recursiveDuckSchema=function(t){var o;if(e.isPlainObject(t)){o={};for(var n in t)t.hasOwnProperty(n)&&(o[n]=e.isPlainObject(t[n])?this.recursiveDuckSchema(t[n]):null)}else o=[];return o},t.DataMap.prototype.recursiveDuckColumns=function(t,o,n){var i,r;if("undefined"==typeof o&&(o=0,n=""),e.isPlainObject(t))for(r in t)t.hasOwnProperty(r)&&(null===t[r]?(i=n+r,this.colToPropCache.push(i),this.propToColCache.set(i,o),o++):o=this.recursiveDuckColumns(t[r],o,r+"."));return o},t.DataMap.prototype.createMap=function(){if("undefined"==typeof this.getSchema())throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");var e,t,o=this.getSchema();this.colToPropCache=[],this.propToColCache=new MultiMap;var n=this.instance.getSettings().columns;if(n)for(e=0,t=n.length;t>e;e++)"undefined"!=typeof n[e].data&&(this.colToPropCache[e]=n[e].data,this.propToColCache.set(n[e].data,e));else this.recursiveDuckColumns(o)},t.DataMap.prototype.colToProp=function(e){return e=t.hooks.execute(this.instance,"modifyCol",e),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[e]?this.colToPropCache[e]:e},t.DataMap.prototype.propToCol=function(e){var o;return o="undefined"!=typeof this.propToColCache.get(e)?this.propToColCache.get(e):e,o=t.hooks.execute(this.instance,"modifyCol",o)},t.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},t.DataMap.prototype.createRow=function(o,n,i){var r,s,a=this.instance.countCols(),l=0;n||(n=1),("number"!=typeof o||o>=this.instance.countRows())&&(o=this.instance.countRows()),s=o;for(var c=this.instance.getSettings().maxRows;n>l&&this.instance.countRows()<c;){if("array"===this.instance.dataType){r=[];for(var h=0;a>h;h++)r.push(null)}else r="function"===this.instance.dataType?this.instance.getSettings().dataSchema(o):e.extend(!0,{},this.getSchema());o===this.instance.countRows()?this.dataSource.push(r):this.dataSource.splice(o,0,r),l++,s++}return t.hooks.run(this.instance,"afterCreateRow",o,l,i),this.instance.forceFullRender=!0,l},t.DataMap.prototype.createCol=function(e,o,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i,r,s=this.instance.countRows(),a=this.dataSource,l=0;o||(o=1),r=e;for(var c=this.instance.getSettings().maxCols;o>l&&this.instance.countCols()<c;){if(i=t.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof e||e>=this.instance.countCols()){for(var h=0;s>h;h++)"undefined"==typeof a[h]&&(a[h]=[]),a[h].push(null);this.priv.columnSettings.push(i)}else{for(var h=0;s>h;h++)a[h].splice(r,0,null);this.priv.columnSettings.splice(r,0,i)}l++,r++}return t.hooks.run(this.instance,"afterCreateCol",e,l,n),this.instance.forceFullRender=!0,l},t.DataMap.prototype.removeRow=function(e,o){o||(o=1),"number"!=typeof e&&(e=-o),e=(this.instance.countRows()+e)%this.instance.countRows();var n=this.physicalRowsToLogical(e,o),i=t.hooks.execute(this.instance,"beforeRemoveRow",e,o);if(i!==!1){var r=this.dataSource,s=r.filter(function(e,t){return-1==n.indexOf(t)});r.length=0,Array.prototype.push.apply(r,s),t.hooks.run(this.instance,"afterRemoveRow",e,o),this.instance.forceFullRender=!0}},t.DataMap.prototype.removeCol=function(e,o){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");o||(o=1),"number"!=typeof e&&(e=-o),e=(this.instance.countCols()+e)%this.instance.countCols();var n=t.hooks.execute(this.instance,"beforeRemoveCol",e,o);if(n!==!1){for(var i=this.dataSource,r=0,s=this.instance.countRows();s>r;r++)i[r].splice(e,o);this.priv.columnSettings.splice(e,o),t.hooks.run(this.instance,"afterRemoveCol",e,o),this.instance.forceFullRender=!0}},t.DataMap.prototype.spliceCol=function(e,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(e),s=r.slice(o,o+n),a=r.slice(o+n);t.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return t.helper.to2dArray(i),this.instance.populateFromArray(o,e,i,null,null,"spliceCol"),s},t.DataMap.prototype.spliceRow=function(e,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getSourceDataAtRow(e),s=r.slice(o,o+n),a=r.slice(o+n);t.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return this.instance.populateFromArray(e,o,[i],null,null,"spliceRow"),s},t.DataMap.prototype.get=function(e,o){if(e=t.hooks.execute(this.instance,"modifyRow",e),"string"==typeof o&&o.indexOf(".")>-1){var n=o.split("."),i=this.dataSource[e];if(!i)return null;for(var r=0,s=n.length;s>r;r++)if(i=i[n[r]],"undefined"==typeof i)return null;return i}return"function"==typeof o?o(this.dataSource.slice(e,e+1)[0]):this.dataSource[e]?this.dataSource[e][o]:null};var o=t.helper.cellMethodLookupFactory("copyable",!1);t.DataMap.prototype.getCopyable=function(e,t){return o.call(this.instance,e,this.propToCol(t))?this.get(e,t):""},t.DataMap.prototype.set=function(e,o,n,i){if(e=t.hooks.execute(this.instance,"modifyRow",e,i||"datamapGet"),"string"==typeof o&&o.indexOf(".")>-1){for(var r=o.split("."),s=this.dataSource[e],a=0,l=r.length-1;l>a;a++)s=s[r[a]];s[r[a]]=n}else"function"==typeof o?o(this.dataSource.slice(e,e+1)[0],n):this.dataSource[e][o]=n},t.DataMap.prototype.physicalRowsToLogical=function(e,o){for(var n,i=this.instance.countRows(),r=(i+e)%i,s=[],a=o;i>r&&a;)n=t.hooks.execute(this.instance,"modifyRow",r),s.push(n),a--,r++;return s},t.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},t.DataMap.prototype.getAll=function(){return this.dataSource},t.DataMap.prototype.getRange=function(e,t,o){var n,i,r,s,a,l=[],c=o===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(i=Math.max(e.row,t.row),s=Math.max(e.col,t.col),n=Math.min(e.row,t.row);i>=n;n++){for(a=[],r=Math.min(e.col,t.col);s>=r;r++)a.push(c.call(this,n,this.colToProp(r)));l.push(a)}return l},t.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},t.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}}(o),function(e){e.renderers.cellDecorator=function(t,o,n,i,r,s,a){a.className&&(o.className=o.className?o.className+" "+a.className:a.className),a.readOnly&&e.Dom.addClass(o,a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName&&e.Dom.addClass(o,a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&e.Dom.addClass(o,a.noWordWrapClassName),!s&&a.placeholder&&e.Dom.addClass(o,a.placeholderCellClassName)}}(o),function(e){var t=function(t,o,n,i,r,s,a){e.renderers.cellDecorator.apply(this,arguments),!s&&a.placeholder&&(s=a.placeholder);var l=e.helper.stringify(s);if(a.rendererTemplate){e.Dom.empty(o);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getSourceDataAtRow(n),o.appendChild(c)}else e.Dom.fastInnerText(o,l)};e.renderers.TextRenderer=t,e.renderers.registerRenderer("text",t)}(o),function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var o=document.createElement("DIV");o.className="htAutocompleteArrow",o.appendChild(document.createTextNode(""));var n=function(n,i,r,s,a,l,c){var h=(t.cloneNode(!0),o.cloneNode(!0));e.renderers.TextRenderer(n,i,r,s,a,l,c),i.appendChild(h),e.Dom.addClass(i,"htAutocomplete"),i.firstChild||i.appendChild(document.createTextNode("")),n.acArrowListener||(n.acArrowListener=function(){n.view.wt.getSetting("onCellDblClick",null,new f(r,s),i)},n.rootElement.on("mousedown.htAutocompleteArrow",".htAutocompleteArrow",n.acArrowListener),n.addHookOnce("afterDestroy",function(){this.rootElement.off("mousedown.htAutocompleteArrow")}))};e.AutocompleteRenderer=n,e.renderers.AutocompleteRenderer=n,e.renderers.registerRenderer("autocomplete",n)}(o),function(t){var o=document.createElement("INPUT");o.className="htCheckboxRendererInput",o.type="checkbox",o.setAttribute("autocomplete","off");var n=function(n,i,r,s,a,l,c){"undefined"==typeof c.checkedTemplate&&(c.checkedTemplate=!0),"undefined"==typeof c.uncheckedTemplate&&(c.uncheckedTemplate=!1),t.Dom.empty(i);var h=o.cloneNode(!1);l===c.checkedTemplate||l===t.helper.stringify(c.checkedTemplate)?(h.checked=!0,i.appendChild(h)):l===c.uncheckedTemplate||l===t.helper.stringify(c.uncheckedTemplate)?i.appendChild(h):null===l?(h.className+=" noValue",i.appendChild(h)):t.Dom.fastInnerText(i,"#bad value#");var u=e(h);c.readOnly?u.on("click",function(e){e.preventDefault()}):(u.on("mousedown",function(e){e.stopPropagation()}),u.on("mouseup",function(e){e.stopPropagation()}),u.on("change",function(){this.checked?n.setDataAtRowProp(r,a,c.checkedTemplate):n.setDataAtRowProp(r,a,c.uncheckedTemplate)})),n.CheckboxRenderer&&n.CheckboxRenderer.beforeKeyDownHookBound||(n.CheckboxRenderer={beforeKeyDownHookBound:!0},n.addHook("beforeKeyDown",function(o){if(o.keyCode==t.helper.keyCode.SPACE)for(var i,r,s,a=n.getSelectedRange(),l=a.getTopLeftCorner(),c=a.getBottomRightCorner(),h=l.row;h<=c.row;h++)for(var u=l.col;u<=c.col;u++)if(i=n.getCell(h,u),s=n.getCellMeta(h,u),r=i.querySelectorAll("input[type=checkbox]"),r.length>0&&!s.readOnly){o.isImmediatePropagationStopped()||(o.stopImmediatePropagation(),o.preventDefault());for(var d=0,f=r.length;f>d;d++)r[d].checked=!r[d].checked,e(r[d]).trigger("change")}}))};t.CheckboxRenderer=n,t.renderers.CheckboxRenderer=n,t.renderers.registerRenderer("checkbox",n)}(o),function(e){var t=function(t,o,n,i,r,s,a){e.helper.isNumeric(s)&&("undefined"!=typeof a.language&&numeral.language(a.language),s=numeral(s).format(a.format||"0"),e.Dom.addClass(o,"htNumeric")),e.renderers.TextRenderer(t,o,n,i,r,s,a)};e.NumericRenderer=t,e.renderers.NumericRenderer=t,e.renderers.registerRenderer("numeric",t)}(o),function(e){var t=function(e,t,n,i,r,s,a){o.renderers.TextRenderer.apply(this,arguments),s=t.innerHTML;var l,c=a.hashLength||s.length,h=a.hashSymbol||"*";for(l="";l.split(h).length-1<c;l+=h);o.Dom.fastInnerHTML(t,l)};e.PasswordRenderer=t,e.renderers.PasswordRenderer=t,e.renderers.registerRenderer("password",t)}(o),function(e){function t(t,o,n,i,r,s){e.renderers.cellDecorator.apply(this,arguments),e.Dom.fastInnerHTML(o,s)}e.renderers.registerRenderer("html",t),e.renderers.HtmlRenderer=t}(o),function(e){function t(t){this.instance=t,this.state=e.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},t.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},t.prototype.init=function(){},t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},t.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented")},t.prototype.open=function(){throw Error("Editor open() method unimplemented")},t.prototype.close=function(){throw Error("Editor close() method unimplemented")},t.prototype.prepare=function(t,o,n,i,r,s){this.TD=i,this.row=t,this.col=o,this.prop=n,this.originalValue=r,this.cellProperties=s,this.state=e.EditorState.VIRGIN},t.prototype.extend=function(){function e(){o.apply(this,arguments)}function t(e,t){function o(){}return o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e,e}var o=this.constructor;return t(e,o)},t.prototype.saveValue=function(e,t){if(t){var o=this.instance.getSelected();this.instance.populateFromArray(o[0],o[1],e,o[2],o[3],"edit")}else this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},t.prototype.beginEditing=function(t){this.state==e.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new f(this.row,this.col)),this.instance.view.render(),this.state=e.EditorState.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue(e.helper.stringify(t)),this.open(),this._opened=!0,this.focus(),this.instance.view.render())},t.prototype.finishEditing=function(t,o,n){if(n){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),n(e)}}if(!this.isWaiting()){if(this.state==e.EditorState.VIRGIN){var r=this;return void this.instance._registerTimeout(setTimeout(function(){r._fireCallbacks(!0)},0))}if(this.state==e.EditorState.EDITING){if(t)return void this.cancelChanges();var s=[[String.prototype.trim.call(this.getValue())]];if(this.state=e.EditorState.WAITING,this.saveValue(s,o),this.instance.getCellValidator(this.cellProperties)){var r=this;this.instance.addHookOnce("afterValidate",function(t){r.state=e.EditorState.FINISHED,r.discardEditor(t)})}else this.state=e.EditorState.FINISHED,this.discardEditor(!0)}}},t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED,this.discardEditor()},t.prototype.discardEditor=function(t){this.state===e.EditorState.FINISHED&&(t===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=e.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=e.EditorState.VIRGIN,this._fireCallbacks(!0)))},t.prototype.isOpened=function(){return this._opened},t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING},e.editors.BaseEditor=t}(o),function(o){var n=o.editors.BaseEditor.prototype.extend();n.prototype.init=function(){this.createElements(),this.bindEvents(),this.autoResize=L()},n.prototype.getValue=function(){return this.TEXTAREA.value},n.prototype.setValue=function(e){this.TEXTAREA.value=e};var i=function(e){var t=this,n=t.getActiveEditor(),i=o.helper.keyCode,r=(e.ctrlKey||e.metaKey)&&!e.altKey;if(e.target===n.TEXTAREA&&!e.isImmediatePropagationStopped()){if(17===e.keyCode||224===e.keyCode||91===e.keyCode||93===e.keyCode)return void e.stopImmediatePropagation();switch(e.keyCode){case i.ARROW_RIGHT:o.Dom.getCaretPosition(n.TEXTAREA)!==n.TEXTAREA.value.length&&e.stopImmediatePropagation();break;case i.ARROW_LEFT:0!==o.Dom.getCaretPosition(n.TEXTAREA)&&e.stopImmediatePropagation();break;case i.ENTER:var s=n.instance.getSelected(),a=!(s[0]===s[2]&&s[1]===s[3]);(r&&!a||e.altKey)&&(n.isOpened()?(n.setValue(n.getValue()+"\n"),n.focus()):n.beginEditing(n.originalValue+"\n"),e.stopImmediatePropagation()),e.preventDefault();break;case i.A:case i.X:case i.C:case i.V:if(r){e.stopImmediatePropagation();break}case i.BACKSPACE:case i.DELETE:case i.HOME:case i.END:e.stopImmediatePropagation()}}};n.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",i)},n.prototype.close=function(){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",i)},n.prototype.focus=function(){this.TEXTAREA.focus(),o.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},n.prototype.createElements=function(){this.$body=e(document.body),this.TEXTAREA=document.createElement("TEXTAREA"),this.$textarea=e(this.TEXTAREA),o.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),o.Dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var t=this;this.instance._registerTimeout(setTimeout(function(){t.refreshDimensions()},0))},n.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},n.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"corner":e=this.instance.view.wt.wtScrollbars.corner.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},n.prototype.refreshDimensions=function(){if(this.state===o.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){{var n=e(this.TD),i=o.Dom.offset(this.TD),r=o.Dom.offset(this.instance.rootElement[0]),s=i.top-r.top-1,a=i.left-r.left-1,l=this.instance.getSettings(),c=l.rowHeaders===!1?0:1,h=l.colHeaders===!1?0:1;this.checkEditorSection()}0>s&&(s=0),0>a&&(a=0),c>0&&parseInt(n.css("border-top-width"),10)>0&&(s+=1),h>0&&parseInt(n.css("border-left-width"),10)>0&&(a+=1),this.textareaParentStyle.top=s+"px",this.textareaParentStyle.left=a+"px";var u=this.TD.offsetTop,d=this.TD.offsetLeft-this.instance.view.wt.wtScrollbars.horizontal.getScrollPosition(),f=n.width(),p=this.instance.view.maximumVisibleElementWidth(d)-10,m=n.outerHeight()-4,g=this.instance.view.maximumVisibleElementHeight(u)-2;parseInt(n.css("border-top-width"),10)>0&&(m-=1),parseInt(n.css("border-left-width"),10)>0&&c>0&&(f-=1),this.autoResize.init(this.$textarea[0],{fontSize:parseInt(t.getComputedStyle(n[0]).fontSize,10),minHeight:Math.min(m,g),maxHeight:g,minWidth:Math.min(f,p),maxWidth:p}),this.textareaParentStyle.display="block"}},n.prototype.bindEvents=function(){var e=this;this.$textarea.on("cut.editor",function(e){e.stopPropagation()}),this.$textarea.on("paste.editor",function(e){e.stopPropagation()}),this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()})},o.editors.TextEditor=n,o.editors.registerEditor("text",o.editors.TextEditor)}(o),function(t){var o=t.editors.BaseEditor.prototype.extend();o.prototype.beginEditing=function(){var t=this.TD.querySelector('input[type="checkbox"]');t&&e(t).trigger("click")},o.prototype.finishEditing=function(){},o.prototype.init=function(){},o.prototype.open=function(){},o.prototype.close=function(){},o.prototype.getValue=function(){},o.prototype.setValue=function(){},o.prototype.focus=function(){},t.editors.CheckboxEditor=o,t.editors.registerEditor("checkbox",o)}(o),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.init=function(){if(!e.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");t.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var o=this;this.instance.addHook("afterDestroy",function(){o.destroyElements()})},o.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),t.Dom.addClass(this.datePicker,"htDatepickerHolder"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,document.body.appendChild(this.datePicker),this.$datePicker=e(this.datePicker);var o=this,n={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,onSelect:function(e){o.setValue(e),o.finishEditing(!1)}};this.$datePicker.datepicker(n),this.$datePicker.on("mousedown",function(e){e.stopPropagation()}),this.hideDatepicker()},o.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy"),this.$datePicker.remove()},o.prototype.open=function(){t.editors.TextEditor.prototype.open.call(this),this.showDatepicker()},o.prototype.finishEditing=function(){this.hideDatepicker(),t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.showDatepicker=function(){var t=e(this.TD),o=t.offset();this.datePickerStyle.top=o.top+t.height()+"px",this.datePickerStyle.left=o.left+"px";var n={defaultDate:this.originalValue||void 0};e.extend(n,this.cellProperties),this.$datePicker.datepicker("option",n),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},o.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},t.editors.DateEditor=o,t.editors.registerEditor("date",o)}(o),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments);var o=document.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.$htContainer=e(o),this.$htContainer.handsontable()},o.prototype.prepare=function(o,n,i,r,s,a){t.editors.TextEditor.prototype.prepare.apply(this,arguments);var l=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&l.setValue(e),l.instance.destroyEditor()}};this.cellProperties.handsontable&&(c=e.extend(c,a.handsontable)),this.$htContainer.handsontable("destroy"),this.$htContainer.handsontable(c)};var n=function(e){if(!e.isImmediatePropagationStopped()){var o,n=this.getActiveEditor(),i=n.$htContainer.handsontable("getInstance");if(e.keyCode==t.helper.keyCode.ARROW_DOWN)if(i.getSelected()){var r=i.getSelected()[0],s=i.countRows()-1;o=Math.min(s,r+1)}else o=0;else if(e.keyCode==t.helper.keyCode.ARROW_UP&&i.getSelected()){var r=i.getSelected()[0];o=r-1}void 0!==o&&(0>o?i.deselectCell():i.selectCell(o,0),e.preventDefault(),e.stopImmediatePropagation(),n.instance.listen(),n.TEXTAREA.focus())}};o.prototype.open=function(){this.instance.addHook("beforeKeyDown",n),t.editors.TextEditor.prototype.open.apply(this,arguments),this.$htContainer.handsontable("render"),this.cellProperties.strict?(this.$htContainer.handsontable("selectCell",0,0),this.$textarea[0].style.visibility="hidden"):(this.$htContainer.handsontable("deselectCell"),this.$textarea[0].style.visibility="visible"),t.Dom.setCaretPosition(this.$textarea[0],0,this.$textarea[0].value.length)},o.prototype.close=function(){this.instance.removeHook("beforeKeyDown",n),this.instance.listen(),t.editors.TextEditor.prototype.close.apply(this,arguments)},o.prototype.focus=function(){this.instance.listen(),t.editors.TextEditor.prototype.focus.apply(this,arguments)},o.prototype.beginEditing=function(){var e=this.instance.getSettings().onBeginEditing;e&&e()===!1||t.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},o.prototype.finishEditing=function(){if(this.$htContainer.handsontable("isListening")&&this.instance.listen(),this.$htContainer.handsontable("getSelected")){var e=this.$htContainer.handsontable("getInstance").getValue();void 0!==e&&this.setValue(e)}return t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},t.editors.HandsontableEditor=o,t.editors.registerEditor("handsontable",o)}(o),function(e){var o=e.editors.HandsontableEditor.prototype.extend();o.prototype.init=function(){e.editors.HandsontableEditor.prototype.init.apply(this,arguments),this.query=null,this.choices=[]},o.prototype.createElements=function(){e.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);var o=function(){return-1!=t.navigator.platform.indexOf("Mac")?"htMacScroll":""};this.$htContainer.addClass("autocompleteEditor"),this.$htContainer.addClass(o())},o.prototype.bindEvents=function(){var t=this;this.$textarea.on("keydown.autocompleteEditor",function(o){var n=e.helper.keyCode;o.keyCode!==n.ARROW_DOWN&&o.keyCode!==n.ARROW_UP&&t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value)},0))})},o.prototype.open=function(){e.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.$textarea[0].style.visibility="visible",this.focus();var t=this.$htContainer.handsontable("getInstance"),o=this;t.updateSettings({colWidths:[e.Dom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,t,n,i,r){var s=this.getCellMeta(t,n).filteringCaseSensitive===!0,a=s?r.indexOf(this.query):r.toLowerCase().indexOf(o.query.toLowerCase());if(-1!=a){var l=r.substr(a,o.query.length);e.innerHTML=r.replace(l,"<strong>"+l+"</strong>")}}}),this.queryChoices(this.TEXTAREA.value)},o.prototype.close=function(){e.editors.HandsontableEditor.prototype.close.apply(this,arguments)},o.prototype.queryChoices=function(t){if(this.query=t,"function"==typeof this.cellProperties.source){var o=this;this.cellProperties.source(t,function(e){o.updateChoicesList(e)})}else if(e.helper.isArray(this.cellProperties.source)){var n;if(t&&this.cellProperties.filter!==!1){var i=this.cellProperties.filteringCaseSensitive===!0,r=t.toLowerCase();n=this.cellProperties.source.filter(function(e){return i?-1!=e.indexOf(t):-1!=e.toLowerCase().indexOf(r)})}else n=this.cellProperties.source;this.updateChoicesList(n)}else this.updateChoicesList([])},o.prototype.updateChoicesList=function(t){var o=e.Dom.getCaretPosition(this.TEXTAREA),n=e.Dom.getSelectionEndPosition(this.TEXTAREA);this.choices=t,this.$htContainer.handsontable("loadData",e.helper.pivot([t])),this.$htContainer.handsontable("updateSettings",{height:this.getDropdownHeight()}),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(),this.instance.listen(),this.TEXTAREA.focus(),e.Dom.setCaretPosition(this.TEXTAREA,o,o!=n?n:void 0)},o.prototype.highlightBestMatchingChoice=function(){var e=this.findBestMatchingChoice();"undefined"==typeof e&&this.cellProperties.allowInvalid===!1&&(e=0),"undefined"==typeof e?this.$htContainer.handsontable("deselectCell"):this.$htContainer.handsontable("selectCell",e,0)},o.prototype.findBestMatchingChoice=function(){for(var e,t,o,n={},i=this.getValue().length,r=0,s=this.choices.length;s>r;r++)e=this.choices[r],t=i>0?e.indexOf(this.getValue()):e===this.getValue()?0:-1,-1!=t&&(o=e.length-t-i,("undefined"==typeof n.indexOfValue||n.indexOfValue>t||n.indexOfValue==t&&n.charsLeft>o)&&(n.indexOfValue=t,n.charsLeft=o,n.index=r));return n.index},o.prototype.getDropdownHeight=function(){var e=this.$htContainer.handsontable("getInstance").getRowHeight(0)||23;return this.choices.length>=10?10*e:this.choices.length*e+8},e.editors.AutocompleteEditor=o,e.editors.registerEditor("autocomplete",o)}(o),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.$textarea=e(this.TEXTAREA),t.Dom.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},t.editors.PasswordEditor=o,t.editors.registerEditor("password",o)}(o),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT"),e.Dom.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement[0].appendChild(this.select)},t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t,o=this.cellProperties.selectOptions;t=this.prepareOptions("function"==typeof o?o(this.row,this.col,this.prop):o),e.Dom.empty(this.select);for(var n in t)if(t.hasOwnProperty(n)){var i=document.createElement("OPTION");i.value=n,e.Dom.fastInnerHTML(i,t[n]),this.select.appendChild(i)}},t.prototype.prepareOptions=function(t){var o={};if(e.helper.isArray(t))for(var n=0,i=t.length;i>n;n++)o[t[n]]=t[n];else"object"==typeof t&&(o=t);return o},t.prototype.getValue=function(){return this.select.value},t.prototype.setValue=function(e){this.select.value=e};var o=function(t){var o=this,n=o.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var i=n.select.find("option:selected").prev();1==i.length&&i.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var r=n.select.find("option:selected").next();1==r.length&&r.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};t.prototype.open=function(){var t=e.Dom.outerWidth(this.TD),n=e.Dom.outerHeight(this.TD),i=e.Dom.offset(this.instance.rootElement[0]),r=e.Dom.offset(this.TD);this.select.style.height=n+"px",this.select.style.minWidth=t+"px",this.select.style.top=r.top-i.top+"px",this.select.style.left=r.left-i.left+"px",this.select.style.margin="0px",this.select.style.display="",this.instance.addHook("beforeKeyDown",o)},t.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",o)},t.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=t,e.editors.registerEditor("select",t)}(o),function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},e.editors.DropdownEditor=t,e.editors.registerEditor("dropdown",t)}(o),o.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*(\.|\,)?\d*$/.test(e))};var N=function(e,t){var o=e,n="string"==typeof o?o.toLowerCase():null;return function(e){for(var i=!1,r=0,s=e.length;s>r;r++){if(o===e[r]){i=!0;break}if(n===e[r].toLowerCase()){i=!0;break}}t(i)}};o.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,N(e,t)):N(e,t)(this.source):t(!0)},o.AutocompleteCell={editor:o.editors.AutocompleteEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.CheckboxCell={editor:o.editors.CheckboxEditor,renderer:o.renderers.CheckboxRenderer},o.TextCell={editor:o.editors.TextEditor,renderer:o.renderers.TextRenderer},o.NumericCell={editor:o.editors.TextEditor,renderer:o.renderers.NumericRenderer,validator:o.NumericValidator,dataType:"number"},o.DateCell={editor:o.editors.DateEditor,renderer:o.renderers.AutocompleteRenderer},o.HandsontableCell={editor:o.editors.HandsontableEditor,renderer:o.renderers.AutocompleteRenderer},o.PasswordCell={editor:o.editors.PasswordEditor,renderer:o.renderers.PasswordRenderer,copyable:!1},o.DropdownCell={editor:o.editors.DropdownEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.cellTypes={text:o.TextCell,date:o.DateCell,numeric:o.NumericCell,checkbox:o.CheckboxCell,autocomplete:o.AutocompleteCell,handsontable:o.HandsontableCell,password:o.PasswordCell,dropdown:o.DropdownCell},o.cellLookup={validator:{numeric:o.NumericValidator,autocomplete:o.AutocompleteValidator}};
var L=function(){var e,o={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,fontSize:11},n=document.body,i=document.createTextNode(""),r=document.createElement("SPAN"),s=function(e,o,n){t.attachEvent?e.attachEvent("on"+o,n):e.addEventListener(o,n,!1)},a=function(e,o,n){t.detachEvent?e.detachEvent("on"+o,n):e.removeEventListener(o,n,!1)},l=function(){void 0!==i.textContent?i.textContent=e.value:i.data=e.value,r.style.fontSize=o.fontSize+"px",n.appendChild(r);var t=r.clientWidth;n.removeChild(r),e.style.height=o.minHeight+"px",e.style.width=o.minWidth>t?o.minWidth+"px":t>o.maxWidth?o.maxWidth+"px":t+"px";var s=e.scrollHeight;o.minHeight>s?e.style.height=o.minHeight+"px":o.maxHeight<s?(e.style.height=o.maxHeight+"px",e.style.overflowY="visible"):e.style.height=s+"px"},c=function(){t.setTimeout(l,0)},h=function(t){if(t&&t.minHeight)if("inherit"==t.minHeight)o.minHeight=e.clientHeight;else{var n=parseInt(t.minHeight);isNaN(n)||(o.minHeight=n)}if(t&&t.maxHeight)if("inherit"==t.maxHeight)o.maxHeight=e.clientHeight;else{var s=parseInt(t.maxHeight);isNaN(s)||(o.maxHeight=s)}if(t&&t.minWidth)if("inherit"==t.minWidth)o.minWidth=e.clientWidth;else{var a=parseInt(t.minWidth);isNaN(a)||(o.minWidth=a)}if(t&&t.maxWidth)if("inherit"==t.maxWidth)o.maxWidth=e.clientWidth;else{var l=parseInt(t.maxWidth);isNaN(l)||(o.maxWidth=l)}if(t&&t.fontSize)if("inherit"==t.fontSize)o.fontSize=e.fontSize;else{var c=parseInt(t.fontSize);isNaN(c)||(o.fontSize=c)}r.firstChild||(r.className="autoResize",r.style.display="inline-block",r.appendChild(i))},u=function(t,n){e=t,h(n),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=o.minHeight+"px",e.style.minWidth=o.minWidth+"px",e.style.maxWidth=o.maxWidth+"px",e.style.fontSize=o.fontSize+"px",e.style.overflowY="hidden"),s(e,"change",l),s(e,"cut",c),s(e,"paste",c),s(e,"drop",c),s(e,"keydown",c),l()};return{init:function(e,t){u(e,t)},unObserve:function(){a(e,"change",l),a(e,"cut",c),a(e,"paste",c),a(e,"drop",c),a(e,"keydown",c)}}};!function(e){function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var o,n,i,r,s,a,l,c=[],h=0;for(i=e.split("\n"),i.length>1&&""===i[i.length-1]&&i.pop(),o=0,n=i.length;n>o;o+=1){for(i[o]=i[o].split("	"),r=0,s=i[o].length;s>r;r+=1)c[h]||(c[h]=[]),a&&0===r?(l=c[h].length-1,c[h][l]=c[h][l]+"\n"+i[o][0],a&&1&t(i[o][0])&&(a=!1,c[h][l]=c[h][l].substring(0,c[h][l].length-1).replace(/""/g,'"'))):r===s-1&&0===i[o][r].indexOf('"')?(c[h].push(i[o][r].substring(1).replace(/""/g,'"')),a=!0):(c[h].push(i[o][r].replace(/""/g,'"')),a=!1);a||(h+=1)}return c},stringify:function(e){var t,o,n,i,r,s="";for(t=0,o=e.length;o>t;t+=1){for(n=0,i=e[t].length;i>n;n+=1)n>0&&(s+="	"),r=e[t][n],s+="string"==typeof r?r.indexOf("\n")>-1?'"'+r.replace(/"/g,'""')+'"':r:null===r||void 0===r?"":r;o-1>t&&(s+="\n")}return s}}}(t);var W=function(){var e;return{getInstance:function(){return e?e.hasBeenDestroyed()&&e.init():e=new n,e.refCounter++,e}}}();n.prototype.init=function(){var e,t,o=this;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this.listenerElement=document.documentElement,t=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top="-10000px",e.left="-10000px",t.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",e=this.elTextarea.style,e.width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof e.opacity&&(e.opacity=0)),this.keydownListener=function(e){var t=!1;if(e.metaKey?t=!0:e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(t=!0),t){if(document.activeElement!==o.elTextarea&&(""!=o.getSelectionText()||-1!=["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;o.selectNodeText(o.elTextarea),setTimeout(function(){o.selectNodeText(o.elTextarea)},0)}!t||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){o.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){o.triggerPaste(e)},0))},this._bindEvent(this.listenerElement,"keydown",this.keydownListener)},n.prototype.selectNodeText=function(e){e.select()},n.prototype.getSelectionText=function(){var e="";return t.getSelection?e=t.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),e},n.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e},n.prototype.onCut=function(e){this.cutCallbacks.push(e)},n.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},n.prototype.removeCallback=function(e){var t,o;for(t=0,o=this.copyCallbacks.length;o>t;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,o=this.cutCallbacks.length;o>t;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,o=this.pasteCallbacks.length;o>t;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},n.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout(function(){for(var o=0,n=t.cutCallbacks.length;n>o;o++)t.cutCallbacks[o](e)},50)},n.prototype.triggerPaste=function(e,t){var o=this;o.pasteCallbacks&&setTimeout(function(){for(var n=(t||o.elTextarea.value).replace(/\n$/,""),i=0,r=o.pasteCallbacks.length;r>i;i++)o.pasteCallbacks[i](n,e)},50)},n.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),this._unbindEvent(this.listenerElement,"keydown",this.keydownListener))},n.prototype.hasBeenDestroyed=function(){return!this.refCounter},n.prototype._bindEvent=function(){return t.jQuery?function(t,o,n){e(t).on(o+".copypaste",n)}:function(e,t,o){e.addEventListener(t,o,!1)}}(),n.prototype._unbindEvent=function(){return t.jQuery?function(t,o,n){e(t).off(o+".copypaste",n)}:function(e,t,o){e.removeEventListener(t,o,!1)}}();var V;!function(e){function o(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function n(e,t){var i;for(var r in e)if(e.hasOwnProperty(r)){if(e[r]===t)return o(r)+"/";if("object"==typeof e[r]&&(i=n(e[r],t),""!=i))return o(r)+"/"+i}return""}function i(e,t){if(e===t)return"/";var o=n(e,t);if(""===o)throw new Error("Object not found in root");return"/"+o}function r(e){for(var t=0,o=y.length;o>t;t++)if(y[t].obj===e)return y[t]}function s(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].callback===t)return e.observers[o].observer}function a(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].observer===t)return void e.observers.splice(o,1)}function l(e,t){d(t),Object.observe?u(t,e):clearTimeout(t.next);var o=r(e);a(o,t)}function c(e,o){var n,a=[],l=e,c=r(e);if(c?n=s(c,o):(c=new v(e),y.push(c)),n)return n;if(Object.observe)n=function(t){u(n,e),h(n,e);for(var r=0,s=t.length;s>r;){if(("length"!==t[r].name||!S(t[r].object))&&"__Jasmine_been_here_before__"!==t[r].name){var c=t[r].type;switch(c){case"new":c="add";break;case"deleted":c="delete";break;case"updated":c="update"}w[c].call(t[r],a,i(l,t[r].object))}r++}a&&o&&o(a),n.patches=a,a=[]};else if(n={},c.value=JSON.parse(JSON.stringify(e)),o){n.callback=o,n.next=null;var f=this.intervals||[100,1e3,1e4,6e4],p=0,m=function(){d(n)},g=function(){clearTimeout(n.next),n.next=setTimeout(function(){m(),p=0,n.next=setTimeout(b,f[p++])},0)},b=function(){m(),p==f.length&&(p=f.length-1),n.next=setTimeout(b,f[p++])};"undefined"!=typeof t&&(t.addEventListener?(t.addEventListener("mousedown",g),t.addEventListener("mouseup",g),t.addEventListener("keydown",g)):(t.attachEvent("onmousedown",g),t.attachEvent("onmouseup",g),t.attachEvent("onkeydown",g))),n.next=setTimeout(b,f[p++])}return n.patches=a,n.object=e,c.observers.push(new C(o,n)),h(n,e)}function h(e,t){if(Object.observe){Object.observe(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&h(e,n)}}return e}function u(e,t){if(Object.observe){Object.unobserve(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&u(e,n)}}return e}function d(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,o=0,n=y.length;n>o;o++)if(y[o].obj===e.object){t=y[o];break}f(t.value,e.object,e.patches,"")}var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function f(e,t,n,i){for(var r=b(t),s=b(e),a=!1,l=!1,c=s.length-1;c>=0;c--){var h=s[c],u=e[h];if(t.hasOwnProperty(h)){var d=t[h];u instanceof Object?f(u,d,n,i+"/"+o(h)):u!=d&&(a=!0,n.push({op:"replace",path:i+"/"+o(h),value:d}),e[h]=d)}else n.push({op:"remove",path:i+"/"+o(h)}),delete e[h],l=!0}if(l||r.length!=s.length)for(var c=0;c<r.length;c++){var h=r[c];e.hasOwnProperty(h)||(n.push({op:"add",path:i+"/"+o(h),value:t[h]}),e[h]=JSON.parse(JSON.stringify(t[h])))}}function p(e,t){for(var o,n=!1,i=0,r=t.length;r>i;){o=t[i];for(var s=o.path.split("/"),a=e,l=1,c=s.length;;)if(S(a)){var h=parseInt(s[l],10);if(l++,l>=c){n=g[o.op].call(o,a,h,e);break}a=a[h]}else{var u=s[l];if(-1!=u.indexOf("~")&&(u=u.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=c){n=m[o.op].call(o,a,u,e);break}a=a[u]}i++}return n}var m={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"remove",path:this.from}]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},copy:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},g={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:m.move,copy:m.copy,test:m.test,_get:m._get},w={add:function(e,t){var n={op:"add",path:t+o(this.name),value:this.object[this.name]};e.push(n)},"delete":function(e,t){var n={op:"remove",path:t+o(this.name)};e.push(n)},update:function(e,t){var n={op:"replace",path:t+o(this.name),value:this.object[this.name]};e.push(n)}},y=[];e.intervals;var v=function(){function e(e){this.observers=[],this.obj=e}return e}(),C=function(){function e(e,t){this.callback=e,this.observer=t}return e}();e.unobserve=l,e.observe=c,e.generate=d;var b;b=Object.keys?Object.keys:function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t};var S;S=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=p}(V||(V={})),"undefined"!=typeof exports&&(exports.apply=V.apply,exports.observe=V.observe,exports.unobserve=V.unobserve,exports.generate=V.generate),o.PluginHookClass=function(){function e(){this.hooks=t(),this.globalBucket={},this.legacy=n}var t=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeSetRangeEnd:[],beforeChange:[],beforeChangeRender:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterSetCellMeta:[],afterGetColHeader:[],afterGetRowHeader:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],afterCellMetaReset:[],afterDocumentKeyDown:[],modifyColWidth:[],modifyRowHeight:[],modifyRow:[],modifyCol:[]}},n={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return e.prototype.getBucket=function(e){return e?(e.pluginHookBucket||(e.pluginHookBucket={}),e.pluginHookBucket):this.globalBucket},e.prototype.add=function(e,t,i){if(o.helper.isArray(t))for(var r=0,s=t.length;s>r;r++)this.add(e,t[r]);else{e in n&&(e=n[e]);var a=this.getBucket(i);"undefined"==typeof a[e]&&(a[e]=[]),t.skip=!1,-1==a[e].indexOf(t)&&a[e].push(t)}return this},e.prototype.once=function(e,t,n){if(o.helper.isArray(t))for(var i=0,r=t.length;r>i;i++)t[i].runOnce=!0,this.add(e,t[i],n);else t.runOnce=!0,this.add(e,t,n)},e.prototype.remove=function(e,t,o){var i=!1;e in n&&(e=n[e]);var r=this.getBucket(o);if("undefined"!=typeof r[e])for(var s=0,a=r[e].length;a>s;s++)if(r[e][s]==t){r[e][s].skip=!0,i=!0;break}return i},e.prototype.run=function(e,t,o,i,r,s,a,l){t in n&&(t=n[t]),this._runBucket(this.globalBucket,e,t,o,i,r,s,a,l),this._runBucket(this.getBucket(e),e,t,o,i,r,s,a,l)},e.prototype._runBucket=function(e,t,o,n,i,r,s,a,l){var c=e[o];if(c)for(var h=0,u=c.length;u>h;h++)c[h].skip||(c[h].call(t,n,i,r,s,a,l),c[h].runOnce&&this.remove(o,c[h],e===this.globalBucket?null:t))},e.prototype.destroy=function(e){var t=this.getBucket(e);for(var o in t)if(t.hasOwnProperty(o))for(var n=0,i=t[o].length;i>n;n++)this.remove(o,t[o],e)},e.prototype.execute=function(e,t,o,i,r,s,a,l){return t in n&&(t=n[t]),o=this._executeBucket(this.globalBucket,e,t,o,i,r,s,a,l),o=this._executeBucket(this.getBucket(e),e,t,o,i,r,s,a,l)},e.prototype._executeBucket=function(e,t,o,n,i,r,s,a,l){var c,h=e[o];if(h)for(var u=0,d=h.length;d>u;u++)if(!h[u].skip&&(c=h[u].call(t,n,i,r,s,a,l),void 0!==c&&(n=c),h[u].runOnce&&this.remove(o,h[u],e===this.globalBucket?null:t),c===!1))return!1;return n},e.prototype.register=function(e){this.isRegistered(e)||(this.hooks[e]=[])},e.prototype.deregister=function(e){delete this.hooks[e]},e.prototype.isRegistered=function(e){return"undefined"!=typeof this.hooks[e]},e.prototype.getRegistered=function(){return Object.keys(this.hooks)},e}(),o.hooks=new o.PluginHookClass,o.PluginHooks=o.hooks,function(e){function t(){function t(e){var t=document,o=this;o.table=t.createElement("table"),o.theadTh=t.createElement("th"),o.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(o.theadTh),o.tableStyle=o.table.style,o.tableStyle.tableLayout="auto",o.tableStyle.width="auto",o.tbody=t.createElement("tbody"),o.table.appendChild(o.tbody),o.container=t.createElement("div"),o.container.className=e.rootElement[0].className+" hidden",o.containerStyle=o.container.style,o.container.appendChild(o.table)}var n=this,i=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[],e.getSettings().autoColumnSize!==!1?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",o.determineIfChanged),e.addHook("modifyColWidth",o.modifyColWidth),e.addHook("afterDestroy",o.afterDestroy),e.determineColumnWidth=n.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",o.determineIfChanged),e.removeHook("modifyColWidth",o.modifyColWidth),e.removeHook("afterDestroy",o.afterDestroy),delete e.determineColumnWidth,n.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&o.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(o){var n=this,r=n.autoColumnSizeTmp;r.container||t.call(r,n),r.container.className=n.rootElement[0].className+" htAutoColumnSize",r.table.className=n.$table[0].className;for(var s=n.countRows(),a={},l=0,c=0;s>c;c++){var h=e.helper.stringify(n.getDataAtCell(c,o)),u=h.length;u>l&&(l=u),a[u]||(a[u]={needed:i,strings:[]}),a[u].needed&&(a[u].strings.push({value:h,row:c}),a[u].needed--)}var d=n.getSettings();d.colHeaders&&n.view.appendColHeader(o,r.theadTh),e.Dom.empty(r.tbody);for(var f in a)if(a.hasOwnProperty(f))for(var p=0,m=a[f].strings.length;m>p;p++){var g=a[f].strings[p].row,w=n.getCellMeta(g,o);w.col=o,w.row=g;var y=n.getCellRenderer(w),v=document.createElement("tr"),C=document.createElement("td");y(n,C,g,o,n.colToProp(o),a[f].strings[p].value,w),c++,v.appendChild(C),r.tbody.appendChild(v)}var b=n.rootElement[0].parentNode;b.appendChild(r.container);var S=e.Dom.outerWidth(r.table);return b.removeChild(r.container),S},this.determineColumnsWidth=function(){var e=this,t=this.getSettings();if(t.autoColumnSize||!t.colWidths)for(var o=this.countCols(),i=0;o>i;i++)e._getColWidthFromSettings(i)||(this.autoColumnWidths[i]=n.determineColumnWidth.call(e,i))},this.modifyColWidth=function(e,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e?this.autoColumnWidths[t]:e},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}}var o=new t;e.hooks.add("beforeInit",o.beforeInit),e.hooks.add("afterUpdateSettings",o.beforeInit)}(o);var B=new i;o.hooks.add("afterInit",function(){B.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){B.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyRow",B.translateRow),o.hooks.add("afterGetColHeader",B.getColHeader),o.hooks.register("beforeColumnSort"),o.hooks.register("afterColumnSort"),function(t){function o(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+t)}function n(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+t)}function i(e,t,i,r){var s=this.getCellMeta(e,t),a=r;s.className&&(a="vertical"===i?o(s.className,r):n(s.className,r)),this.setCellMeta(e,t,"className",a),this.render()}function r(e,t,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)i.call(this,e.from.row,e.from.col,t,o);else for(var n=e.from.row;n<=e.to.row;n++)for(var r=e.from.col;r<=e.to.col;r++)i.call(this,n,r,t,o)}function s(e,o){this.instance=e;var n=this;n.menus=[],n.triggerRows=[],this.enabled=!0,this.instance.addHook("afterDestroy",function(){n.destroy()}),this.defaultOptions={items:{row_above:{name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||o}},row_below:{name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]],o=t.join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||o}},hsep1:s.SEPARATOR,col_left:{name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1],o=t.join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||o}},col_right:{name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1],o=t.join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||o}},hsep2:s.SEPARATOR,remove_row:{name:"Remove row",callback:function(e,t){var o=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,o)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||o}},remove_col:{name:"Remove column",callback:function(e,t){var o=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,o)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1],o=t.join(",")==e.join(",");return e[1]<0||o}},hsep3:s.SEPARATOR,undo:{name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},redo:{name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},hsep4:s.SEPARATOR,make_read_only:{name:function(){var e="Read only",t=n.checkSelectionReadOnlyConsistency(this);return t&&(e=n.markSelected(e)),e},callback:function(){var e=n.checkSelectionReadOnlyConsistency(this),t=this;this.getSelectedRange().forAll(function(o,n){t.getCellMeta(o,n).readOnly=e?!1:!0}),this.render()}},hsep5:s.SEPARATOR,aligment:{name:"Alignment",submenu:{items:{left:{name:function(){var e="Left",t=n.checkSelectionAlignment(this,"htLeft");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},center:{name:function(){var e="Center",t=n.checkSelectionAlignment(this,"htCenter");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},right:{name:function(){var e="Right",t=n.checkSelectionAlignment(this,"htRight");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},justify:{name:function(){var e="Justify",t=n.checkSelectionAlignment(this,"htJustify");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},hsep1:s.SEPARATOR,top:{name:function(){var e="Top",t=n.checkSelectionAlignment(this,"htTop");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},middle:{name:function(){var e="Middle",t=n.checkSelectionAlignment(this,"htMiddle");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:!1},bottom:{name:function(){var e="Bottom",t=n.checkSelectionAlignment(this,"htBottom");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}}}}}},n.options={},t.helper.extend(n.options,this.defaultOptions),this.updateOptions(o,this.options),this.bindMouseEvents(),this.markSelected=function(e){return"<span class='selected'></span>"+e},this.checkSelectionAlignment=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,i){var r=e.getCellMeta(n,i).className;return r&&-1!=r.indexOf(t)?(o=!0,!1):void 0}),o},this.checkSelectionReadOnlyConsistency=function(e){var t=!1;return e.getSelectedRange().forAll(function(o,n){return e.getCellMeta(o,n).readOnly?(t=!0,!1):void 0}),t},t.hooks.run(e,"afterContextMenuDefaultOptions",this.defaultOptions)}function a(){if(!this.rootElement[0].className.indexOf("htContextMenu")){for(var e=0,t=0,o=this.getSettings().data.length,n=0;o>n;n++)this.getSettings().data[n].name==s.SEPARATOR?e+=2:t+=26;this.view.wt.wtScrollbars.vertical.fixedContainer.style.height=t+e+"px"}}function l(){var e=this,o=e.getSettings().contextMenu,n=t.helper.isObject(o)?o:{};o?(e.contextMenu||(e.contextMenu=new s(e,n)),e.contextMenu.enable(),t.helper.isArray(o)&&e.contextMenu.filterItems(o)):e.contextMenu&&(e.contextMenu.destroy(),delete e.contextMenu)}s.prototype.createMenu=function(o,n){o&&(o=o.replace(/ /g,"_"),o="htContextSubMenu_"+o);var i;return i=o?e("body > .htContextMenu."+o)[0]:e("body > .htContextMenu")[0],i||(i=document.createElement("DIV"),t.Dom.addClass(i,"htContextMenu"),o&&t.Dom.addClass(i,o),document.getElementsByTagName("body")[0].appendChild(i)),this.menus.indexOf(i)<0&&(this.menus.push(i),n=n||0,this.triggerRows.push(n)),i},s.prototype.bindMouseEvents=function(){function o(o){this.closeAll(),o.preventDefault(),o.stopPropagation();var n=this.instance.getSettings().rowHeaders,i=this.instance.getSettings().colHeaders;if(n||i||"TD"==o.target.nodeName||t.Dom.hasClass(o.target,"current")&&t.Dom.hasClass(o.target,"wtBorder")){var r=this.createMenu(),a=this.getItems(this.options);this.show(r,a),this.setMenuPosition(o,r),e(document).on("mousedown.htContextMenu",t.helper.proxy(s.prototype.closeAll,this))}}this.instance.rootElement.on("contextmenu.htContextMenu",t.helper.proxy(o,this))},s.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},s.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},s.prototype.performAction=function(t,o){var n=this,i=e(o).handsontable("getInstance"),r=i.getSelected()[0],a=i.getData()[r];if(a.disabled!==!0&&("function"!=typeof a.disabled||a.disabled.call(this.instance)!==!0)&&!a.hasOwnProperty("submenu")){if("function"!=typeof a.callback)return;var l=this.instance.getSelectedRange(),c=s.utils.normalizeSelection(l);a.callback.call(this.instance,a.key,c,t),n.closeAll(),this.instance.deselectCell()}},s.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu"),e(document).off("mousedown.htContextMenu")},s.prototype.show=function(o,n){o.style.display="block";var i=this;e(o).off("mousedown.htContextMenu").on("mousedown.htContextMenu",function(e){i.performAction(e,o)}),e(o).handsontable({data:s.utils.convertItemsToArray(n),colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:t.helper.proxy(this.renderer,this)}],beforeKeyDown:function(e){i.onBeforeKeyDown(e,o)},afterOnCellMouseOver:function(e,t,n){i.onCellMouseOver(e,t,n,o)},renderAllRows:!0}),this.bindTableEvents(),e(o).handsontable("listen")},s.prototype.close=function(t){this.hide(t),e(document).off("mousedown.htContextMenu"),this.unbindTableEvents(),this.instance.listen()},s.prototype.closeAll=function(){for(;this.menus.length>0;){var e=this.menus.pop();e&&this.close(e)}this.triggerRows=[]},s.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();e&&this.hide(e)},s.prototype.hide=function(t){t.style.display="none",e(t).handsontable("destroy")},s.prototype.renderer=function(o,n,i,r,a,l){function c(e){return e.hasOwnProperty("submenu")}function h(e){return new RegExp(s.SEPARATOR,"i").test(e.name)}function u(e){return e.disabled===!0||"function"==typeof e.disabled&&e.disabled.call(d.instance)===!0}var d=this,f=o.getData()[i],p=document.createElement("DIV");"function"==typeof l&&(l=l.call(this.instance)),t.Dom.empty(n),n.appendChild(p),h(f)?t.Dom.addClass(n,"htSeparator"):t.Dom.fastInnerHTML(p,l),u(f)?(t.Dom.addClass(n,"htDisabled"),e(p).on("mouseenter",function(){o.deselectCell()})):c(f)?(t.Dom.addClass(n,"htSubmenu"),e(p).on("mouseenter",function(){o.selectCell(i,r)})):(t.Dom.removeClass(n,"htSubmenu"),t.Dom.removeClass(n,"htDisabled"),e(p).on("mouseenter",function(){o.selectCell(i,r)}))},s.prototype.onCellMouseOver=function(t,o,n,i){var r=e(i).handsontable("getInstance"),s=this.menus.length;if(s>0){var a=this.menus[s-1];a.id!=i.id&&this.closeLastOpenedSubMenu()}else this.closeLastOpenedSubMenu();if(-1!=n.className.indexOf("htSubmenu")){var l=r.getData()[o.row],c=this.getItems(l.submenu),h=this.createMenu(l.name,o.row),u=n.getBoundingClientRect();this.show(h,c),this.setSubMenuPosition(u,h)}},s.prototype.onBeforeKeyDown=function(o,n){function i(e){var t=e.getCell(0,0);s.utils.isSeparator(t)||s.utils.isDisabled(t)?a(0,0,e):e.selectCell(0,0)}function r(e){var t=e.countRows()-1,o=e.getCell(t,0);s.utils.isSeparator(o)||s.utils.isDisabled(o)?l(t,0,e):e.selectCell(t,0)}function a(e,t,o){var n=e+1,i=n<o.countRows()?o.getCell(n,t):null;i&&(s.utils.isSeparator(i)||s.utils.isDisabled(i)?a(n,t,o):o.selectCell(n,t))}function l(e,t,o){var n=e-1,i=n>=0?o.getCell(n,t):null;i&&(s.utils.isSeparator(i)||s.utils.isDisabled(i)?l(n,t,o):o.selectCell(n,t))}function c(t,o,n,i){var r=t.getData()[i],s=o.getItems(r.submenu),a=o.createMenu(r.name,i),l=n.getBoundingClientRect();o.show(a,s),o.setSubMenuPosition(l,a);var c=e(a).handsontable("getInstance");c.selectCell(0,0)}var h=this,u=e(n).handsontable("getInstance"),d=u.getSelected();switch(o.keyCode){case t.helper.keyCode.ESCAPE:h.closeAll(),o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ENTER:d&&h.performAction(o,n);break;case t.helper.keyCode.ARROW_DOWN:d?a(d[0],d[1],u,h):i(u,h),o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_UP:d?l(d[0],d[1],u,h):r(u,h),o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_RIGHT:if(d){var f=d[0],p=u.getCell(d[0],0);s.utils.hasSubMenu(p)&&c(u,h,p,f)}o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_LEFT:if(d){if(-1!=n.className.indexOf("htContextSubMenu_")){h.closeLastOpenedSubMenu();var m=h.menus.length;if(m>0){n=h.menus[m-1];var g=h.triggerRows.pop();u=e(n).handsontable("getInstance"),u.selectCell(g,0)}}o.preventDefault(),o.stopImmediatePropagation()}}},s.prototype.getItems=function(e){function o(e){"string"==typeof e?this.name=e:t.helper.extend(this,e)}var n={};o.prototype=e;for(var i in e.items)!e.items.hasOwnProperty(i)||this.itemsFilter&&-1==this.itemsFilter.indexOf(i)||(n[i]=new o(e.items[i]));return n},s.prototype.updateOptions=function(e,o){if(e=e||{},e.items)for(var n in e.items){var i={};e.items.hasOwnProperty(n)&&this.defaultOptions.items.hasOwnProperty(n)&&t.helper.isObject(e.items[n])&&(t.helper.extend(i,this.defaultOptions.items[n]),t.helper.extend(i,e.items[n]),e.items[n]=i)}t.helper.extend(o,e)},s.prototype.setSubMenuPosition=function(e,o){var n=t.Dom.getWindowScrollTop(),i=t.Dom.getWindowScrollLeft(),r={top:n+e.top,topRelative:e.top,left:e.left,leftRelative:e.left-i,scrollTop:n,scrollLeft:i,cellHeight:e.height,cellWidth:e.width};this.menuFitsBelowCursor(r,o)?this.positionMenuBelowCursor(r,o,!0):this.menuFitsAboveCursor(r,o)?this.positionMenuAboveCursor(r,o,!0):this.positionMenuBelowCursor(r,o,!0),this.menuFitsOnRightOfCursor(r,o)?this.positionMenuOnRightOfCursor(r,o,!0):this.positionMenuOnLeftOfCursor(r,o,!0)},s.prototype.setMenuPosition=function(e,o){var n=e.pageY,i=e.pageX,r=t.Dom.getWindowScrollTop(),s=t.Dom.getWindowScrollLeft(),a={top:n,topRelative:n-r,left:i,leftRelative:i-s,scrollTop:r,scrollLeft:s,cellHeight:e.target.clientHeight,cellWidth:e.target.clientWidth};this.menuFitsBelowCursor(a,o)?this.positionMenuBelowCursor(a,o):this.menuFitsAboveCursor(a,o)?this.positionMenuAboveCursor(a,o):this.positionMenuBelowCursor(a,o),this.menuFitsOnRightOfCursor(a,o)?this.positionMenuOnRightOfCursor(a,o):this.positionMenuOnLeftOfCursor(a,o)},s.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight},s.prototype.menuFitsBelowCursor=function(e,t){return e.topRelative+t.offsetHeight<=e.scrollTop+document.body.clientHeight},s.prototype.menuFitsOnRightOfCursor=function(e,t){return e.leftRelative+t.offsetWidth<=e.scrollLeft+document.body.clientWidth},s.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"},s.prototype.positionMenuAboveCursor=function(e,t,o){t.style.top=o?e.top+e.cellHeight-t.offsetHeight+"px":e.top-t.offsetHeight+"px"},s.prototype.positionMenuOnRightOfCursor=function(e,t,o){t.style.left=o?1+e.left+e.cellWidth+"px":1+e.left+"px"},s.prototype.positionMenuOnLeftOfCursor=function(e,t,o){t.style.left=o?e.left-t.offsetWidth+"px":e.left-t.offsetWidth+"px"},s.utils={},s.utils.convertItemsToArray=function(e){var t,o=[];for(var n in e)if(e.hasOwnProperty(n)){if("string"==typeof e[n])t={name:e[n]};else{if(e[n].visible===!1)continue;t=e[n]}t.key=n,o.push(t)
}return o},s.utils.normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}},s.utils.isSeparator=function(e){return t.Dom.hasClass(e,"htSeparator")},s.utils.hasSubMenu=function(e){return t.Dom.hasClass(e,"htSubmenu")},s.utils.isDisabled=function(e){return t.Dom.hasClass(e,"htDisabled")},s.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},s.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())},s.prototype.destroy=function(){for(this.closeAll();this.menus.length>0;){var e=this.menus.pop();this.triggerRows.pop(),e&&(this.close(e),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(e))}this.unbindMouseEvents(),this.unbindTableEvents()},s.prototype.isMenuEnabledByOtherHotInstance=function(){for(var t=e(".handsontable"),o=!1,n=0,i=t.length;i>n;n++){var r=e(t[n]).handsontable("getInstance");if(r&&r.getSettings().contextMenu){o=!0;break}}return o},s.prototype.removeMenu=function(e){e.parentNode&&this.menu.parentNode.removeChild(e)},s.prototype.filterItems=function(e){this.itemsFilter=e},s.SEPARATOR="---------",t.hooks.add("afterInit",l),t.hooks.add("afterUpdateSettings",l),t.hooks.add("afterInit",a),t.PluginHooks.register&&t.PluginHooks.register("afterContextMenuDefaultOptions"),t.ContextMenu=s}(o);var z=function(){var e=this,t=e.getSettings().comments;t&&(o.Comments=new r(e),o.Comments.init())},_=function(e,t,n,i,r,s){s.comment&&o.Dom.addClass(e,s.commentedCellClassName)},F=function(e){var t=this;t.getSettings().comments&&(e.items.commentsCellsSeparator=o.ContextMenu.SEPARATOR,e.items.commentsAddEdit={name:function(){var e=o.Comments.checkSelectionCommentsConsistency();return e?"Edit Comment":"Add Comment"},callback:function(){o.Comments.showComment(this.getSelectedRange())},disabled:function(){return!1}},e.items.commentsRemove={name:function(){return"Delete Comment"},callback:function(e,t){o.Comments.removeComment(t.start.row,t.start.col)},disabled:function(){var e=o.Comments.checkSelectionCommentsConsistency();return!e}})};o.hooks.add("beforeInit",z),o.hooks.add("afterContextMenuDefaultOptions",F),o.hooks.add("afterRenderer",_),function(o){function n(){function n(e){f=this,p=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){d=t;var o=p.getBoundingClientRect();u=o.left,m.style.top=o.top+"px",m.style.left=u+"px",f.rootElement[0].appendChild(m)}}function i(e){var t=e.getBoundingClientRect();m.style.left=t.left+"px"}function r(){var e=this;o.Dom.addClass(m,"active"),o.Dom.addClass(g,"active");var t=p.getBoundingClientRect();g.style.width=t.width+"px",g.style.height=e.view.maximumVisibleElementHeight(0)+"px",g.style.top=m.style.top,g.style.left=u+"px",e.rootElement[0].appendChild(g)}function s(e){g.style.left=u+e+"px"}function a(){o.Dom.removeClass(m,"active"),o.Dom.removeClass(g,"active")}var l,c,h,u,d,f,p,m=document.createElement("DIV"),g=document.createElement("DIV"),w=e(t);m.className="manualColumnMover",g.className="manualColumnMoverGuide";var y=function(){var e=this;o.hooks.run(e,"persistentStateSave","manualColumnPositions",e.manualColumnPositions)},v=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","manualColumnPositions",t),t.value},C=function(){var e,t=this;t.rootElement.on("mouseenter.manualColumnMove."+t.guid,"table thead tr > th",function(o){e?(c=t.view.wt.wtTable.getCoords(o.currentTarget).col,i(o.currentTarget)):n.call(t,o.currentTarget)}),t.rootElement.on("mousedown.manualColumnMove."+t.guid,".manualColumnMover",function(o){h=o.pageX,r.call(t),e=t,l=d,c=d}),w.on("mousemove.manualColumnMove."+t.guid,function(t){e&&s(t.pageX-h)}),w.on("mouseup.manualColumnMove."+t.guid,function(){e&&(a(),e=!1,c>l&&c--,S(t.manualColumnPositions,t.countCols()),t.manualColumnPositions.splice(c,0,t.manualColumnPositions.splice(l,1)[0]),t.forceFullRender=!0,t.view.render(),y.call(t),o.hooks.run(t,"afterColumnMove",l,c),n.call(t,p))}),t.addHook("afterDestroy",b)},b=function(){var e=this;e.rootElement.off("mouseenter.manualColumnMove."+e.guid,"table thead tr > th"),e.rootElement.off("mousedown.manualColumnMove."+e.guid,".manualColumnMover"),w.off("mousemove.manualColumnMove."+e.guid),w.off("mouseup.manualColumnMove."+e.guid)},S=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnMove;if(o){var n=this.getSettings().manualColumnMove,i=v.call(t);this.manualColumnPositions="undefined"!=typeof i?i:n instanceof Array?n:[],"afterInit"==e&&(C.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else b.call(this),this.manualColumnPositions=[]},this.modifyCol=function(e){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[e]&&S(this.manualColumnPositions,e+1),this.manualColumnPositions[e]):e}}var i=new n;o.hooks.add("beforeInit",i.beforeInit),o.hooks.add("afterInit",function(){i.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){i.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyCol",i.modifyCol),o.hooks.register("afterColumnMove")}(o),function(o){function n(){function n(e){u=this,l=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){c=t;var o=l.getBoundingClientRect();m=o.left-6,p=parseInt(o.width,10),g.style.top=o.top+"px",g.style.left=m+p+"px",u.rootElement[0].appendChild(g)}}function i(){g.style.left=m+h+"px"}function r(){var e=this;o.Dom.addClass(g,"active"),o.Dom.addClass(w,"active"),w.style.top=g.style.top,w.style.left=g.style.left,w.style.height=e.view.maximumVisibleElementHeight(0)+"px",e.rootElement[0].appendChild(w)}function s(){w.style.left=g.style.left}function a(){o.Dom.removeClass(g,"active"),o.Dom.removeClass(w,"active")}var l,c,h,u,d,f,p,m,g=document.createElement("DIV"),w=document.createElement("DIV"),y=e(t);g.className="manualColumnResizer",w.className="manualColumnResizerGuide";var v=function(){var e=this;o.hooks.run(e,"persistentStateSave","manualColumnWidths",e.manualColumnWidths)},C=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","manualColumnWidths",t),t.value},b=function(){var e,t=this,u=0,m=null;t.rootElement.on("mouseenter.manualColumnResize."+t.guid,"table thead tr > th",function(o){e||n.call(t,o.currentTarget)}),t.rootElement.on("mousedown.manualColumnResize."+t.guid,".manualColumnResizer",function(n){r.call(t),e=t,null==m&&(m=setTimeout(function(){u>=2&&(d=t.determineColumnWidth.call(t,c),R(c,d),t.forceFullRender=!0,t.view.render(),o.hooks.run(t,"afterColumnResize",c,d)),u=0,m=null},500),t._registerTimeout(m)),u++,f=n.pageX,d=p}),y.on("mousemove.manualColumnResize."+t.guid,function(t){e&&(h=p+(t.pageX-f),d=R(c,h),i(),s())}),y.on("mouseup.manualColumnResize."+t.guid,function(){e&&(a(),e=!1,d!=p&&(t.forceFullRender=!0,t.view.render(),v.call(t),o.hooks.run(t,"afterColumnResize",c,d)),n.call(t,l))}),t.addHook("afterDestroy",S)},S=function(){var e=this;e.rootElement.off("mouseenter.manualColumnResize."+e.guid,"table thead tr > th"),e.rootElement.off("mousedown.manualColumnResize."+e.guid,".manualColumnResizer"),y.off("mousemove.manualColumnResize."+e.guid),y.off("mouseup.manualColumnResize."+e.guid)};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnResize;if(o){var n=this.getSettings().manualColumnResize,i=C.call(t);this.manualColumnWidths="undefined"!=typeof i?i:n instanceof Array?n:[],"afterInit"==e&&(b.call(this),this.manualColumnWidths.length>0&&(this.forceFullRender=!0,this.render()))}else S.call(this),this.manualColumnWidths=[]};var R=function(e,t){return t=Math.max(t,20),e=o.hooks.execute(u,"modifyCol",e),u.manualColumnWidths[e]=t,t};this.modifyColWidth=function(e,t){return t=this.runHooksAndReturn("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t]?this.manualColumnWidths[t]:e}}var i=new n;o.hooks.add("beforeInit",i.beforeInit),o.hooks.add("afterInit",function(){i.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){i.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyColWidth",i.modifyColWidth),o.hooks.register("afterColumnResize")}(o),function(o){function n(){function n(e){u=this,l=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){c=t;var o=l.getBoundingClientRect();m=o.top-6,p=parseInt(o.height,10),g.style.left=o.left+"px",g.style.top=m+p+"px",u.rootElement[0].appendChild(g)}}function i(){g.style.top=m+h+"px"}function r(){var e=this;o.Dom.addClass(g,"active"),o.Dom.addClass(w,"active"),w.style.top=g.style.top,w.style.left=g.style.left,w.style.width=e.view.maximumVisibleElementWidth(0)+"px",e.rootElement[0].appendChild(w)}function s(){w.style.top=g.style.top}function a(){o.Dom.removeClass(g,"active"),o.Dom.removeClass(w,"active")}var l,c,h,u,d,f,p,m,g=document.createElement("DIV"),w=document.createElement("DIV"),y=e(t);g.className="manualRowResizer",w.className="manualRowResizerGuide";var v=function(){var e=this;o.hooks.run(e,"persistentStateSave","manualRowHeights",e.manualRowHeights)},C=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","manualRowHeights",t),t.value},b=function(){var e,t=this,u=0,m=null;t.rootElement.on("mouseenter.manualRowResize."+t.guid,"table tbody tr > th",function(o){e||n.call(t,o.currentTarget)}),t.rootElement.on("mousedown.manualRowResize."+t.guid,".manualRowResizer",function(n){r.call(t),e=t,null==m&&(m=setTimeout(function(){u>=2&&(R(c,null),t.forceFullRender=!0,t.view.render(),o.hooks.run(t,"afterRowResize",c,d)),u=0,m=null},500),t._registerTimeout(m)),u++,f=n.pageY,d=p}),y.on("mousemove.manualRowResize."+t.guid,function(t){e&&(h=p+(t.pageY-f),d=R(c,h),i(),s())}),y.on("mouseup.manualRowResize."+t.guid,function(){e&&(a(),e=!1,d!=p&&(t.forceFullRender=!0,t.view.render(),v.call(t),o.hooks.run(t,"afterRowResize",c,d)),n.call(t,l))}),t.addHook("afterDestroy",S)},S=function(){var e=this;e.rootElement.off("mouseenter.manualRowResize."+e.guid,"table tbody tr > th"),e.rootElement.off("mousedown.manualRowResize."+e.guid,".manualRowResizer"),y.off("mousemove.manualRowResize."+e.guid),y.off("mouseup.manualRowResize."+e.guid)};this.beforeInit=function(){this.manualRowHeights=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualRowResize;if(o){var n=this.getSettings().manualRowResize,i=C.call(t);this.manualRowHeights="undefined"!=typeof i?i:n instanceof Array?n:[],"afterInit"===e?(b.call(this),this.manualRowHeights.length>0&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())}else S.call(this),this.manualRowHeights=[]};var R=function(e,t){return e=o.hooks.execute(u,"modifyRow",e),u.manualRowHeights[e]=t,t};this.modifyRowHeight=function(e,t){return this.getSettings().manualRowResize&&(t=this.runHooksAndReturn("modifyRow",t),void 0!==this.manualRowHeights[t])?this.manualRowHeights[t]:e}}var i=new n;o.hooks.add("beforeInit",i.beforeInit),o.hooks.add("afterInit",function(){i.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){i.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyRowHeight",i.modifyRowHeight),o.hooks.register("afterRowResize")}(o),function(){function e(){var e=this,o=e.getSettings().observeChanges;o?(e.observer&&i.call(e),t.call(e),s.call(e)):o||i.call(e)}function t(){var e=this;e.observeChangesActive=!0,e.pauseObservingChanges=function(){e.observeChangesActive=!1},e.resumeObservingChanges=function(){e.observeChangesActive=!0},e.observedData=e.getData(),e.observer=V.observe(e.observedData,function(t){e.observeChangesActive&&(n.call(e,t),e.render()),e.runHooks("afterChangesObserved")})}function n(e){function t(e){var t;return t=n(e),t=o(t)}function o(e){var t=[];return e.filter(function(e){var o=i(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(o.col)){if(-1!=t.indexOf(o.col))return!1;t.push(o.col)}return!0})}function n(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}function i(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var r=this,s=t(e),a=0,l=s.length;l>a;a++){var c=s[a],h=i(c.path);switch(c.op){case"add":isNaN(h.col)?r.runHooks("afterCreateRow",h.row):r.runHooks("afterCreateCol",h.col);break;case"remove":isNaN(h.col)?r.runHooks("afterRemoveRow",h.row,1):r.runHooks("afterRemoveCol",h.col,1);break;case"replace":r.runHooks("afterChange",[h.row,h.col,null,c.value],"external")}}}function i(){var e=this;e.observer&&(r.call(e),a.call(e))}function r(){var e=this;V.unobserve(e.observedData,e.observer),delete e.observeChangesActive,delete e.pauseObservingChanges,delete e.resumeObservingChanges}function s(){var e=this;e.addHook("afterDestroy",i),e.addHook("afterCreateRow",l),e.addHook("afterRemoveRow",l),e.addHook("afterCreateCol",l),e.addHook("afterRemoveCol",l),e.addHook("afterChange",function(e,t){"loadData"!=t&&l.call(this)})}function a(){var e=this;e.removeHook("afterDestroy",i),e.removeHook("afterCreateRow",l),e.removeHook("afterRemoveRow",l),e.removeHook("afterCreateCol",l),e.removeHook("afterRemoveCol",l),e.removeHook("afterChange",l)}function l(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}o.hooks.add("afterLoadData",e),o.hooks.add("afterUpdateSettings",e),o.hooks.register("afterChangesObserved")}(),function(e){function t(){function t(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.addHook(t,r[t])}function n(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.removeHook(t,r[t])}var i=this;this.init=function(){var o=this,r=o.getSettings().persistentState;return i.enabled=!!r,i.enabled?(o.storage||(o.storage=new e(o.rootElement[0].id)),o.resetState=i.resetValue,void t.call(o)):void n.call(o)},this.saveValue=function(e,t){var o=this;o.storage.saveValue(e,t)},this.loadValue=function(e,t){var o=this;t.value=o.storage.loadValue(e)},this.resetValue=function(e){var t=this;"undefined"!=typeof e?t.storage.reset(e):t.storage.resetAll()};var r={persistentStateSave:i.saveValue,persistentStateLoad:i.loadValue,persistentStateReset:i.resetValue};for(var s in r)r.hasOwnProperty(s)&&o.hooks.register(s)}var n=new t;o.hooks.add("beforeInit",n.init),o.hooks.add("afterUpdateSettings",n.init)}(s),function(t){t.UndoRedo=function(e){var o=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,e.addHook("afterChange",function(e){if(e){var n=new t.UndoRedo.ChangeAction(e);o.done(n)}}),e.addHook("afterCreateRow",function(e,n,i){if(!i){var r=new t.UndoRedo.CreateRowAction(e,n);o.done(r)}}),e.addHook("beforeRemoveRow",function(e,n){var i=o.instance.getData();e=(i.length+e)%i.length;var r=i.slice(e,e+n),s=new t.UndoRedo.RemoveRowAction(e,r);o.done(s)}),e.addHook("afterCreateCol",function(e,n,i){if(!i){var r=new t.UndoRedo.CreateColumnAction(e,n);o.done(r)}}),e.addHook("beforeRemoveCol",function(n,i){var r=o.instance.getData();n=(o.instance.countCols()+n)%o.instance.countCols();for(var s=[],a=0,l=r.length;l>a;a++)s[a]=r[a].slice(n,n+i);var c;t.helper.isArray(e.getSettings().colHeaders)&&(c=e.getSettings().colHeaders.slice(n,n+s.length));var h=new t.UndoRedo.RemoveColumnAction(n,s,c);o.done(h)})},t.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},t.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=!0;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=!1,t.undoneActions.push(e)})}},t.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=!0;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=!1,t.doneActions.push(e)})}},t.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},t.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},t.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},t.UndoRedo.Action=function(){},t.UndoRedo.Action.prototype.undo=function(){},t.UndoRedo.Action.prototype.redo=function(){},t.UndoRedo.ChangeAction=function(e){this.changes=e},t.helper.inherit(t.UndoRedo.ChangeAction,t.UndoRedo.Action),t.UndoRedo.ChangeAction.prototype.undo=function(t,o){for(var n=e.extend(!0,[],this.changes),i=t.countEmptyRows(!0),r=t.countEmptyCols(!0),s=0,a=n.length;a>s;s++)n[s].splice(3,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"undo");for(var s=0,a=n.length;a>s;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&i==t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&r==t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},t.UndoRedo.ChangeAction.prototype.redo=function(t,o){for(var n=e.extend(!0,[],this.changes),i=0,r=n.length;r>i;i++)n[i].splice(2,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"redo")},t.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},t.helper.inherit(t.UndoRedo.CreateRowAction,t.UndoRedo.Action),t.UndoRedo.CreateRowAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)},t.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},t.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},t.helper.inherit(t.UndoRedo.RemoveRowAction,t.UndoRedo.Action),t.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var o=[this.index,0];Array.prototype.push.apply(o,this.data),Array.prototype.splice.apply(e.getData(),o),e.addHookOnce("afterRender",t),e.render()},t.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},t.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},t.helper.inherit(t.UndoRedo.CreateColumnAction,t.UndoRedo.Action),t.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},t.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},t.UndoRedo.RemoveColumnAction=function(e,t,o){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=o},t.helper.inherit(t.UndoRedo.RemoveColumnAction,t.UndoRedo.Action),t.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var o,n,i=0,r=e.getData().length;r>i;i++)o=e.getSourceDataAtRow(i),n=[this.index,0],Array.prototype.push.apply(n,this.data[i]),Array.prototype.splice.apply(o,n);"undefined"!=typeof this.headers&&(n=[this.index,0],Array.prototype.push.apply(n,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,n)),e.addHookOnce("afterRender",t),e.render()},t.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)}}(o),function(e){function t(){var t=this,s="undefined"==typeof t.getSettings().undo||t.getSettings().undo;s?t.undoRedo||(t.undoRedo=new e.UndoRedo(t),i(t),t.addHook("beforeKeyDown",o),t.addHook("afterChange",n)):t.undoRedo&&(delete t.undoRedo,r(t),t.removeHook("beforeKeyDown",o),t.removeHook("afterChange",n))}function o(e){var t=this,o=(e.ctrlKey||e.metaKey)&&!e.altKey;o&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(t.undoRedo.undo(),e.stopImmediatePropagation()))}function n(e,t){var o=this;return"loadData"==t?o.undoRedo.clear():void 0}function i(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function r(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(o),a.prototype.setBoundaries=function(e){this.boundaries=e},a.prototype.setCallback=function(e){this.callback=e},a.prototype.check=function(e,t){var o=0,n=0;t<this.boundaries.top?n=t-this.boundaries.top:t>this.boundaries.bottom&&(n=t-this.boundaries.bottom),e<this.boundaries.left?o=e-this.boundaries.left:e>this.boundaries.right&&(o=e-this.boundaries.right),this.callback(o,n)};var j,U;if("undefined"!=typeof o){var G=function(e){e.dragToScrollListening=!1;var o=e.view.wt.wtScrollbars.vertical.scrollHandler;j=new a,o!==t&&(j.setBoundaries(o?o.getBoundingClientRect():e.$table[0].getBoundingClientRect()),j.setCallback(function(t,n){0>t?o?o.scrollLeft-=50:e.view.wt.scrollHorizontal(-1).draw():t>0&&(o?o.scrollLeft+=50:e.view.wt.scrollHorizontal(1).draw()),0>n?o?o.scrollTop-=20:e.view.wt.scrollVertical(-1).draw():n>0&&(o?o.scrollTop+=20:e.view.wt.scrollVertical(1).draw())}),e.dragToScrollListening=!0)};o.hooks.add("afterInit",function(){var t=this;e(document).on("mouseup."+this.guid,function(){t.dragToScrollListening=!1}),e(document).on("mousemove."+this.guid,function(e){t.dragToScrollListening&&j.check(e.clientX,e.clientY)})}),o.hooks.add("afterDestroy",function(){e(document).off("."+this.guid)}),o.hooks.add("afterOnCellMouseDown",function(){G(this)}),o.hooks.add("afterOnCellCornerMouseDown",function(){G(this)}),o.plugins.DragToScroll=a}if(function(e,t,o){function n(n){function i(){n.isListening()&&n.selection.empty()}function r(e){if(n.isListening()&&n.selection.isSelected()){var t=e.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),i=o.parse(t),r=n.getSelected(),s=new f(r[0],r[1]),a=new f(r[2],r[3]),l=new p(s,s,a),c=l.getTopLeftCorner(),h=l.getBottomRightCorner(),u=c,d=new f(Math.max(h.row,i.length-1+c.row),Math.max(h.col,i[0].length-1+c.col));n.addHookOnce("afterChange",function(e){e&&e.length&&this.selectCell(u.row,u.col,d.row,d.col)}),n.populateFromArray(u.row,u.col,i,d.row,d.col,"paste",n.getSettings().pasteMode)}}function s(t){if(e.helper.isCtrlKey(t.keyCode)&&n.getSelected())return a.setCopyableText(),void t.stopImmediatePropagation();var o=(t.ctrlKey||t.metaKey)&&!t.altKey;t.keyCode==e.helper.keyCode.A&&o&&n._registerTimeout(setTimeout(e.helper.proxy(a.setCopyableText,a),0))}this.copyPasteInstance=t.getInstance(),this.copyPasteInstance.onCut(i),this.copyPasteInstance.onPaste(r);var a=this;n.addHook("beforeKeyDown",s),this.destroy=function(){this.copyPasteInstance.removeCallback(i),this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.destroy(),n.removeHook("beforeKeyDown",s)},n.addHook("afterDestroy",e.helper.proxy(this.destroy,this)),this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=n.getSettings(),o=t.copyRowsLimit,i=t.copyColsLimit,r=n.getSelectedRange(),s=r.getTopLeftCorner(),a=r.getBottomRightCorner(),l=s.row,c=s.col,h=a.row,u=a.col,d=Math.min(h,l+o-1),f=Math.min(u,c+i-1);n.copyPaste.copyPasteInstance.copyable(n.getCopyableData(l,c,d,f)),(h!==d||u!==f)&&e.hooks.run(n,"afterCopyLimit",h-l+1,u-c+1,o,i)}}function i(){var e=this,t=e.getSettings().copyPaste!==!1;t&&!e.copyPaste?e.copyPaste=new n(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}e.hooks.add("afterInit",i),e.hooks.add("afterUpdateSettings",i),e.hooks.register("afterCopyLimit")}(o,W,SheetClip),function(e){function t(){var t=this,o=!!t.getSettings().search;o?t.search=new e.Search(t):delete t.search}e.Search=function(t){this.query=function(o,n,i){var r=t.countRows(),s=t.countCols(),a=[];n||(n=e.Search.global.getDefaultCallback()),i||(i=e.Search.global.getDefaultQueryMethod());for(var l=0;r>l;l++)for(var c=0;s>c;c++){var h=t.getDataAtCell(l,c),u=t.getCellMeta(l,c),d=u.search.callback||n,f=u.search.queryMethod||i,p=f(o,h);if(p){var m={row:l,col:c,data:h};a.push(m)}d&&d(t,l,c,h,p)}return a}},e.Search.DEFAULT_CALLBACK=function(e,t,o,n,i){e.getCellMeta(t,o).isSearchResult=i},e.Search.DEFAULT_QUERY_METHOD=function(e,t){return"undefined"!=typeof e&&null!=e&&e.toLowerCase&&0!=e.length?"undefined"==typeof t||null==t?!1:-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()):!1},e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",e.Search.global=function(){var t=e.Search.DEFAULT_CALLBACK,o=e.Search.DEFAULT_QUERY_METHOD,n=e.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return o},setDefaultQueryMethod:function(e){o=e},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(e){n=e}}}(),e.SearchCellDecorator=function(t,o,n,i,r,s,a){var l="object"==typeof a.search&&a.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();a.isSearchResult?e.Dom.addClass(o,l):e.Dom.removeClass(o,l)};var o=e.renderers.cellDecorator;e.renderers.cellDecorator=function(){o.apply(this,arguments),e.SearchCellDecorator.apply(this,arguments)},e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(o),c.prototype.canMergeRange=function(e){return!e.isSingle()},c.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),o=e.getBottomRightCorner(),n={};n.row=t.row,n.col=t.col,n.rowspan=o.row-t.row+1,n.colspan=o.col-t.col+1,this.mergedCellInfoCollection.setInfo(n)}},c.prototype.mergeOrUnmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col);t?this.unmergeSelection(e.from):this.mergeSelection(e)},c.prototype.mergeSelection=function(e){this.mergeRange(e)},c.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},c.prototype.applySpanProperties=function(e,t,o){var n=this.mergedCellInfoCollection.getInfo(t,o);n?n.row===t&&n.col===o?(e.setAttribute("rowspan",n.rowspan),e.setAttribute("colspan",n.colspan)):e.style.display="none":(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},c.prototype.modifyTransform=function(e,t,o){var n;switch(e){case"modifyTransformStart":n=t.highlight;break;case"modifyTransformEnd":n=t.to}if("modifyTransformStart"==e){var i=this.mergedCellInfoCollection.getInfo(n.row+o.row,n.col+o.col);i?(n.row>i.row?(this.lastDesiredCoords=new f(n.row+o.row,n.col+o.col),o.row+=i.row-n.row-o.row):n.row==i.row&&o.row>0?o.row+=i.row-n.row+i.rowspan-1:this.lastDesiredCoords&&0===o.row&&(o.row+=this.lastDesiredCoords.row-n.row,this.lastDesiredCoords=null),n.col>i.col?(this.lastDesiredCoords||(this.lastDesiredCoords=new f(n.row+o.row,n.col+o.col)),o.col+=i.col-n.col-o.col):n.col==i.col&&o.col>0?o.col+=i.col-n.col+i.colspan-1:this.lastDesiredCoords&&0===o.col&&(o.col+=this.lastDesiredCoords.col-n.col,this.lastDesiredCoords=null)):this.lastDesiredCoords&&(0==o.col?o.col+=this.lastDesiredCoords.col-n.col:0==o.row&&(o.row+=this.lastDesiredCoords.row-n.row),this.lastDesiredCoords=null)}else{var r=this.mergedCellInfoCollection.getInfo(t.highlight.row,t.highlight.col);r&&t.isSingle()&&(t.from=new f(r.row,r.col),t.to=new f(r.row+r.rowspan-1,r.col+r.colspan-1)),t.isSingle()&&(t.from=new f(t.highlight.row,t.highlight.col),t.to=new f(t.highlight.row,t.highlight.col));var s=function(e){function n(t,o,n){t[i]=o,t[e]=n}var i="col"==e?"row":"col";if(0!=o[e]){var r,s,a=function(){r=t.getTopLeftCorner(),s=t.getBottomRightCorner()};a();var l,c=!1;if(o[e]<0)if(l=s[e]+o[e],s[e]==t.highlight[e])l=r[e]+o[e],c=!0;else for(var h=r[i];h<=s[i];h++){var u=this.mergedCellInfoCollection.getInfo(h,s[e]);if(u&&u[e]<=t.highlight[e]){l=r[e]+o[e],c=!0;break}}else if(o[e]>0)if(l=r[e]+o[e],r[e]==t.highlight[e])l=s[e]+o[e],c=!0;else for(var h=r[i];h<=s[i];h++){var u=this.mergedCellInfoCollection.getInfo(h,r[e]);if(u&&u[e]+u[e+"span"]>t.highlight[e]){l=s[e]+o[e],c=!0;break}}c?o[e]>0?(n(t.from,r[i],r[e]),n(t.to,s[i],Math.max(s[e],l)),a()):(n(t.from,r[i],Math.min(r[e],l)),n(t.to,s[i],s[e]),a()):o[e]>0?(n(t.from,r[i],Math.max(r[e],l)),n(t.to,s[i],s[e]),a()):(n(t.from,r[i],r[e]),n(t.to,s[i],Math.min(s[e],l)),a());for(var h=r[i];h<=s[i];h++){var u="col"==e?this.mergedCellInfoCollection.getInfo(h,l):this.mergedCellInfoCollection.getInfo(l,h);u&&(c?o[e]>0?(n(t.from,Math.min(r[i],u[i]),Math.min(r[e],u[e])),l>u[e]?n(t.to,Math.max(s[i],u[i]+u[i+"span"]-1),Math.max(s[e],u[e]+u[e+"span"])):n(t.to,Math.max(s[i],u[i]+u[i+"span"]-1),Math.max(s[e],u[e]+u[e+"span"]-1)),a()):(n(t.from,Math.min(r[i],u[i]),Math.min(r[e],u[e])),n(t.to,Math.max(s[i],u[i]+u[i+"span"]-1),Math.max(s[e],u[e]+u[e+"span"]-1)),a()):o[e]>0?(l>u[e]?(n(t.from,r[i],Math.max(r[e],u[e]+u[e+"span"])),n(t.to,s[i],Math.max(s[e],u[e]+u[e+"span"]))):(n(t.from,r[i],Math.max(r[e],u[e])),n(t.to,s[i],Math.max(s[e],u[e]+u[e+"span"]-1))),a()):(l<u[e]+u[e+"span"]-1?(n(t.from,r[i],Math.min(r[e],u[e]-1)),n(t.to,s[i],Math.min(s[e],u[e]-1))):(n(t.from,r[i],Math.min(r[e],u[e])),n(t.to,s[i],Math.min(s[e],u[e]+u[e+"span"]))),a()))}}};s.call(this,"col"),s.call(this,"row"),o.row=0,o.col=0}},"undefined"==typeof o)throw new Error("Handsontable is not defined");var z=function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new c(t)))},K=function(e){if(this.mergeCells){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;t&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),e.stopImmediatePropagation())}},X=function(e){this.getSettings().mergeCells&&(e.items.mergeCellsSeparator=o.ContextMenu.SEPARATOR,e.items.mergeCells={name:function(){var e=this.getSelected(),t=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);return t?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return!1}})},_=function(e,t,o){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,o)},$=function(e){return function(t){var o=this.getSettings().mergeCells;if(o){var n=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,n,t),"modifyTransformEnd"===e){var i=this.countRows(),r=this.countCols();n.from.row<0?n.from.row=0:n.from.row>0&&n.from.row>=i&&(n.from.row=n.from-1),n.from.col<0?n.from.col=0:n.from.col>0&&n.from.col>=r&&(n.from.col=r-1)}}}},Y=function(e){this.lastDesiredCoords=null;var t=this.getSettings().mergeCells;if(t){var o=this.getSelectedRange();o.highlight=new f(o.highlight.row,o.highlight.col),o.to=e;for(var n=0,i=this.mergeCells.mergedCellInfoCollection.length;i>n;n++){var r=this.mergeCells.mergedCellInfoCollection[n],s=new f(r.row,r.col),a=new f(r.row+r.rowspan-1,r.col+r.colspan-1),l=new p(s,s,a);if(o.expandByRange(l)){var c=o.getBottomRightCorner();e.row=c.row,e.col=c.col}}}},q=function(e,t,o){var n=this.getSettings().mergeCells;if(n){var i=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!i||i.row==e&&i.col==t||(o.copyable=!1)}};if(o.hooks.add("beforeInit",z),o.hooks.add("beforeKeyDown",K),o.hooks.add("modifyTransformStart",$("modifyTransformStart")),o.hooks.add("modifyTransformEnd",$("modifyTransformEnd")),o.hooks.add("beforeSetRangeEnd",Y),o.hooks.add("afterRenderer",_),o.hooks.add("afterContextMenuDefaultOptions",X),o.hooks.add("afterGetCellMeta",q),o.MergeCells=c,function(){function e(){}var t,n={},i=!1,r=function(){var o=this.getSettings().customBorders,n=!1;"boolean"==typeof o&&1==o&&(n=!0),"object"==typeof o&&o.length>0&&(i=!0,n=!0),n&&(this.customBorders||(t=this,this.customBorders=new e))},s=function(e,t,o){var n=f(e,t);n=p(n,o),this.setCellMeta(e,t,"borders",n),m(n)},a=function(e){for(var t=e.range,o=t.from.row;o<=t.to.row;o++)for(var n=t.from.col;n<=t.to.col;n++){var i=f(o,n),r=0;o==t.from.row&&(r++,e.hasOwnProperty("top")&&(i.top=e.top)),o==t.to.row&&(r++,e.hasOwnProperty("bottom")&&(i.bottom=e.bottom)),n==t.from.col&&(r++,e.hasOwnProperty("left")&&(i.left=e.left)),n==t.to.col&&(r++,e.hasOwnProperty("right")&&(i.right=e.right)),r>0&&(this.setCellMeta(o,n,"borders",i),m(i))
}},l=function(e,t){return"border_row"+e+"col"+t},c=function(){return{width:1,color:"#000"}},h=function(){return{hide:!0}},u=function(){return{width:1,color:"#000",cornerVisible:!1}},f=function(e,t){return{className:l(e,t),border:u(),row:e,col:t,top:h(),right:h(),bottom:h(),left:h()}},p=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e},m=function(e){n[e.className]=e},g=function(e){delete n[e]},w=function(e){var t=document.getElementsByClassName(e)[0];if(t){var o=t.parentNode;o.parentNode.removeChild(o)}},y=function(e,t){var o=l(e,t);w(o),g(o),this.removeCellMeta(e,t,"borders")},v=function(e){var t=document.getElementsByClassName(l(e.row,e.col)),o=t.length>0;o&&w(l(e.row,e.col));var n=new d(this.view.wt,e);n.appear([e.row,e.col,e.row,e.col])},C=function(e,t,o,n){var i=this.getCellMeta(e,t).borders;i&&void 0!=i.border||(i=f(e,t)),i[o]=n?h():c(),this.setCellMeta(e,t,"borders",i),m(i),this.render()},b=function(e,t,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?y.call(this,e.from.row,e.from.col):C.call(this,e.from.row,e.from.col,t,o);else switch(t){case"noBorders":for(var n=e.from.col;n<=e.to.col;n++)for(var i=e.from.row;i<=e.to.row;i++)y.call(this,i,n);break;case"top":for(var r=e.from.col;r<=e.to.col;r++)C.call(this,e.from.row,r,t,o);break;case"right":for(var s=e.from.row;s<=e.to.row;s++)C.call(this,s,e.to.col,t);break;case"bottom":for(var a=e.from.col;a<=e.to.col;a++)C.call(this,e.to.row,a,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)C.call(this,l,e.from.col,t)}},S=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,i){var r=e.getCellMeta(n,i).borders;if(r){if(!t)return o=!0,!1;if(!r[t].hasOwnProperty("hide"))return o=!0,!1}}),o},R=function(e){return"<span class='selected'></span>"+e},T=function(e){this.getSettings().customBorders&&(e.items.bordersCellsSeparator=o.ContextMenu.SEPARATOR,e.items.borders={name:"Borders",submenu:{items:{top:{name:function(){var e="Top",t=S(this,"top");return t&&(e=R(e)),e},callback:function(){var e=S(this,"top");b.call(this,this.getSelectedRange(),"top",e)},disabled:!1},right:{name:function(){var e="Right",t=S(this,"right");return t&&(e=R(e)),e},callback:function(){var e=S(this,"right");b.call(this,this.getSelectedRange(),"right",e)},disabled:!1},bottom:{name:function(){var e="Bottom",t=S(this,"bottom");return t&&(e=R(e)),e},callback:function(){var e=S(this,"bottom");b.call(this,this.getSelectedRange(),"bottom",e)},disabled:!1},left:{name:function(){var e="Left",t=S(this,"left");return t&&(e=R(e)),e},callback:function(){var e=S(this,"bottom");b.call(this,this.getSelectedRange(),"left",e)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){b.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!S(this)}}}}})};o.hooks.add("beforeInit",r),o.hooks.add("afterContextMenuDefaultOptions",T),o.hooks.add("afterRender",function(){var e=this.getSettings().customBorders;if(i){for(var t=0;t<e.length;t++)e[t].range?a.call(this,e[t]):s.call(this,e[t].row,e[t].col,e[t]);i=!1}for(var o in n)n.hasOwnProperty(o)&&v.call(this,n[o])}),o.CustomBorders=e}(),function(o){function n(){function n(e){U=this,f=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){d=t;var o=f.getBoundingClientRect();u=o.top,p.style.top=u+"px",p.style.left=o.left+"px",U.rootElement[0].appendChild(p)}}function i(e){var t=e.getBoundingClientRect();p.style.top=t.top+"px"}function r(){var e=this;o.Dom.addClass(p,"active"),o.Dom.addClass(m,"active");var t=f.getBoundingClientRect();m.style.width=e.view.maximumVisibleElementWidth(0)+"px",m.style.height=t.height+"px",m.style.top=u+"px",m.style.left=p.style.left,e.rootElement[0].appendChild(m)}function s(e){m.style.top=u+e+"px"}function a(){o.Dom.removeClass(p,"active"),o.Dom.removeClass(m,"active")}var l,c,h,u,d,f,p=document.createElement("DIV"),m=document.createElement("DIV"),g=e(t);p.className="manualRowMover",m.className="manualRowMoverGuide";var w=function(){var e=this;o.hooks.run(e,"persistentStateSave","manualRowPositions",e.manualRowPositions)},y=function(){var e=this,t={};return o.hooks.run(e,"persistentStateLoad","manualRowPositions",t),t.value},v=function(){var e,t=this;t.rootElement.on("mouseenter.manualRowMove."+t.guid,"table tbody tr > th",function(o){e?(c=t.view.wt.wtTable.getCoords(o.currentTarget).row,i(o.currentTarget)):n.call(t,o.currentTarget)}),t.rootElement.on("mousedown.manualRowMove."+t.guid,".manualRowMover",function(o){h=o.pageY,r.call(t),e=t,l=d,c=d}),g.on("mousemove.manualRowMove."+t.guid,function(t){e&&s(t.pageY-h)}),g.on("mouseup.manualRowMove."+t.guid,function(){e&&(a(),e=!1,c>l&&c--,b(t.manualRowPositions,t.countRows()),t.manualRowPositions.splice(c,0,t.manualRowPositions.splice(l,1)[0]),t.forceFullRender=!0,t.view.render(),w.call(t),o.hooks.run(t,"afterRowMove",l,c),n.call(t,f))}),t.addHook("afterDestroy",C)},C=function(){var e=this;e.rootElement.off("mouseenter.manualRowMove."+e.guid,"table tbody tr > th"),e.rootElement.off("mousedown.manualRowMove."+e.guid,".manualRowMover"),g.off("mousemove.manualRowMove."+e.guid),g.off("mouseup.manualRowMove."+e.guid)},b=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualRowPositions=[]},this.init=function(e){var t=this,o=!!t.getSettings().manualRowMove;if(o){var n=t.getSettings().manualRowMove,i=y.call(t);this.manualRowPositions="undefined"!=typeof i?i:n instanceof Array?n:[],"afterInit"===e&&(v.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))}else C.call(this),t.manualRowPositions=[]},this.modifyRow=function(e){var t=this;return t.getSettings().manualRowMove?("undefined"==typeof t.manualRowPositions[e]&&b(this.manualRowPositions,e+1),t.manualRowPositions[e]):e}}var i=new n;o.hooks.add("beforeInit",i.beforeInit),o.hooks.add("afterInit",function(){i.init.call(this,"afterInit")}),o.hooks.add("afterUpdateSettings",function(){i.init.call(this,"afterUpdateSettings")}),o.hooks.add("modifyRow",i.modifyRow),o.hooks.register("afterRowMove")}(o),function(o){function n(n){this.instance=n,this.addingStarted=!1;var i,r,s=(e(document),!1),a=this,l=function(){return n.autofill?void(n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged>1&&n.autofill.apply(),n.autofill.handle.isDragged=0,s=!1)):!0};e(document).off("mouseup.autofill."+n.guid,this.instance.rootElement).on("mouseup.autofill."+n.guid,this.instance.rootElement,function(e){l(e)}),e(document).off("mousemove.moveOutside_"+n.guid).on("mousemove.moveOutside_"+n.guid,function(e){if(!a.instance.autofill)return 0;var n=o.Dom.offset(a.instance.$table[0]).top-(t.pageYOffset||document.documentElement.scrollTop)+o.Dom.outerHeight(a.instance.$table[0]),i=o.Dom.offset(a.instance.$table[0]).left-(t.pageXOffset||document.documentElement.scrollLeft)+o.Dom.outerWidth(a.instance.$table[0]);a.addingStarted===!1&&a.instance.autofill.handle.isDragged>0&&e.clientY>n&&e.clientX<=i?(this.mouseDragOutside=!0,a.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&setTimeout(function(){a.addingStarted=!1,a.instance.alter("insert_row")},200)}),i=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){n.autofill.handle.isDragged=1,s=!0,i(e)},r=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(e,t,o,i){n.autofill&&s&&!n.view.isMouseDown()&&n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged++,n.autofill.showBorder(t),n.autofill.checkIfNewRowNeeded()),r(e,t,o,i)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){n.autofill.selectAdjacent()}}n.prototype.init=function(){this.handle={}},n.prototype.disable=function(){this.handle.disabled=!0},n.prototype.selectAdjacent=function(){var e,t,o,n,i;e=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),t=this.instance.getData();e:for(o=e[2]+1;o<this.instance.countRows();o++){for(i=e[1];i<=e[3];i++)if(t[o][i])break e;(t[o][e[1]-1]||t[o][e[3]+1])&&(n=o)}n&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new f(e[0],e[1])),this.instance.view.wt.selections.fill.add(new f(n,e[3])),this.apply())},n.prototype.apply=function(){var e,t,n,i,r;if(this.handle.isDragged=0,e=this.instance.view.wt.selections.fill.getCorners(),e&&(this.instance.view.wt.selections.fill.clear(),t=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),e[0]===t[0]&&e[1]<t[1]?(n=new f(e[0],e[1]),i=new f(e[2],t[1]-1)):e[0]===t[0]&&e[3]>t[3]?(n=new f(e[0],t[3]+1),i=new f(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(n=new f(e[0],e[1]),i=new f(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(n=new f(t[2]+1,e[1]),i=new f(e[2],e[3])),n)){var s={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to};r=this.instance.getData(s.from.row,s.from.col,s.to.row,s.to.col),o.hooks.run(this.instance,"beforeAutofill",n,i,r),this.instance.populateFromArray(n.row,n.col,r,i.row,i.col,"autofill"),this.instance.selection.setRangeStart(new f(e[0],e[1])),this.instance.selection.setRangeEnd(new f(e[2],e[3]))}},n.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),o=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==this.instance.getSettings().fillHandle&&(o.row<e.row||t.row>e.row))e=new f(e.row,o.col);else{if("vertical"===this.instance.getSettings().fillHandle)return;e=new f(o.row,e.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},n.prototype.checkIfNewRowNeeded=function(){var e,t=this.instance.countRows(),o=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&(e=this.instance.view.wt.selections.fill.getCorners(),e[2]===t-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){o.instance.alter("insert_row"),o.addingStarted=!1},200))))},o.hooks.add("afterInit",function(){var e=new n(this);"undefined"!=typeof this.getSettings().fillHandle&&(e.handle&&this.getSettings().fillHandle===!1?e.disable():e.handle||this.getSettings().fillHandle===!1||(this.autofill=e,this.autofill.init()))}),o.Autofill=n}(o),h.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.scrollHandler=this.getScrollableElement(this.TABLE),this.$scrollHandler=e(this.scrollHandler)},h.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.overflow="hidden";var o=document.createElement("TABLE");return o.className=this.instance.wtTable.TABLE.className,t.appendChild(o),this.instance.wtTable.holder.parentNode.appendChild(t),new y({cloneSource:this.instance,cloneOverlay:this,table:o})},h.prototype.getScrollableElement=function(e){for(var o=e.parentNode;o&&o.style;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;if(this instanceof D&&"visible"!==o.style.overflowX&&""!==o.style.overflowX)return o;o=o.parentNode}return t},h.prototype.onScroll=function(){this.windowScrollPosition=this.getScrollPosition(),this.readSettings(),this.resetFixedPosition()},h.prototype.availableSize=function(){var e;return e=this.windowScrollPosition>this.tableParentOffset?this.instance.wtTable.getLastVisibleRow()===this.total-1?o.Dom.outerHeight(this.TABLE):this.windowSize:this.windowSize-this.tableParentOffset},h.prototype.refresh=function(e){this.clone&&this.clone.draw(e)},h.prototype.destroy=function(){this.$scrollHandler.off("."+this.clone.guid),e(t).off("."+this.clone.guid),e(document).off("."+this.clone.guid),e(document.body).off("."+this.clone.guid)},u.prototype.getSize=function(e){return this.cellSizes[e]},u.prototype.getContainerSize=function(e){return"function"==typeof this.containerSizeFn?this.containerSizeFn(e):this.containerSizeFn},u.prototype.countVisible=function(){return this.cellCount},u.prototype.isLastIncomplete=function(){return this.remainingSize>0},d.prototype.appear=function(e){var t,n,i,r,s,a,l,c,h,u,d,p;if(!this.disabled){var m,g,w,y,v,C,b,S=this.instance;for(C=S.cloneOverlay instanceof k||S.cloneOverlay instanceof E?S.getSetting("fixedRowsTop"):S.wtTable.getRowStrategy().countVisible(),v=0;C>v;v++)if(b=S.wtTable.rowFilter.visibleToSource(v),b>=e[0]&&b<=e[2]){m=b;break}for(v=C-1;v>=0;v--)if(b=S.wtTable.rowFilter.visibleToSource(v),b>=e[0]&&b<=e[2]){w=b;break}for(C=S.cloneOverlay instanceof D||S.cloneOverlay instanceof E?S.getSetting("fixedColumnsLeft"):S.wtTable.getColumnStrategy().cellCount,v=0;C>v;v++)if(b=S.wtTable.columnFilter.visibleToSource(v),b>=e[1]&&b<=e[3]){g=b;break}for(v=C-1;v>=0;v--)if(b=S.wtTable.columnFilter.visibleToSource(v),b>=e[1]&&b<=e[3]){y=b;break}if(void 0===m||void 0===g)return void this.disappear();t=m!==w||g!==y,n=S.wtTable.getCell(new f(m,g)),i=t?S.wtTable.getCell(new f(w,y)):n,r=o.Dom.offset(n),s=t?o.Dom.offset(i):r,a=o.Dom.offset(S.wtTable.TABLE),c=r.top,d=s.top+o.Dom.outerHeight(i)-c,u=r.left,p=s.left+o.Dom.outerWidth(i)-u,l=c-a.top-1,h=u-a.left-1;var R=o.Dom.getComputedStyle(n);parseInt(R.borderTopWidth,10)>0&&(l+=1,d=d>0?d-1:0),parseInt(R.borderLeftWidth,10)>0&&(h+=1,p=p>0?p-1:0),this.topStyle.top=l+"px",this.topStyle.left=h+"px",this.topStyle.width=p+"px",this.topStyle.display="block",this.leftStyle.top=l+"px",this.leftStyle.left=h+"px",this.leftStyle.height=d+"px",this.leftStyle.display="block";var T=Math.floor(this.settings.border.width/2);this.bottomStyle.top=l+d-T+"px",this.bottomStyle.left=h+"px",this.bottomStyle.width=p+"px",this.bottomStyle.display="block",this.rightStyle.top=l+"px",this.rightStyle.left=h+p-T+"px",this.rightStyle.height=d+1+"px",this.rightStyle.display="block",this.hasSetting(this.settings.border.cornerVisible)?(this.cornerStyle.top=l+d-4+"px",this.cornerStyle.left=h+p-4+"px",this.cornerStyle.display="block"):this.cornerStyle.display="none"}},d.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none"},d.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},f.prototype.isValid=function(e){return this.row<0||this.col<0?!1:this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns")?!1:!0},f.prototype.isEqual=function(e){return e===this?!0:this.row===e.row&&this.col===e.col},f.prototype.isSouthEastOf=function(e){return this.row>=e.row&&this.col>=e.col},f.prototype.isNorthWestOf=function(e){return this.row<=e.row&&this.col<=e.col},t.WalkontableCellCoords=f,p.prototype.isValid=function(e){return this.from.isValid(e)&&this.to.isValid(e)},p.prototype.isSingle=function(){return this.from.row===this.to.row&&this.from.col===this.to.col},p.prototype.includes=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return t.row<=e.row&&o.row>=e.row&&t.col<=e.col&&o.col>=e.col},p.prototype.includesRange=function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},p.prototype.overlaps=function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},p.prototype.isSouthEastOf=function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},p.prototype.isNorthWestOf=function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},p.prototype.expand=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<t.row||e.col<t.col||e.row>o.row||e.col>o.col?(this.from=new f(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new f(Math.max(o.row,e.row),Math.max(o.col,e.col)),!0):!1},p.prototype.expandByRange=function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=e.getTopLeftCorner(),i=e.getBottomRightCorner(),r=Math.min(t.row,n.row),s=Math.min(t.col,n.col),a=Math.max(o.row,i.row),l=Math.max(o.col,i.col);return this.from=new f(r,s),this.to=new f(a,l),!0},p.prototype.getTopLeftCorner=function(){return new f(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},p.prototype.getBottomRightCorner=function(){return new f(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},p.prototype.getInner=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||o.push(new f(n,i));return o},p.prototype.getAll=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)o.push(e.row===n&&e.col===i?e:t.row===n&&t.col===i?t:new f(n,i));return o},p.prototype.forAll=function(e){for(var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=t.row;n<=o.row;n++)for(var i=t.col;i<=o.col;i++){var r=e(n,i);if(r===!1)return}},t.WalkontableCellRange=p,m.prototype.add=function(e,t,o){this.cache[e]||(this.cache[e]=[]),this.cache[e][t]||(this.cache[e][t]=[]),this.cache[e][t][o]=!0},m.prototype.test=function(e,t,o){return this.cache[e]&&this.cache[e][t]&&this.cache[e][t][o]},g.prototype.visibleToSource=function(e){return e},g.prototype.sourceToVisible=function(e){return e},g.prototype.offsettedTH=function(e){return e-this.countTH},g.prototype.unOffsettedTH=function(e){return e+this.countTH},g.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.visibleToSource(this.offsettedTH(e))},g.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToVisible(e))},w.prototype=new u,w.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)},w.prototype.stretch=function(){var e,t=0;if(e=this.instance.wtTable.allRowsInViewport()?this.getContainerSize():this.getContainerSize(1/0),this.remainingSize=this.cellSizesSum-e,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var o,n=e/this.cellSizesSum;t<this.cellCount-1;)o=Math.floor(n*this.cellSizes[t]),this.remainingSize+=o-this.cellSizes[t],this.cellStretch[t]=o-this.cellSizes[t],t++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&1/0!==e&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},w.prototype.countVisible=function(){return this.visibleCellCount},w.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getFirstVisibleRow(),t=this.instance.wtTable.getLastVisibleColumn(),n=this.instance.wtTable.getCell(new f(e,t)),i=o.Dom.offset(n),r=o.Dom.outerWidth(n),s=i.left+r,a=this.instance.wtScrollbars.vertical.getScrollPosition(),l=this.instance.wtViewport.getViewportWidth(),c=a+l;return c>=s},y.prototype.draw=function(e){if(this.drawInterrupted=!1,!e&&!o.Dom.isVisible(this.wtTable.TABLE))return void(this.drawInterrupted=!0);e=e&&this.getSetting("offsetRow")===this.lastOffsetRow,this.lastOffsetRow=this.getSetting("offsetRow");var t=this.getSetting("totalRows");return this.lastOffsetRow>t&&t>0&&(this.scrollVertical(-1/0),this.scrollViewport(new f(t-1,0))),this.wtTable.draw(e),this},y.prototype.update=function(e,t){return this.wtSettings.update(e,t)},y.prototype.scrollVertical=function(e){var t=this.wtScroll.scrollVertical(e);return this.getSetting("onScrollVertically"),t},y.prototype.scrollHorizontal=function(e){var t=this.wtScroll.scrollHorizontal(e);return this.getSetting("onScrollHorizontally"),t},y.prototype.scrollViewport=function(e){return this.wtScroll.scrollViewport(e),this},y.prototype.getViewport=function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},y.prototype.getSetting=function(e,t,o,n,i){return this.wtSettings.getSetting(e,t,o,n,i)},y.prototype.hasSetting=function(e){return this.wtSettings.has(e)},y.prototype.generateSelections=function(e){for(var t=[],o=0,n=e.length;n>o;o++){var i=new x(this,e[o]);t.push(i),i.settings.className&&(t[i.settings.className]=i)}return t},y.prototype.generateSelectionClones=function(e){for(var t=[],o=0,n=e.length;n>o;o++){var i=e[o].makeClone(this);t.push(i),i.settings.className&&(t[i.settings.className]=i)}return t},y.prototype.destroy=function(){e(t).off("."+this.guid),e(document.body).off("."+this.guid),this.wtScrollbars.destroy(),this.wtEvent&&this.wtEvent.destroy()},v.prototype=new h,v.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.instance.wtTable.holder.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px",e.style.left=Math.ceil(t.left,10)+"px"}},v.prototype.getScrollPosition=function(){},v.prototype.getLastCell=function(){},v.prototype.applyToDOM=function(){},v.prototype.scrollTo=function(){},v.prototype.readWindowSize=function(){},v.prototype.readSettings=function(){},v.prototype.destroy=function(){h.prototype.destroy.call(this),clearTimeout(this.lastTimeout)},C.prototype.parentCell=function(e){var t={},n=this.instance.wtTable.TABLE,i=o.Dom.closest(e,["TD","TH"],n);return i&&o.Dom.isChildOf(i,n)?(t.coords=this.instance.wtTable.getCoords(i),t.TD=i):o.Dom.hasClass(e,"wtBorder")&&o.Dom.hasClass(e,"current")&&(t.coords=this.instance.selections.current.cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)),t},C.prototype.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1])},t.requestAnimFrame=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return t.setTimeout(e,1e3/60)}}(),t.cancelRequestAnimFrame=function(){return t.cancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||clearTimeout}(),t.getComputedStyle||!function(){var e,o={getPropertyValue:function(t){return"float"==t&&(t="styleFloat"),e.currentStyle[t.toUpperCase()]||null}};t.getComputedStyle=function(t){return e=t,o}}(),!String.prototype.trim){var Q=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(Q,"")}}S.prototype.offsetted=function(e){return e+this.offset},S.prototype.unOffsetted=function(e){return e-this.offset},S.prototype.visibleToSource=function(e){return this.offsetted(e)},S.prototype.sourceToVisible=function(e){return this.unOffsetted(e)},S.prototype.offsettedTH=function(e){return e-this.countTH},S.prototype.visibleColHeadedRowToSourceRow=function(e){return this.visibleToSource(this.offsettedTH(e))},S.prototype.sourceRowToVisibleColHeadedRow=function(e){return this.unOffsettedTH(this.sourceToVisible(e))},R.prototype=new u,R.prototype.add=function(e,t){if(!this.canRenderMoreRows())return!1;var o=this.sizeAtIndex(e,t);if(void 0===o)return!1;var n=this.getContainerSize(this.cellSizesSum+o);return this.cellSizes.push(o),this.cellSizesSum+=o,this.cellCount++,this.remainingSize=this.cellSizesSum-n,this.remainingSize<=o&&this.visiblCellCount++,!0},R.prototype.canRenderMoreRows=function(){return this.remainingSize<=0||this.cellCount-this.visiblCellCount<this.curOuts},R.prototype.remove=function(){var e=this.cellSizes.pop();this.cellSizesSum-=e,this.cellCount--,this.remainingSize-=e},R.prototype.removeOutstanding=function(){for(;this.cellCount-this.visiblCellCount>this.curOuts;)this.remove()},R.prototype.countRendered=function(){return this.cellCount},R.prototype.countVisible=function(){return this.visiblCellCount},R.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getLastVisibleRow(),t=this.instance.wtTable.getFirstVisibleColumn(),n=this.instance.wtTable.getCell(new f(e,t)),i=o.Dom.offset(n).top,r=o.Dom.outerHeight(n),s=i+r,a=this.instance.wtScrollbars.horizontal.scrollHandler.offsetTop+this.instance.wtScrollbars.vertical.getScrollPosition(),l=this.instance.wtViewport.getViewportHeight(),c=a+l;return s>c},T.prototype.scrollVertical=function(e){if(!this.instance.drawn)throw new Error("scrollVertical can only be called after table was drawn to DOM");var t,o=this.instance,n=o.getSetting("offsetRow"),i=o.getSetting("fixedRowsTop"),r=o.getSetting("totalRows"),s=o.wtViewport.getViewportHeight();return t=r>0&&!this.instance.wtTable.isLastRowFullyVisible()?this.scrollLogicVertical(e,n,r,i,s,function(e){return i>e-n&&e-n>=0?o.getSetting("rowHeight",e-n):o.getSetting("rowHeight",e)}):0,t!==n&&this.instance.wtScrollbars.vertical.scrollTo(t),o},T.prototype.scrollHorizontal=function(e){return this.instance.wtScrollbars.horizontal.scrollTo(e),this.instance},T.prototype.scrollLogicVertical=function(e,t,o,n){var i=t+e;return i>=o-n&&(i=o-n-1),0>i&&(i=0),i},T.prototype.scrollViewport=function(e){if(this.instance.drawn){var t=(this.instance.getSetting("offsetRow"),this.instance.getSetting("totalRows")),o=this.instance.getSetting("totalColumns");if(e.row<0||e.row>t-1)throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>o-1)throw new Error("column "+e.col+" does not exist");var n=this.instance.wtTable.getCell(e);"object"==typeof n?e.col>=this.instance.getSetting("fixedColumnsLeft")&&this.scrollToRenderedCell(n):e.row>=this.instance.wtTable.getLastVisibleRow()?(this.scrollVertical(e.row-this.instance.wtTable.getLastVisibleRow()),e.row==this.instance.wtTable.getLastVisibleRow()&&this.instance.wtTable.getRowStrategy().isLastIncomplete()&&this.scrollViewport(e)):e.row>=this.instance.getSetting("fixedRowsTop")&&this.scrollVertical(e.row-this.instance.wtTable.getFirstVisibleRow())}},T.prototype.scrollToRenderedCell=function(e){var n=o.Dom.offset(e),i=o.Dom.outerWidth(e),r=o.Dom.outerHeight(e),s=o.Dom.offset(this.instance.wtTable.TABLE),a={left:this.instance.wtScrollbars.horizontal.getScrollPosition(),top:this.instance.wtScrollbars.vertical.getScrollPosition()},l=this.instance.wtViewport.getWorkspaceWidth(),c=this.instance.wtViewport.getWorkspaceHeight(),h=o.Dom.outerWidth(this.instance.wtScrollbars.horizontal.clone.wtTable.TABLE),u=o.Dom.outerHeight(this.instance.wtScrollbars.vertical.clone.wtTable.TABLE);if(this.instance.wtScrollbars.horizontal.scrollHandler!==t&&(s.left=0,n.left-=o.Dom.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left),this.instance.wtScrollbars.vertical.scrollHandler!==t&&(s.top=0,n.top=n.top-o.Dom.offset(this.instance.wtScrollbars.vertical.scrollHandler).top),l>i)if(n.left<a.left+h)this.instance.wtScrollbars.horizontal.setScrollPosition(n.left-h);else if(n.left+i>s.left+a.left+l){var d=n.left+i-(s.left+a.left+l);this.instance.wtScrollbars.horizontal.setScrollPosition(a.left+d)}c>r&&(n.top<a.top+u?(this.instance.wtScrollbars.vertical.setScrollPosition(n.top-u),this.instance.wtScrollbars.vertical.onScroll()):n.top+r>a.top+c&&(this.instance.wtScrollbars.vertical.setScrollPosition(n.top-c+r),this.instance.wtScrollbars.vertical.onScroll()))},E.prototype=new h,E.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===t){var n=this.instance.wtTable.holder.getBoundingClientRect(),i=Math.ceil(n.top),r=Math.ceil(n.left);e.style.left=0>r?-r+"px":"0",e.style.top=0>i?-i+"px":"0"}else e.style.top=this.instance.wtScrollbars.vertical.windowScrollPosition+"px",e.style.left=this.instance.wtScrollbars.horizontal.windowScrollPosition+"px";e.style.width=o.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px",e.style.height=o.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},E.prototype.refresh=function(e){h.prototype.refresh.call(this,e)},E.prototype.getScrollPosition=function(){},E.prototype.getLastCell=function(){},E.prototype.applyToDOM=function(){},E.prototype.scrollTo=function(){},E.prototype.readWindowSize=function(){},E.prototype.readSettings=function(){},D.prototype=new h,D.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===t){var n=this.instance.wtTable.holder.getBoundingClientRect(),i=Math.ceil(n.left);e.style.left=0>i?-i+"px":"0",e.style.top=this.instance.wtTable.hider.style.top}else e.style.top=this.instance.wtTable.hider.style.top,e.style.left=this.windowScrollPosition+"px";e.style.height=o.Dom.outerHeight(this.clone.wtTable.TABLE)+"px",e.style.width=o.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},D.prototype.refresh=function(e){h.prototype.refresh.call(this,e)},D.prototype.getScrollPosition=function(){return o.Dom.getScrollLeft(this.scrollHandler)},D.prototype.setScrollPosition=function(e){this.scrollHandler===t?t.scrollTo(e,o.Dom.getWindowScrollTop()):this.scrollHandler.scrollLeft=e},D.prototype.onScroll=function(){h.prototype.onScroll.call(this),this.instance.getSetting("onScrollHorizontally")},D.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()},D.prototype.applyToDOM=function(){this.readWindowSize()},D.prototype.scrollTo=function(e){this.setScrollPosition(this.tableParentOffset+e*this.cellSize)},D.prototype.readWindowSize=function(){this.scrollHandler===t?(this.windowSize=document.documentElement.clientWidth,this.tableParentOffset=this.instance.wtTable.holderOffset.left):(this.windowSize=this.scrollHandler.clientWidth,this.tableParentOffset=0),this.windowScrollPosition=this.getScrollPosition()},D.prototype.readSettings=function(){this.readWindowSize(),this.total=this.instance.getSetting("totalColumns")},k.prototype=new h,k.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===t){var n=this.instance.wtTable.holder.getBoundingClientRect(),i=Math.ceil(n.top);e.style.left="0",e.style.top=0>i?-i+"px":"0"}else e.style.top=this.windowScrollPosition+"px",e.style.left="0";e.style.width=this.instance.wtScrollbars.horizontal.scrollHandler===t?this.instance.wtViewport.getWorkspaceActualWidth()+"px":o.Dom.outerWidth(this.clone.wtTable.TABLE)+"px",e.style.height=o.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},k.prototype.getScrollPosition=function(){return o.Dom.getScrollTop(this.scrollHandler)},k.prototype.setScrollPosition=function(e){this.scrollHandler===t?t.scrollTo(o.Dom.getWindowScrollLeft(),e):this.scrollHandler.scrollTop=e},k.prototype.onScroll=function(){h.prototype.onScroll.call(this),this.instance.draw(!0),this.instance.getSetting("onScrollVertically")},k.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1},k.prototype.sumCellSizes=function(e,t){for(var o=0;t>e;)o+=this.instance.wtSettings.settings.rowHeight(e)||this.instance.wtSettings.settings.defaultRowHeight,e++;return o},k.prototype.refresh=function(e){this.applyToDOM(),h.prototype.refresh.call(this,e)},k.prototype.applyToDOM=function(){var e=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset),this.measureAfter=-1===e?0:this.sumCellSizes(e,this.total-e);var t=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=t+this.sumCellSizes(0,this.total)+4+"px",this.fixed.style.top=this.measureBefore+"px",this.fixed.style.bottom=""},k.prototype.scrollTo=function(e){var t=this.tableParentOffset+e*this.cellSize;this.setScrollPosition(t),this.onScroll()},k.prototype.readWindowSize=function(){if(this.scrollHandler===t)this.windowSize=document.documentElement.clientHeight,this.tableParentOffset=this.instance.wtTable.holderOffset.top;
else{var e=o.Dom.outerHeight(this.scrollHandler);this.windowSize=e>0&&this.scrollHandler.clientHeight>0?this.scrollHandler.clientHeight:1/0,this.tableParentOffset=0}this.windowScrollPosition=this.getScrollPosition()},k.prototype.readSettings=function(){this.readWindowSize(),this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows");for(var e,t=this.windowScrollPosition-this.tableParentOffset,o=0,n=0;n<this.total&&(e=this.instance.getSetting("rowHeight",n)||this.instance.wtSettings.settings.defaultRowHeight,o+=e,!(o-1>t));n++);this.offset=Math.min(n,this.total),this.instance.update("offsetRow",this.offset)},A.prototype.registerListeners=function(){function o(){if(a.instance.drawn){if(!a.instance.wtTable.holder.parentNode)return void a.destroy();a.vertical.windowScrollPosition=a.vertical.getScrollPosition(),a.horizontal.windowScrollPosition=a.horizontal.getScrollPosition(),a.box=a.instance.wtTable.hider.getBoundingClientRect(),(a.vertical.windowScrollPosition!==n||a.horizontal.windowScrollPosition!==i||a.box.top!==r||a.box.left!==s)&&(a.vertical.onScroll(),a.horizontal.onScroll(),a.corner.onScroll(),n=a.vertical.windowScrollPosition,i=a.horizontal.windowScrollPosition,r=a.box.top,s=a.box.left)}}var n,i,r,s,a=this,l=e(t);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,o),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,o),this.vertical.scrollHandler!==t&&this.horizontal.scrollHandler!==t&&l.on("scroll."+this.instance.guid,o)},A.prototype.destroy=function(){this.vertical&&(this.vertical.destroy(),this.vertical.$scrollHandler.off("scroll."+this.instance.guid)),this.horizontal&&(this.horizontal.destroy(),this.vertical.$scrollHandler.off("scroll."+this.instance.guid)),e(t).off("scroll."+this.instance.guid),this.corner&&this.corner.destroy(),this.debug&&this.debug.destroy()},A.prototype.refresh=function(e){this.horizontal&&this.horizontal.readSettings(),this.vertical&&this.vertical.readSettings(),this.horizontal&&this.horizontal.refresh(e),this.vertical&&this.vertical.refresh(e),this.corner&&this.corner.refresh(e),this.debug&&this.debug.refresh(e)},A.prototype.applyToDOM=function(){this.horizontal&&this.horizontal.applyToDOM(),this.vertical&&this.vertical.applyToDOM(),this.corner&&this.corner.applyToDOM(),this.debug&&this.debug.applyToDOM()},x.prototype.isEmpty=function(){return null===this.cellRange},x.prototype.add=function(e){this.isEmpty()?this.cellRange=new p(e,e,e):this.cellRange.expand(e)},x.prototype.replace=function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},x.prototype.clear=function(){this.cellRange=null},x.prototype.getCorners=function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},x.prototype.draw=function(){var e,t,o,n,i,r=this.instance,s=r.wtTable.getRowStrategy().countVisible(),a=r.wtTable.getColumnStrategy().cellCount;if(this.isEmpty())this.border&&this.border.disappear();else{for(e=this.getCorners(),t=0;s>t;t++)for(o=0;a>o;o++)n=r.wtTable.rowFilter.visibleToSource(t),i=r.wtTable.columnFilter.visibleToSource(o),n>=e[0]&&n<=e[2]&&i>=e[1]&&i<=e[3]?this.settings.className&&r.wtTable.currentCellCache.add(t,o,this.settings.className):n>=e[0]&&n<=e[2]?(r.wtTable.currentCellCache.add(t,o,this.settings.highlightRowClassName),r.wtTable.currentCellCache.add(t,a,this.settings.highlightRowClassName)):i>=e[1]&&i<=e[3]&&(r.wtTable.currentCellCache.add(t,o,this.settings.highlightColumnClassName),r.wtTable.currentCellCache.add(s,o,this.settings.highlightColumnClassName));this.border&&this.border.appear(e)}},x.prototype.makeClone=function(e){function t(){}t.prototype=this;var o=new t;return o.instance=e,o.border&&(o.border=new d(e,o.settings)),o},H.prototype.update=function(e,t){if(void 0===t)for(var o in e)e.hasOwnProperty(o)&&(this.settings[o]=e[o]);else this.settings[e]=t;return this.instance},H.prototype.getSetting=function(e,t,o,n,i){return"function"==typeof this.settings[e]?this.settings[e](t,o,n,i):void 0!==t&&"[object Array]"===Object.prototype.toString.call(this.settings[e])?this.settings[e][t]:this.settings[e]},H.prototype.has=function(e){return!!this.settings[e]},O.prototype.getRowStrategy=function(){return this.isWorkingOnClone()?this.instance.cloneSource.wtTable.rowStrategy:this.rowStrategy},O.prototype.getColumnStrategy=function(){return this.isWorkingOnClone()?this.instance.cloneSource.wtTable.columnStrategy:this.columnStrategy},O.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource},O.prototype.refreshHiderDimensions=function(){var e=this.spreader.style;e.position="relative",e.width="auto",e.height="auto"},O.prototype.draw=function(e){if(e)this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:(this.holderOffset=o.Dom.offset(this.holder),this.tableOffset=o.Dom.offset(this.TABLE),this.instance.wtScrollbars.vertical.readSettings(),this.instance.wtScrollbars.horizontal.readSettings(),this.instance.wtViewport.resetSettings());var t;t=this.instance.cloneOverlay instanceof v||this.instance.cloneOverlay instanceof k||this.instance.cloneOverlay instanceof E?0:this.instance.wtSettings.settings.offsetRow,this.rowFilter=new S(t,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new g(this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw()}return this.refreshPositions(e),e||this.isWorkingOnClone()||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition(),this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition()),this.instance.drawn=!0,this},O.prototype._doDraw=function(){var e=new P(this);e.render()},O.prototype.refreshPositions=function(e){this.refreshHiderDimensions(),this.refreshSelections(e)},O.prototype.refreshSelections=function(e){var t,n,i,r,s,a,l,c=[],h=this.getRowStrategy().countVisible(),u=this.getColumnStrategy().cellCount;if(this.oldCellCache=this.currentCellCache,this.currentCellCache=new m,this.instance.selections)for(var d=0,p=this.instance.selections.length;p>d;d++)this.instance.selections[d].draw(),this.instance.selections[d].settings.className&&c.push(this.instance.selections[d].settings.className),this.instance.selections[d].settings.highlightRowClassName&&c.push(this.instance.selections[d].settings.highlightRowClassName),this.instance.selections[d].settings.highlightColumnClassName&&c.push(this.instance.selections[d].settings.highlightColumnClassName);for(a=c.length,t=0;h>t;t++)for(i=0;u>i;i++)for(n=this.rowFilter.visibleToSource(t),r=this.columnFilter.visibleToSource(i),s=0;a>s;s++){var g;this.currentCellCache.test(t,i,c[s])?(g=this.getCell(new f(n,r)),"object"==typeof g&&o.Dom.addClass(g,c[s])):e&&this.oldCellCache.test(t,i,c[s])&&(g=this.getCell(new f(n,r)),"object"==typeof g&&o.Dom.removeClass(g,c[s])),l=this.currentCellCache.cache?h:0,g=this.getColumnHeader(i),this.currentCellCache.test(l,i,c[s])?"object"==typeof g&&o.Dom.addClass(g,c[s]):"object"==typeof g&&o.Dom.removeClass(g,c[s]),l=this.currentCellCache.cache[t]?u:0,g=-1!=this.getRowHeader(t)?this.getRowHeader(t):void 0,this.currentCellCache.test(t,l,c[s])?"object"==typeof g&&o.Dom.addClass(g,c[s]):"object"==typeof g&&o.Dom.removeClass(g,c[s])}},O.prototype.getCell=function(e){if(this.isRowBeforeViewport(e.row))return-1;if(this.isRowAfterViewport(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToVisible(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},O.prototype.getColumnHeader=function(e){var t=this.THEAD.childNodes[0];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:void 0},O.prototype.getRowHeader=function(e){if(0==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return-1;var t=this.TBODY.childNodes[this.rowFilter.sourceToVisible(e)];return t?t.childNodes[0]:void 0},O.prototype.getCoords=function(e){var t=e.parentNode,n=o.Dom.index(t);return n=t.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.visibleToSource(n),new f(n,this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))},O.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToVisible(e)]},O.prototype.getFirstVisibleRow=function(){return this.rowFilter.visibleToSource(0)},O.prototype.getFirstVisibleColumn=function(){if(this.isWorkingOnClone())return this.instance.cloneOverlay instanceof D||this.instance.cloneOverlay instanceof E?0:this.instance.cloneSource.wtTable.getFirstVisibleColumn();var e=this.instance.wtScrollbars.horizontal.getScrollPosition(),t=this.getColumnStrategy().cellCount,o=this.TBODY.firstChild;if(!o)return 0;for(var n=0;t>n;n++)if(e-=o.childNodes[n].offsetWidth,0>e)return n;return-1},O.prototype.getLastVisibleRow=function(){var e=this.rowFilter.visibleToSource(this.getRowStrategy().countVisible()-1),t=this.instance;if(t.cloneOverlay instanceof k||t.cloneOverlay instanceof E){var o=this.instance.getSetting("fixedRowsTop");return Math.min(o-1,e)}return e},O.prototype.getLastVisibleColumn=function(){var e=this.instance;if(this.isWorkingOnClone()){if(e.cloneOverlay instanceof D||e.cloneOverlay instanceof E){var t=this.getColumnStrategy().countVisible()-1,o=e.getSetting("fixedColumnsLeft");return Math.min(o-1,t)}return this.instance.cloneSource.wtTable.getLastVisibleColumn()}var n=this.instance.wtScrollbars.horizontal.getScrollPosition(),i=n+this.instance.wtViewport.getWorkspaceWidth(1/0),r=this.getColumnStrategy().cellCount,s=this.instance.getSetting("rowHeaders").length||0,a=this.TBODY.firstChild;if(!r)return-1;for(var l=0;r+s>l;l++)if(i-=a.childNodes[l].offsetWidth,0>=i)return l-s;return l-s-1},O.prototype.isRowBeforeViewport=function(e){return this.rowFilter.sourceToVisible(e)<0&&e>=0},O.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},O.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToVisible(e)<0&&e>=0},O.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},O.prototype.isRowInViewport=function(e){return!this.isRowBeforeViewport(e)&&!this.isRowAfterViewport(e)},O.prototype.isColumnInViewport=function(e){return!this.isColumnBeforeViewport(e)&&!this.isColumnAfterViewport(e)},O.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.getRowStrategy().isLastIncomplete()},O.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.getColumnStrategy().isLastIncomplete()},O.prototype.getVisibleRowsCount=function(){return this.getRowStrategy().countVisible()},O.prototype.allRowsInViewport=function(){return this.getRowStrategy().cellCount==this.getVisibleRowsCount()},P.prototype.render=function(){this.wtTable.isWorkingOnClone()||this.instance.getSetting("beforeDraw",!0),this.rowHeaders=this.instance.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.instance.getSetting("fixedRowsTop"),this.columnHeaders=this.instance.getSetting("columnHeaders");var e,t,o,n=this.instance.getSetting("totalRows"),i=this.instance.getSetting("totalColumns"),r=!1;if(i>0){var s;this.wtTable.isWorkingOnClone()&&(this.instance.cloneOverlay instanceof k||this.instance.cloneOverlay instanceof E?s=this.fixedRowsTop:this.instance.cloneOverlay instanceof D&&(s=this.wtTable.getRowStrategy().cellCount)),this.adjustAvailableNodes(),r=!0,this.renderColGroups(),this.renderColumnHeaders(),t=this.getColumnCount(),this.renderRows(n,s,t),this.wtTable.isWorkingOnClone()||(o=this.instance.wtViewport.getWorkspaceWidth(),this.instance.wtViewport.containerWidth=null,this.wtTable.getColumnStrategy().stretch()),this.adjustColumnWidths(t)}if(r||this.adjustAvailableNodes(),this.instance.cloneOverlay instanceof v||this.removeRedundantRows(),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.instance.wtScrollbars.applyToDOM(),o!==this.instance.wtViewport.getWorkspaceWidth()){this.instance.wtViewport.containerWidth=null,this.wtTable.getColumnStrategy().stretch();var a=this.instance.wtTable.columnWidthCache;for(e=0;e<this.wtTable.getColumnStrategy().cellCount;e++){var l=this.wtTable.getColumnStrategy().getSize(e);this.COLGROUP.childNodes[e+this.rowHeaderCount].style.width=l+"px",a[e]=l}}this.instance.wtScrollbars.refresh(!1),this.instance.getSetting("onDraw",!0)}},P.prototype.removeRedundantRows=function(){for(var e=this.wtTable.getRowStrategy().countRendered();this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},P.prototype.renderRows=function(e,t,o){for(var n,i,r,s=this.instance.getSetting("offsetRow"),a=0,l=this.rowFilter.visibleToSource(a),c=this.wtTable.isWorkingOnClone();e>l&&l>=0;){if(a>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==t&&a===t)break;if(i=this.getOrCreateTrForRow(a,i),this.renderRowHeaders(l,i),this.adjustColumns(i,o+this.rowHeaderCount),n=this.renderCells(l,i,o),s=this.instance.getSetting("offsetRow"),!c){if(r=this.wtTable.getRowStrategy().add(a,n),r===!1)break;0==a&&this.instance.wtScrollbars.vertical.readWindowSize(),this.resetOversizedRow(l)}if(i.firstChild){var h=this.instance.getSetting("rowHeight",l);i.firstChild.style.height=h?h+"px":""}a++,l=this.rowFilter.visibleToSource(a)}},P.prototype.resetOversizedRow=function(e){this.instance.wtTable.oversizedRows&&this.instance.wtTable.oversizedRows[e]&&(this.instance.wtTable.oversizedRows[e]=void 0)},P.prototype.markOversizedRows=function(){for(var e,t,n,i,r=this.instance.wtTable.TBODY.childNodes.length;r;)r--,n=this.instance.wtTable.rowFilter.visibleToSource(r),e=this.instance.wtSettings.settings.rowHeight(n),i=this.instance.wtTable.getTrForRow(n),t=o.Dom.innerHeight(i)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<t||t>e)&&(this.instance.wtTable.oversizedRows||(this.instance.wtTable.oversizedRows={}),this.instance.wtTable.oversizedRows[n]=t)},P.prototype.renderCells=function(e,t,o){for(var n,i,r=0;o>r;r++)i=this.columnFilter.visibleToSource(r),n=0===r?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]:n.nextSibling,"TH"==n.nodeName&&(n=this.utils.replaceThWithTd(n,t)),n.className="",n.removeAttribute("style"),this.instance.getSetting("cellRenderer",e,i,n);return n},P.prototype.adjustColumnWidths=function(e){for(var t,o=this.instance.wtTable.columnWidthCache,n=!1,i=0;e>i;i++)t=this.wtTable.isWorkingOnClone()?this.instance.cloneSource.wtTable.columnWidthCache[i]:this.wtTable.getColumnStrategy().getSize(i),t!==o[i]&&(this.COLGROUP.childNodes[i+this.rowHeaderCount].style.width=t+"px",o[i]=t,n=!0)},P.prototype.appendToTbody=function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},P.prototype.getOrCreateTrForRow=function(e,t){var o;return e>=this.wtTable.tbodyChildrenLength?(o=this.createRow(),this.appendToTbody(o)):o=0===e?this.TBODY.firstChild:t.nextSibling,o},P.prototype.createRow=function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},P.prototype.renderRowHeader=function(e,t,o){this.rowHeaders[t](e,o)},P.prototype.renderRowHeaders=function(e,t){for(var o=t.firstChild,n=0;n<this.rowHeaderCount;n++)o?"TD"==o.nodeName&&(o=this.utils.replaceTdWithTh(o,t)):(o=document.createElement("TH"),t.appendChild(o)),this.renderRowHeader(e,n,o),o=o.nextSibling},P.prototype.adjustAvailableNodes=function(){this.refreshStretching(),this.adjustColGroups(),this.adjustThead()},P.prototype.renderColumnHeaders=function(){if(this.columnHeaders.length)for(var e=this.getColumnCount(),t=this.getTrForColumnHeaders(),o=0;e>o;o++)this.columnHeaders.length&&this.renderColumnHeader(this.columnFilter.visibleToSource(o),t.childNodes[this.rowHeaderCount+o])},P.prototype.adjustColGroups=function(){for(var e=this.getColumnCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--,this.wtTable.columnWidthCache&&this.wtTable.columnWidthCache.splice(-1,1)},P.prototype.adjustThead=function(){var e=this.getColumnCount(),t=this.THEAD.firstChild;if(this.columnHeaders.length){for(t||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)t.removeChild(t.lastChild),this.theadChildrenLength--}else t&&o.Dom.empty(t)},P.prototype.getTrForColumnHeaders=function(){var e=this.THEAD.firstChild;return this.rowHeaderCount&&this.renderRowHeaders(-1,e),e},P.prototype.renderColumnHeader=function(e,t){return this.columnHeaders[0](e,t)},P.prototype.getColumnCount=function(){return this.wtTable.isWorkingOnClone()&&(this.instance.cloneOverlay instanceof D||this.instance.cloneOverlay instanceof E)?this.instance.getSetting("fixedColumnsLeft"):this.wtTable.getColumnStrategy().cellCount},P.prototype.renderColGroups=function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++)e<this.rowHeaderCount?o.Dom.addClass(this.COLGROUP.childNodes[e],"rowHeader"):o.Dom.removeClass(this.COLGROUP.childNodes[e],"rowHeader")},P.prototype.adjustColumns=function(e,t){for(var o=e.childNodes.length;t>o;){var n=document.createElement("TD");e.appendChild(n),o++}for(;o>t;)e.removeChild(e.lastChild),o--},P.prototype.refreshStretching=function(){if(!this.wtTable.isWorkingOnClone()){var e=this.instance,t=e.getSetting("stretchH"),o=(e.getSetting("totalRows"),e.getSetting("totalColumns")),n=function(e){var t=i.instance.wtViewport.getViewportWidth(e);return t},i=this,r=function(t){var n=i.columnFilter.visibleToSource(t);return o>n?e.getSetting("columnWidth",n):void 0},s=function(t){return i.instance.cloneOverlay instanceof v||e.wtSettings.settings.renderAllRows?1/0:i.instance.wtViewport.getViewportHeight(t)},a=function(){return e.wtSettings.settings.defaultRowHeight};this.wtTable.columnStrategy=new w(e,n,r,t),this.wtTable.rowStrategy=new R(e,s,a)}},P.utils={},P.utils.replaceTdWithTh=function(e,t){var o;return o=document.createElement("TH"),t.insertBefore(o,e),t.removeChild(e),o},P.utils.replaceThWithTd=function(e,t){var o=document.createElement("TD");return t.insertBefore(o,e),t.removeChild(e),o},M.prototype.getWorkspaceHeight=function(){return this.instance.wtScrollbars.vertical.windowSize},M.prototype.getWorkspaceWidth=function(){var e=Math.min(this.getContainerFillWidth(),document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth),n=this.instance.wtScrollbars.horizontal.scrollHandler!=t?this.instance.wtScrollbars.horizontal.scrollHandler.style.overflow:null;return("scroll"==n||"hidden"==n||"auto"==n)&&(n="scroll"),e="scroll"==n?Math.max(e,this.instance.wtScrollbars.horizontal.windowSize):Math.max(e,o.Dom.outerWidth(this.instance.wtTable.TABLE))},M.prototype.getContainerFillWidth=function(){if(this.containerWidth)return this.containerWidth;for(var e,t,o=this.instance.wtTable.holder;o.parentNode!=document.body&&null!=o.parentNode&&-1===o.className.indexOf("handsontable");)o=o.parentNode;return t=document.createElement("DIV"),t.style.width="100%",t.style.height="1px",o.appendChild(t),e=t.offsetWidth,this.containerWidth=e,o.removeChild(t),e},M.prototype.getWorkspaceOffset=function(){return o.Dom.offset(this.instance.wtTable.TABLE)},M.prototype.getWorkspaceActualHeight=function(){return o.Dom.outerHeight(this.instance.wtTable.TABLE)},M.prototype.getWorkspaceActualWidth=function(){return o.Dom.outerWidth(this.instance.wtTable.TABLE)||o.Dom.outerWidth(this.instance.wtTable.TBODY)||o.Dom.outerWidth(this.instance.wtTable.THEAD)},M.prototype.getColumnHeaderHeight=function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=o.Dom.outerHeight(this.instance.wtTable.THEAD)),this.columnHeaderHeight},M.prototype.getViewportHeight=function(e){var t=this.getWorkspaceHeight(e);if(1/0===t)return t;var o=this.getColumnHeaderHeight();return o>0&&(t-=o),t},M.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var t=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,i=e.length;i>n;n++)t?(this.rowHeaderWidth+=o.Dom.outerWidth(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},M.prototype.getViewportWidth=function(e){var t=this.getWorkspaceWidth(e);if(1/0===t)return t;var o=this.getRowHeaderWidth();return o>0?t-o:t},M.prototype.resetSettings=function(){this.rowHeaderWidth=0/0,this.columnHeaderHeight=0/0}}(jQuery,window,Handsontable);
!function(){function t(n,t){function r(t){var r,e=n.arcs[0>t?~t:t],o=e[0];return n.transform?(r=[0,0],e.forEach(function(n){r[0]+=n[0],r[1]+=n[1]})):r=e[e.length-1],0>t?[r,o]:[o,r]}function e(n,t){for(var r in n){var e=n[r];delete t[e.start],delete e.start,delete e.end,e.forEach(function(n){o[0>n?~n:n]=1}),f.push(e)}}var o={},i={},u={},f=[],c=-1;return t.forEach(function(r,e){var o,i=n.arcs[0>r?~r:r];i.length<3&&!i[1][0]&&!i[1][1]&&(o=t[++c],t[c]=r,t[e]=o)}),t.forEach(function(n){var t,e,o=r(n),f=o[0],c=o[1];if(t=u[f])if(delete u[t.end],t.push(n),t.end=c,e=i[c]){delete i[e.start];var a=e===t?t:t.concat(e);i[a.start=t.start]=u[a.end=e.end]=a}else i[t.start]=u[t.end]=t;else if(t=i[c])if(delete i[t.start],t.unshift(n),t.start=f,e=u[f]){delete u[e.end];var s=e===t?t:e.concat(t);i[s.start=e.start]=u[s.end=t.end]=s}else i[t.start]=u[t.end]=t;else t=[n],i[t.start=f]=u[t.end=c]=t}),e(u,i),e(i,u),t.forEach(function(n){o[0>n?~n:n]||f.push([n])}),f}function r(n,r,e){function o(n){var t=0>n?~n:n;(s[t]||(s[t]=[])).push({i:n,g:a})}function i(n){n.forEach(o)}function u(n){n.forEach(i)}function f(n){"GeometryCollection"===n.type?n.geometries.forEach(f):n.type in l&&(a=n,l[n.type](n.arcs))}var c=[];if(arguments.length>1){var a,s=[],l={LineString:i,MultiLineString:u,Polygon:u,MultiPolygon:function(n){n.forEach(u)}};f(r),s.forEach(arguments.length<3?function(n){c.push(n[0].i)}:function(n){e(n[0].g,n[n.length-1].g)&&c.push(n[0].i)})}else for(var h=0,p=n.arcs.length;p>h;++h)c.push(h);return{type:"MultiLineString",arcs:t(n,c)}}function e(r,e){function o(n){n.forEach(function(t){t.forEach(function(t){(f[t=0>t?~t:t]||(f[t]=[])).push(n)})}),c.push(n)}function i(n){return l(u(r,{type:"Polygon",arcs:[n]}).coordinates[0])>0}var f={},c=[],a=[];return e.forEach(function(n){"Polygon"===n.type?o(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(o)}),c.forEach(function(n){if(!n._){var t=[],r=[n];for(n._=1,a.push(t);n=r.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){f[0>n?~n:n].forEach(function(n){n._||(n._=1,r.push(n))})})})}}),c.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:a.map(function(e){var o=[];if(e.forEach(function(n){n.forEach(function(n){n.forEach(function(n){f[0>n?~n:n].length<2&&o.push(n)})})}),o=t(r,o),(n=o.length)>1)for(var u,c=i(e[0][0]),a=0;n>a;++a)if(c===i(o[a])){u=o[0],o[0]=o[a],o[a]=u;break}return o})}}function o(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(n,t)})}:i(n,t)}function i(n,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:u(n,t)};return null==t.id&&delete r.id,r}function u(n,t){function r(n,t){t.length&&t.pop();for(var r,e=s[0>n?~n:n],o=0,i=e.length;i>o;++o)t.push(r=e[o].slice()),a(r,o);0>n&&f(t,i)}function e(n){return n=n.slice(),a(n,0),n}function o(n){for(var t=[],e=0,o=n.length;o>e;++e)r(n[e],t);return t.length<2&&t.push(t[0].slice()),t}function i(n){for(var t=o(n);t.length<4;)t.push(t[0].slice());return t}function u(n){return n.map(i)}function c(n){var t=n.type;return"GeometryCollection"===t?{type:t,geometries:n.geometries.map(c)}:t in l?{type:t,coordinates:l[t](n)}:null}var a=g(n.transform),s=n.arcs,l={Point:function(n){return e(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(e)},LineString:function(n){return o(n.arcs)},MultiLineString:function(n){return n.arcs.map(o)},Polygon:function(n){return u(n.arcs)},MultiPolygon:function(n){return n.arcs.map(u)}};return c(t)}function f(n,t){for(var r,e=n.length,o=e-t;o<--e;)r=n[o],n[o++]=n[e],n[e]=r}function c(n,t){for(var r=0,e=n.length;e>r;){var o=r+e>>>1;n[o]<t?r=o+1:e=o}return r}function a(n){function t(n,t){n.forEach(function(n){0>n&&(n=~n);var r=o[n];r?r.push(t):o[n]=[t]})}function r(n,r){n.forEach(function(n){t(n,r)})}function e(n,t){"GeometryCollection"===n.type?n.geometries.forEach(function(n){e(n,t)}):n.type in u&&u[n.type](n.arcs,t)}var o={},i=n.map(function(){return[]}),u={LineString:t,MultiLineString:r,Polygon:r,MultiPolygon:function(n,t){n.forEach(function(n){r(n,t)})}};n.forEach(e);for(var f in o)for(var a=o[f],s=a.length,l=0;s>l;++l)for(var h=l+1;s>h;++h){var p,v=a[l],g=a[h];(p=i[v])[f=c(p,g)]!==g&&p.splice(f,0,g),(p=i[g])[f=c(p,v)]!==v&&p.splice(f,0,v)}return i}function s(n,t){function r(n){u.remove(n),n[1][2]=t(n),u.push(n)}var e,o=g(n.transform),i=m(n.transform),u=v(),f=0;for(t||(t=h),n.arcs.forEach(function(n){var r=[];n.forEach(o);for(var i=1,f=n.length-1;f>i;++i)e=n.slice(i-1,i+2),e[1][2]=t(e),r.push(e),u.push(e);n[0][2]=n[f][2]=1/0;for(var i=0,f=r.length;f>i;++i)e=r[i],e.previous=r[i-1],e.next=r[i+1]});e=u.pop();){var c=e.previous,a=e.next;e[1][2]<f?e[1][2]=f:f=e[1][2],c&&(c.next=a,c[2]=e[2],r(c)),a&&(a.previous=c,a[0]=e[0],r(a))}return n.arcs.forEach(function(n){n.forEach(i)}),n}function l(n){for(var t,r=-1,e=n.length,o=n[e-1],i=0;++r<e;)t=o,o=n[r],i+=t[0]*o[1]-t[1]*o[0];return.5*i}function h(n){var t=n[0],r=n[1],e=n[2];return Math.abs((t[0]-e[0])*(r[1]-t[1])-(t[0]-r[0])*(e[1]-t[1]))}function p(n,t){return n[1][2]-t[1][2]}function v(){function n(n,t){for(;t>0;){var r=(t+1>>1)-1,o=e[r];if(p(n,o)>=0)break;e[o._=t]=o,e[n._=t=r]=n}}function t(n,t){for(;;){var r=t+1<<1,i=r-1,u=t,f=e[u];if(o>i&&p(e[i],f)<0&&(f=e[u=i]),o>r&&p(e[r],f)<0&&(f=e[u=r]),u===t)break;e[f._=t]=f,e[n._=t=u]=n}}var r={},e=[],o=0;return r.push=function(t){return n(e[t._=o]=t,o++),o},r.pop=function(){if(!(0>=o)){var n,r=e[0];return--o>0&&(n=e[o],t(e[n._=0]=n,0)),r}},r.remove=function(r){var i,u=r._;if(e[u]===r)return u!==--o&&(i=e[o],(p(i,r)<0?n:t)(e[i._=u]=i,u)),u},r}function g(n){if(!n)return y;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,f){f||(t=r=0),n[0]=(t+=n[0])*e+i,n[1]=(r+=n[1])*o+u}}function m(n){if(!n)return y;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,f){f||(t=r=0);var c=(n[0]-i)/e|0,a=(n[1]-u)/o|0;n[0]=c-t,n[1]=a-r,t=c,r=a}}function y(){}var d={version:"1.6.14",mesh:function(n){return u(n,r.apply(this,arguments))},meshArcs:r,merge:function(n){return u(n,e.apply(this,arguments))},mergeArcs:e,feature:o,neighbors:a,presimplify:s};"function"==typeof define&&define.amd?define(d):"object"==typeof module&&module.exports?module.exports=d:this.topojson=d}();